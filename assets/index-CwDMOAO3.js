var cv=Object.defineProperty;var dv=(t,e,n)=>e in t?cv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ue=(t,e,n)=>dv(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();function fv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Yp={exports:{}},zs={},Kp={exports:{}},z={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var or=Symbol.for("react.element"),hv=Symbol.for("react.portal"),pv=Symbol.for("react.fragment"),mv=Symbol.for("react.strict_mode"),gv=Symbol.for("react.profiler"),_v=Symbol.for("react.provider"),yv=Symbol.for("react.context"),vv=Symbol.for("react.forward_ref"),Ev=Symbol.for("react.suspense"),Cv=Symbol.for("react.memo"),Tv=Symbol.for("react.lazy"),_d=Symbol.iterator;function Sv(t){return t===null||typeof t!="object"?null:(t=_d&&t[_d]||t["@@iterator"],typeof t=="function"?t:null)}var Qp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Xp=Object.assign,Zp={};function Bi(t,e,n){this.props=t,this.context=e,this.refs=Zp,this.updater=n||Qp}Bi.prototype.isReactComponent={};Bi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Bi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function jp(){}jp.prototype=Bi.prototype;function Mu(t,e,n){this.props=t,this.context=e,this.refs=Zp,this.updater=n||Qp}var Du=Mu.prototype=new jp;Du.constructor=Mu;Xp(Du,Bi.prototype);Du.isPureReactComponent=!0;var yd=Array.isArray,em=Object.prototype.hasOwnProperty,Lu={current:null},tm={key:!0,ref:!0,__self:!0,__source:!0};function nm(t,e,n){var i,o={},r=null,s=null;if(e!=null)for(i in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(r=""+e.key),e)em.call(e,i)&&!tm.hasOwnProperty(i)&&(o[i]=e[i]);var a=arguments.length-2;if(a===1)o.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];o.children=c}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)o[i]===void 0&&(o[i]=a[i]);return{$$typeof:or,type:t,key:r,ref:s,props:o,_owner:Lu.current}}function Iv(t,e){return{$$typeof:or,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Fu(t){return typeof t=="object"&&t!==null&&t.$$typeof===or}function wv(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var vd=/\/+/g;function Tl(t,e){return typeof t=="object"&&t!==null&&t.key!=null?wv(""+t.key):e.toString(36)}function Gr(t,e,n,i,o){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(r){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case or:case hv:s=!0}}if(s)return s=t,o=o(s),t=i===""?"."+Tl(s,0):i,yd(o)?(n="",t!=null&&(n=t.replace(vd,"$&/")+"/"),Gr(o,e,n,"",function(d){return d})):o!=null&&(Fu(o)&&(o=Iv(o,n+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(vd,"$&/")+"/")+t)),e.push(o)),1;if(s=0,i=i===""?".":i+":",yd(t))for(var a=0;a<t.length;a++){r=t[a];var c=i+Tl(r,a);s+=Gr(r,e,n,c,o)}else if(c=Sv(t),typeof c=="function")for(t=c.call(t),a=0;!(r=t.next()).done;)r=r.value,c=i+Tl(r,a++),s+=Gr(r,e,n,c,o);else if(r==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function _r(t,e,n){if(t==null)return t;var i=[],o=0;return Gr(t,i,"","",function(r){return e.call(n,r,o++)}),i}function Av(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Be={current:null},Or={transition:null},Nv={ReactCurrentDispatcher:Be,ReactCurrentBatchConfig:Or,ReactCurrentOwner:Lu};function im(){throw Error("act(...) is not supported in production builds of React.")}z.Children={map:_r,forEach:function(t,e,n){_r(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _r(t,function(){e++}),e},toArray:function(t){return _r(t,function(e){return e})||[]},only:function(t){if(!Fu(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};z.Component=Bi;z.Fragment=pv;z.Profiler=gv;z.PureComponent=Mu;z.StrictMode=mv;z.Suspense=Ev;z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nv;z.act=im;z.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=Xp({},t.props),o=t.key,r=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,s=Lu.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)em.call(e,c)&&!tm.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];i.children=a}return{$$typeof:or,type:t.type,key:o,ref:r,props:i,_owner:s}};z.createContext=function(t){return t={$$typeof:yv,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_v,_context:t},t.Consumer=t};z.createElement=nm;z.createFactory=function(t){var e=nm.bind(null,t);return e.type=t,e};z.createRef=function(){return{current:null}};z.forwardRef=function(t){return{$$typeof:vv,render:t}};z.isValidElement=Fu;z.lazy=function(t){return{$$typeof:Tv,_payload:{_status:-1,_result:t},_init:Av}};z.memo=function(t,e){return{$$typeof:Cv,type:t,compare:e===void 0?null:e}};z.startTransition=function(t){var e=Or.transition;Or.transition={};try{t()}finally{Or.transition=e}};z.unstable_act=im;z.useCallback=function(t,e){return Be.current.useCallback(t,e)};z.useContext=function(t){return Be.current.useContext(t)};z.useDebugValue=function(){};z.useDeferredValue=function(t){return Be.current.useDeferredValue(t)};z.useEffect=function(t,e){return Be.current.useEffect(t,e)};z.useId=function(){return Be.current.useId()};z.useImperativeHandle=function(t,e,n){return Be.current.useImperativeHandle(t,e,n)};z.useInsertionEffect=function(t,e){return Be.current.useInsertionEffect(t,e)};z.useLayoutEffect=function(t,e){return Be.current.useLayoutEffect(t,e)};z.useMemo=function(t,e){return Be.current.useMemo(t,e)};z.useReducer=function(t,e,n){return Be.current.useReducer(t,e,n)};z.useRef=function(t){return Be.current.useRef(t)};z.useState=function(t){return Be.current.useState(t)};z.useSyncExternalStore=function(t,e,n){return Be.current.useSyncExternalStore(t,e,n)};z.useTransition=function(){return Be.current.useTransition()};z.version="18.3.1";Kp.exports=z;var re=Kp.exports;const Rv=fv(re);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pv=re,xv=Symbol.for("react.element"),kv=Symbol.for("react.fragment"),Mv=Object.prototype.hasOwnProperty,Dv=Pv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Lv={key:!0,ref:!0,__self:!0,__source:!0};function om(t,e,n){var i,o={},r=null,s=null;n!==void 0&&(r=""+n),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(s=e.ref);for(i in e)Mv.call(e,i)&&!Lv.hasOwnProperty(i)&&(o[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)o[i]===void 0&&(o[i]=e[i]);return{$$typeof:xv,type:t,key:r,ref:s,props:o,_owner:Dv.current}}zs.Fragment=kv;zs.jsx=om;zs.jsxs=om;Yp.exports=zs;var T=Yp.exports,la={},rm={exports:{}},tt={},sm={exports:{}},lm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,V){var H=D.length;D.push(V);e:for(;0<H;){var me=H-1>>>1,Se=D[me];if(0<o(Se,V))D[me]=V,D[H]=Se,H=me;else break e}}function n(D){return D.length===0?null:D[0]}function i(D){if(D.length===0)return null;var V=D[0],H=D.pop();if(H!==V){D[0]=H;e:for(var me=0,Se=D.length,mr=Se>>>1;me<mr;){var Sn=2*(me+1)-1,Cl=D[Sn],In=Sn+1,gr=D[In];if(0>o(Cl,H))In<Se&&0>o(gr,Cl)?(D[me]=gr,D[In]=H,me=In):(D[me]=Cl,D[Sn]=H,me=Sn);else if(In<Se&&0>o(gr,H))D[me]=gr,D[In]=H,me=In;else break e}}return V}function o(D,V){var H=D.sortIndex-V.sortIndex;return H!==0?H:D.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var c=[],d=[],f=1,h=null,p=3,m=!1,v=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(D){for(var V=n(d);V!==null;){if(V.callback===null)i(d);else if(V.startTime<=D)i(d),V.sortIndex=V.expirationTime,e(c,V);else break;V=n(d)}}function C(D){if(E=!1,y(D),!v)if(n(c)!==null)v=!0,W(I);else{var V=n(d);V!==null&&Te(C,V.startTime-D)}}function I(D,V){v=!1,E&&(E=!1,_(k),k=-1),m=!0;var H=p;try{for(y(V),h=n(c);h!==null&&(!(h.expirationTime>V)||D&&!F());){var me=h.callback;if(typeof me=="function"){h.callback=null,p=h.priorityLevel;var Se=me(h.expirationTime<=V);V=t.unstable_now(),typeof Se=="function"?h.callback=Se:h===n(c)&&i(c),y(V)}else i(c);h=n(c)}if(h!==null)var mr=!0;else{var Sn=n(d);Sn!==null&&Te(C,Sn.startTime-V),mr=!1}return mr}finally{h=null,p=H,m=!1}}var A=!1,N=null,k=-1,w=5,P=-1;function F(){return!(t.unstable_now()-P<w)}function U(){if(N!==null){var D=t.unstable_now();P=D;var V=!0;try{V=N(!0,D)}finally{V?O():(A=!1,N=null)}}else A=!1}var O;if(typeof g=="function")O=function(){g(U)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ne=Y.port2;Y.port1.onmessage=U,O=function(){ne.postMessage(null)}}else O=function(){S(U,0)};function W(D){N=D,A||(A=!0,O())}function Te(D,V){k=S(function(){D(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,W(I))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(D){switch(p){case 1:case 2:case 3:var V=3;break;default:V=p}var H=p;p=V;try{return D()}finally{p=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,V){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var H=p;p=D;try{return V()}finally{p=H}},t.unstable_scheduleCallback=function(D,V,H){var me=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?me+H:me):H=me,D){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=H+Se,D={id:f++,callback:V,priorityLevel:D,startTime:H,expirationTime:Se,sortIndex:-1},H>me?(D.sortIndex=H,e(d,D),n(c)===null&&D===n(d)&&(E?(_(k),k=-1):E=!0,Te(C,H-me))):(D.sortIndex=Se,e(c,D),v||m||(v=!0,W(I))),D},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(D){var V=p;return function(){var H=p;p=V;try{return D.apply(this,arguments)}finally{p=H}}}})(lm);sm.exports=lm;var Fv=sm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uv=re,et=Fv;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var am=new Set,xo={};function Wn(t,e){Ni(t,e),Ni(t+"Capture",e)}function Ni(t,e){for(xo[t]=e,t=0;t<e.length;t++)am.add(e[t])}var Gt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),aa=Object.prototype.hasOwnProperty,Vv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ed={},Cd={};function Gv(t){return aa.call(Cd,t)?!0:aa.call(Ed,t)?!1:Vv.test(t)?Cd[t]=!0:(Ed[t]=!0,!1)}function Ov(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Hv(t,e,n,i){if(e===null||typeof e>"u"||Ov(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qe(t,e,n,i,o,r,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=r,this.removeEmptyString=s}var Me={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Me[t]=new qe(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Me[e]=new qe(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Me[t]=new qe(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Me[t]=new qe(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Me[t]=new qe(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Me[t]=new qe(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Me[t]=new qe(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Me[t]=new qe(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Me[t]=new qe(t,5,!1,t.toLowerCase(),null,!1,!1)});var Uu=/[\-:]([a-z])/g;function Vu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Uu,Vu);Me[e]=new qe(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Uu,Vu);Me[e]=new qe(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Uu,Vu);Me[e]=new qe(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Me[t]=new qe(t,1,!1,t.toLowerCase(),null,!1,!1)});Me.xlinkHref=new qe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Me[t]=new qe(t,1,!1,t.toLowerCase(),null,!0,!0)});function Gu(t,e,n,i){var o=Me.hasOwnProperty(e)?Me[e]:null;(o!==null?o.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Hv(e,n,o,i)&&(n=null),i||o===null?Gv(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,i=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var $t=Uv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yr=Symbol.for("react.element"),jn=Symbol.for("react.portal"),ei=Symbol.for("react.fragment"),Ou=Symbol.for("react.strict_mode"),ua=Symbol.for("react.profiler"),um=Symbol.for("react.provider"),cm=Symbol.for("react.context"),Hu=Symbol.for("react.forward_ref"),ca=Symbol.for("react.suspense"),da=Symbol.for("react.suspense_list"),Bu=Symbol.for("react.memo"),Xt=Symbol.for("react.lazy"),dm=Symbol.for("react.offscreen"),Td=Symbol.iterator;function Xi(t){return t===null||typeof t!="object"?null:(t=Td&&t[Td]||t["@@iterator"],typeof t=="function"?t:null)}var he=Object.assign,Sl;function co(t){if(Sl===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Sl=e&&e[1]||""}return`
`+Sl+t}var Il=!1;function wl(t,e){if(!t||Il)return"";Il=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var i=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){i=d}t.call(e.prototype)}else{try{throw Error()}catch(d){i=d}t()}}catch(d){if(d&&i&&typeof d.stack=="string"){for(var o=d.stack.split(`
`),r=i.stack.split(`
`),s=o.length-1,a=r.length-1;1<=s&&0<=a&&o[s]!==r[a];)a--;for(;1<=s&&0<=a;s--,a--)if(o[s]!==r[a]){if(s!==1||a!==1)do if(s--,a--,0>a||o[s]!==r[a]){var c=`
`+o[s].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=s&&0<=a);break}}}finally{Il=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?co(t):""}function Bv(t){switch(t.tag){case 5:return co(t.type);case 16:return co("Lazy");case 13:return co("Suspense");case 19:return co("SuspenseList");case 0:case 2:case 15:return t=wl(t.type,!1),t;case 11:return t=wl(t.type.render,!1),t;case 1:return t=wl(t.type,!0),t;default:return""}}function fa(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ei:return"Fragment";case jn:return"Portal";case ua:return"Profiler";case Ou:return"StrictMode";case ca:return"Suspense";case da:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case cm:return(t.displayName||"Context")+".Consumer";case um:return(t._context.displayName||"Context")+".Provider";case Hu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Bu:return e=t.displayName||null,e!==null?e:fa(t.type)||"Memo";case Xt:e=t._payload,t=t._init;try{return fa(t(e))}catch{}}return null}function qv(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fa(e);case 8:return e===Ou?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function mn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function fm(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function bv(t){var e=fm(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,r=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(s){i=""+s,r.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(s){i=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vr(t){t._valueTracker||(t._valueTracker=bv(t))}function hm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=fm(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function jr(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ha(t,e){var n=e.checked;return he({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Sd(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=mn(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function pm(t,e){e=e.checked,e!=null&&Gu(t,"checked",e,!1)}function pa(t,e){pm(t,e);var n=mn(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ma(t,e.type,n):e.hasOwnProperty("defaultValue")&&ma(t,e.type,mn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Id(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ma(t,e,n){(e!=="number"||jr(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var fo=Array.isArray;function pi(t,e,n,i){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&i&&(t[n].defaultSelected=!0)}else{for(n=""+mn(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,i&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function ga(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return he({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wd(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(R(92));if(fo(n)){if(1<n.length)throw Error(R(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:mn(n)}}function mm(t,e){var n=mn(e.value),i=mn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function Ad(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function gm(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _a(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?gm(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Er,_m=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Er=Er||document.createElement("div"),Er.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Er.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ko(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var mo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zv=["Webkit","ms","Moz","O"];Object.keys(mo).forEach(function(t){zv.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),mo[e]=mo[t]})});function ym(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||mo.hasOwnProperty(t)&&mo[t]?(""+e).trim():e+"px"}function vm(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,o=ym(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,o):t[n]=o}}var Wv=he({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ya(t,e){if(e){if(Wv[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function va(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ea=null;function qu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ca=null,mi=null,gi=null;function Nd(t){if(t=lr(t)){if(typeof Ca!="function")throw Error(R(280));var e=t.stateNode;e&&(e=Ks(e),Ca(t.stateNode,t.type,e))}}function Em(t){mi?gi?gi.push(t):gi=[t]:mi=t}function Cm(){if(mi){var t=mi,e=gi;if(gi=mi=null,Nd(t),e)for(t=0;t<e.length;t++)Nd(e[t])}}function Tm(t,e){return t(e)}function Sm(){}var Al=!1;function Im(t,e,n){if(Al)return t(e,n);Al=!0;try{return Tm(t,e,n)}finally{Al=!1,(mi!==null||gi!==null)&&(Sm(),Cm())}}function Mo(t,e){var n=t.stateNode;if(n===null)return null;var i=Ks(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(R(231,e,typeof n));return n}var Ta=!1;if(Gt)try{var Zi={};Object.defineProperty(Zi,"passive",{get:function(){Ta=!0}}),window.addEventListener("test",Zi,Zi),window.removeEventListener("test",Zi,Zi)}catch{Ta=!1}function $v(t,e,n,i,o,r,s,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var go=!1,es=null,ts=!1,Sa=null,Jv={onError:function(t){go=!0,es=t}};function Yv(t,e,n,i,o,r,s,a,c){go=!1,es=null,$v.apply(Jv,arguments)}function Kv(t,e,n,i,o,r,s,a,c){if(Yv.apply(this,arguments),go){if(go){var d=es;go=!1,es=null}else throw Error(R(198));ts||(ts=!0,Sa=d)}}function $n(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function wm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Rd(t){if($n(t)!==t)throw Error(R(188))}function Qv(t){var e=t.alternate;if(!e){if(e=$n(t),e===null)throw Error(R(188));return e!==t?null:t}for(var n=t,i=e;;){var o=n.return;if(o===null)break;var r=o.alternate;if(r===null){if(i=o.return,i!==null){n=i;continue}break}if(o.child===r.child){for(r=o.child;r;){if(r===n)return Rd(o),t;if(r===i)return Rd(o),e;r=r.sibling}throw Error(R(188))}if(n.return!==i.return)n=o,i=r;else{for(var s=!1,a=o.child;a;){if(a===n){s=!0,n=o,i=r;break}if(a===i){s=!0,i=o,n=r;break}a=a.sibling}if(!s){for(a=r.child;a;){if(a===n){s=!0,n=r,i=o;break}if(a===i){s=!0,i=r,n=o;break}a=a.sibling}if(!s)throw Error(R(189))}}if(n.alternate!==i)throw Error(R(190))}if(n.tag!==3)throw Error(R(188));return n.stateNode.current===n?t:e}function Am(t){return t=Qv(t),t!==null?Nm(t):null}function Nm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Nm(t);if(e!==null)return e;t=t.sibling}return null}var Rm=et.unstable_scheduleCallback,Pd=et.unstable_cancelCallback,Xv=et.unstable_shouldYield,Zv=et.unstable_requestPaint,ge=et.unstable_now,jv=et.unstable_getCurrentPriorityLevel,bu=et.unstable_ImmediatePriority,Pm=et.unstable_UserBlockingPriority,ns=et.unstable_NormalPriority,eE=et.unstable_LowPriority,xm=et.unstable_IdlePriority,Ws=null,At=null;function tE(t){if(At&&typeof At.onCommitFiberRoot=="function")try{At.onCommitFiberRoot(Ws,t,void 0,(t.current.flags&128)===128)}catch{}}var _t=Math.clz32?Math.clz32:oE,nE=Math.log,iE=Math.LN2;function oE(t){return t>>>=0,t===0?32:31-(nE(t)/iE|0)|0}var Cr=64,Tr=4194304;function ho(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function is(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,o=t.suspendedLanes,r=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~o;a!==0?i=ho(a):(r&=s,r!==0&&(i=ho(r)))}else s=n&~o,s!==0?i=ho(s):r!==0&&(i=ho(r));if(i===0)return 0;if(e!==0&&e!==i&&!(e&o)&&(o=i&-i,r=e&-e,o>=r||o===16&&(r&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-_t(e),o=1<<n,i|=t[n],e&=~o;return i}function rE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sE(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,o=t.expirationTimes,r=t.pendingLanes;0<r;){var s=31-_t(r),a=1<<s,c=o[s];c===-1?(!(a&n)||a&i)&&(o[s]=rE(a,e)):c<=e&&(t.expiredLanes|=a),r&=~a}}function Ia(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function km(){var t=Cr;return Cr<<=1,!(Cr&4194240)&&(Cr=64),t}function Nl(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function rr(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_t(e),t[e]=n}function lE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-_t(n),r=1<<o;e[o]=0,i[o]=-1,t[o]=-1,n&=~r}}function zu(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-_t(n),o=1<<i;o&e|t[i]&e&&(t[i]|=e),n&=~o}}var Q=0;function Mm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Dm,Wu,Lm,Fm,Um,wa=!1,Sr=[],on=null,rn=null,sn=null,Do=new Map,Lo=new Map,jt=[],aE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xd(t,e){switch(t){case"focusin":case"focusout":on=null;break;case"dragenter":case"dragleave":rn=null;break;case"mouseover":case"mouseout":sn=null;break;case"pointerover":case"pointerout":Do.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lo.delete(e.pointerId)}}function ji(t,e,n,i,o,r){return t===null||t.nativeEvent!==r?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:r,targetContainers:[o]},e!==null&&(e=lr(e),e!==null&&Wu(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function uE(t,e,n,i,o){switch(e){case"focusin":return on=ji(on,t,e,n,i,o),!0;case"dragenter":return rn=ji(rn,t,e,n,i,o),!0;case"mouseover":return sn=ji(sn,t,e,n,i,o),!0;case"pointerover":var r=o.pointerId;return Do.set(r,ji(Do.get(r)||null,t,e,n,i,o)),!0;case"gotpointercapture":return r=o.pointerId,Lo.set(r,ji(Lo.get(r)||null,t,e,n,i,o)),!0}return!1}function Vm(t){var e=Pn(t.target);if(e!==null){var n=$n(e);if(n!==null){if(e=n.tag,e===13){if(e=wm(n),e!==null){t.blockedOn=e,Um(t.priority,function(){Lm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hr(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Aa(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);Ea=i,n.target.dispatchEvent(i),Ea=null}else return e=lr(n),e!==null&&Wu(e),t.blockedOn=n,!1;e.shift()}return!0}function kd(t,e,n){Hr(t)&&n.delete(e)}function cE(){wa=!1,on!==null&&Hr(on)&&(on=null),rn!==null&&Hr(rn)&&(rn=null),sn!==null&&Hr(sn)&&(sn=null),Do.forEach(kd),Lo.forEach(kd)}function eo(t,e){t.blockedOn===e&&(t.blockedOn=null,wa||(wa=!0,et.unstable_scheduleCallback(et.unstable_NormalPriority,cE)))}function Fo(t){function e(o){return eo(o,t)}if(0<Sr.length){eo(Sr[0],t);for(var n=1;n<Sr.length;n++){var i=Sr[n];i.blockedOn===t&&(i.blockedOn=null)}}for(on!==null&&eo(on,t),rn!==null&&eo(rn,t),sn!==null&&eo(sn,t),Do.forEach(e),Lo.forEach(e),n=0;n<jt.length;n++)i=jt[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<jt.length&&(n=jt[0],n.blockedOn===null);)Vm(n),n.blockedOn===null&&jt.shift()}var _i=$t.ReactCurrentBatchConfig,os=!0;function dE(t,e,n,i){var o=Q,r=_i.transition;_i.transition=null;try{Q=1,$u(t,e,n,i)}finally{Q=o,_i.transition=r}}function fE(t,e,n,i){var o=Q,r=_i.transition;_i.transition=null;try{Q=4,$u(t,e,n,i)}finally{Q=o,_i.transition=r}}function $u(t,e,n,i){if(os){var o=Aa(t,e,n,i);if(o===null)Vl(t,e,i,rs,n),xd(t,i);else if(uE(o,t,e,n,i))i.stopPropagation();else if(xd(t,i),e&4&&-1<aE.indexOf(t)){for(;o!==null;){var r=lr(o);if(r!==null&&Dm(r),r=Aa(t,e,n,i),r===null&&Vl(t,e,i,rs,n),r===o)break;o=r}o!==null&&i.stopPropagation()}else Vl(t,e,i,null,n)}}var rs=null;function Aa(t,e,n,i){if(rs=null,t=qu(i),t=Pn(t),t!==null)if(e=$n(t),e===null)t=null;else if(n=e.tag,n===13){if(t=wm(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return rs=t,null}function Gm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jv()){case bu:return 1;case Pm:return 4;case ns:case eE:return 16;case xm:return 536870912;default:return 16}default:return 16}}var tn=null,Ju=null,Br=null;function Om(){if(Br)return Br;var t,e=Ju,n=e.length,i,o="value"in tn?tn.value:tn.textContent,r=o.length;for(t=0;t<n&&e[t]===o[t];t++);var s=n-t;for(i=1;i<=s&&e[n-i]===o[r-i];i++);return Br=o.slice(t,1<i?1-i:void 0)}function qr(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ir(){return!0}function Md(){return!1}function nt(t){function e(n,i,o,r,s){this._reactName=n,this._targetInst=o,this.type=i,this.nativeEvent=r,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Ir:Md,this.isPropagationStopped=Md,this}return he(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ir)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ir)},persist:function(){},isPersistent:Ir}),e}var qi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yu=nt(qi),sr=he({},qi,{view:0,detail:0}),hE=nt(sr),Rl,Pl,to,$s=he({},sr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ku,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==to&&(to&&t.type==="mousemove"?(Rl=t.screenX-to.screenX,Pl=t.screenY-to.screenY):Pl=Rl=0,to=t),Rl)},movementY:function(t){return"movementY"in t?t.movementY:Pl}}),Dd=nt($s),pE=he({},$s,{dataTransfer:0}),mE=nt(pE),gE=he({},sr,{relatedTarget:0}),xl=nt(gE),_E=he({},qi,{animationName:0,elapsedTime:0,pseudoElement:0}),yE=nt(_E),vE=he({},qi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),EE=nt(vE),CE=he({},qi,{data:0}),Ld=nt(CE),TE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},SE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=IE[t])?!!e[t]:!1}function Ku(){return wE}var AE=he({},sr,{key:function(t){if(t.key){var e=TE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=qr(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?SE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ku,charCode:function(t){return t.type==="keypress"?qr(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qr(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),NE=nt(AE),RE=he({},$s,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fd=nt(RE),PE=he({},sr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ku}),xE=nt(PE),kE=he({},qi,{propertyName:0,elapsedTime:0,pseudoElement:0}),ME=nt(kE),DE=he({},$s,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),LE=nt(DE),FE=[9,13,27,32],Qu=Gt&&"CompositionEvent"in window,_o=null;Gt&&"documentMode"in document&&(_o=document.documentMode);var UE=Gt&&"TextEvent"in window&&!_o,Hm=Gt&&(!Qu||_o&&8<_o&&11>=_o),Ud=" ",Vd=!1;function Bm(t,e){switch(t){case"keyup":return FE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ti=!1;function VE(t,e){switch(t){case"compositionend":return qm(e);case"keypress":return e.which!==32?null:(Vd=!0,Ud);case"textInput":return t=e.data,t===Ud&&Vd?null:t;default:return null}}function GE(t,e){if(ti)return t==="compositionend"||!Qu&&Bm(t,e)?(t=Om(),Br=Ju=tn=null,ti=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Hm&&e.locale!=="ko"?null:e.data;default:return null}}var OE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!OE[t.type]:e==="textarea"}function bm(t,e,n,i){Em(i),e=ss(e,"onChange"),0<e.length&&(n=new Yu("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var yo=null,Uo=null;function HE(t){eg(t,0)}function Js(t){var e=oi(t);if(hm(e))return t}function BE(t,e){if(t==="change")return e}var zm=!1;if(Gt){var kl;if(Gt){var Ml="oninput"in document;if(!Ml){var Od=document.createElement("div");Od.setAttribute("oninput","return;"),Ml=typeof Od.oninput=="function"}kl=Ml}else kl=!1;zm=kl&&(!document.documentMode||9<document.documentMode)}function Hd(){yo&&(yo.detachEvent("onpropertychange",Wm),Uo=yo=null)}function Wm(t){if(t.propertyName==="value"&&Js(Uo)){var e=[];bm(e,Uo,t,qu(t)),Im(HE,e)}}function qE(t,e,n){t==="focusin"?(Hd(),yo=e,Uo=n,yo.attachEvent("onpropertychange",Wm)):t==="focusout"&&Hd()}function bE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Js(Uo)}function zE(t,e){if(t==="click")return Js(e)}function WE(t,e){if(t==="input"||t==="change")return Js(e)}function $E(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Et=typeof Object.is=="function"?Object.is:$E;function Vo(t,e){if(Et(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var o=n[i];if(!aa.call(e,o)||!Et(t[o],e[o]))return!1}return!0}function Bd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qd(t,e){var n=Bd(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Bd(n)}}function $m(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$m(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Jm(){for(var t=window,e=jr();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=jr(t.document)}return e}function Xu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function JE(t){var e=Jm(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$m(n.ownerDocument.documentElement,n)){if(i!==null&&Xu(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,r=Math.min(i.start,o);i=i.end===void 0?r:Math.min(i.end,o),!t.extend&&r>i&&(o=i,i=r,r=o),o=qd(n,r);var s=qd(n,i);o&&s&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),r>i?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var YE=Gt&&"documentMode"in document&&11>=document.documentMode,ni=null,Na=null,vo=null,Ra=!1;function bd(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ra||ni==null||ni!==jr(i)||(i=ni,"selectionStart"in i&&Xu(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),vo&&Vo(vo,i)||(vo=i,i=ss(Na,"onSelect"),0<i.length&&(e=new Yu("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=ni)))}function wr(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ii={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Dl={},Ym={};Gt&&(Ym=document.createElement("div").style,"AnimationEvent"in window||(delete ii.animationend.animation,delete ii.animationiteration.animation,delete ii.animationstart.animation),"TransitionEvent"in window||delete ii.transitionend.transition);function Ys(t){if(Dl[t])return Dl[t];if(!ii[t])return t;var e=ii[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ym)return Dl[t]=e[n];return t}var Km=Ys("animationend"),Qm=Ys("animationiteration"),Xm=Ys("animationstart"),Zm=Ys("transitionend"),jm=new Map,zd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vn(t,e){jm.set(t,e),Wn(e,[t])}for(var Ll=0;Ll<zd.length;Ll++){var Fl=zd[Ll],KE=Fl.toLowerCase(),QE=Fl[0].toUpperCase()+Fl.slice(1);vn(KE,"on"+QE)}vn(Km,"onAnimationEnd");vn(Qm,"onAnimationIteration");vn(Xm,"onAnimationStart");vn("dblclick","onDoubleClick");vn("focusin","onFocus");vn("focusout","onBlur");vn(Zm,"onTransitionEnd");Ni("onMouseEnter",["mouseout","mouseover"]);Ni("onMouseLeave",["mouseout","mouseover"]);Ni("onPointerEnter",["pointerout","pointerover"]);Ni("onPointerLeave",["pointerout","pointerover"]);Wn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var po="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XE=new Set("cancel close invalid load scroll toggle".split(" ").concat(po));function Wd(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,Kv(i,e,void 0,t),t.currentTarget=null}function eg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],o=i.event;i=i.listeners;e:{var r=void 0;if(e)for(var s=i.length-1;0<=s;s--){var a=i[s],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==r&&o.isPropagationStopped())break e;Wd(o,a,d),r=c}else for(s=0;s<i.length;s++){if(a=i[s],c=a.instance,d=a.currentTarget,a=a.listener,c!==r&&o.isPropagationStopped())break e;Wd(o,a,d),r=c}}}if(ts)throw t=Sa,ts=!1,Sa=null,t}function ie(t,e){var n=e[Da];n===void 0&&(n=e[Da]=new Set);var i=t+"__bubble";n.has(i)||(tg(e,t,2,!1),n.add(i))}function Ul(t,e,n){var i=0;e&&(i|=4),tg(n,t,i,e)}var Ar="_reactListening"+Math.random().toString(36).slice(2);function Go(t){if(!t[Ar]){t[Ar]=!0,am.forEach(function(n){n!=="selectionchange"&&(XE.has(n)||Ul(n,!1,t),Ul(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ar]||(e[Ar]=!0,Ul("selectionchange",!1,e))}}function tg(t,e,n,i){switch(Gm(e)){case 1:var o=dE;break;case 4:o=fE;break;default:o=$u}n=o.bind(null,e,n,t),o=void 0,!Ta||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),i?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function Vl(t,e,n,i,o){var r=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var s=i.tag;if(s===3||s===4){var a=i.stateNode.containerInfo;if(a===o||a.nodeType===8&&a.parentNode===o)break;if(s===4)for(s=i.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===o||c.nodeType===8&&c.parentNode===o))return;s=s.return}for(;a!==null;){if(s=Pn(a),s===null)return;if(c=s.tag,c===5||c===6){i=r=s;continue e}a=a.parentNode}}i=i.return}Im(function(){var d=r,f=qu(n),h=[];e:{var p=jm.get(t);if(p!==void 0){var m=Yu,v=t;switch(t){case"keypress":if(qr(n)===0)break e;case"keydown":case"keyup":m=NE;break;case"focusin":v="focus",m=xl;break;case"focusout":v="blur",m=xl;break;case"beforeblur":case"afterblur":m=xl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Dd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=mE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=xE;break;case Km:case Qm:case Xm:m=yE;break;case Zm:m=ME;break;case"scroll":m=hE;break;case"wheel":m=LE;break;case"copy":case"cut":case"paste":m=EE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Fd}var E=(e&4)!==0,S=!E&&t==="scroll",_=E?p!==null?p+"Capture":null:p;E=[];for(var g=d,y;g!==null;){y=g;var C=y.stateNode;if(y.tag===5&&C!==null&&(y=C,_!==null&&(C=Mo(g,_),C!=null&&E.push(Oo(g,C,y)))),S)break;g=g.return}0<E.length&&(p=new m(p,v,null,n,f),h.push({event:p,listeners:E}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",p&&n!==Ea&&(v=n.relatedTarget||n.fromElement)&&(Pn(v)||v[Ot]))break e;if((m||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,m?(v=n.relatedTarget||n.toElement,m=d,v=v?Pn(v):null,v!==null&&(S=$n(v),v!==S||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=d),m!==v)){if(E=Dd,C="onMouseLeave",_="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(E=Fd,C="onPointerLeave",_="onPointerEnter",g="pointer"),S=m==null?p:oi(m),y=v==null?p:oi(v),p=new E(C,g+"leave",m,n,f),p.target=S,p.relatedTarget=y,C=null,Pn(f)===d&&(E=new E(_,g+"enter",v,n,f),E.target=y,E.relatedTarget=S,C=E),S=C,m&&v)t:{for(E=m,_=v,g=0,y=E;y;y=Xn(y))g++;for(y=0,C=_;C;C=Xn(C))y++;for(;0<g-y;)E=Xn(E),g--;for(;0<y-g;)_=Xn(_),y--;for(;g--;){if(E===_||_!==null&&E===_.alternate)break t;E=Xn(E),_=Xn(_)}E=null}else E=null;m!==null&&$d(h,p,m,E,!1),v!==null&&S!==null&&$d(h,S,v,E,!0)}}e:{if(p=d?oi(d):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var I=BE;else if(Gd(p))if(zm)I=WE;else{I=bE;var A=qE}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(I=zE);if(I&&(I=I(t,d))){bm(h,I,n,f);break e}A&&A(t,p,d),t==="focusout"&&(A=p._wrapperState)&&A.controlled&&p.type==="number"&&ma(p,"number",p.value)}switch(A=d?oi(d):window,t){case"focusin":(Gd(A)||A.contentEditable==="true")&&(ni=A,Na=d,vo=null);break;case"focusout":vo=Na=ni=null;break;case"mousedown":Ra=!0;break;case"contextmenu":case"mouseup":case"dragend":Ra=!1,bd(h,n,f);break;case"selectionchange":if(YE)break;case"keydown":case"keyup":bd(h,n,f)}var N;if(Qu)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else ti?Bm(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(Hm&&n.locale!=="ko"&&(ti||k!=="onCompositionStart"?k==="onCompositionEnd"&&ti&&(N=Om()):(tn=f,Ju="value"in tn?tn.value:tn.textContent,ti=!0)),A=ss(d,k),0<A.length&&(k=new Ld(k,t,null,n,f),h.push({event:k,listeners:A}),N?k.data=N:(N=qm(n),N!==null&&(k.data=N)))),(N=UE?VE(t,n):GE(t,n))&&(d=ss(d,"onBeforeInput"),0<d.length&&(f=new Ld("onBeforeInput","beforeinput",null,n,f),h.push({event:f,listeners:d}),f.data=N))}eg(h,e)})}function Oo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ss(t,e){for(var n=e+"Capture",i=[];t!==null;){var o=t,r=o.stateNode;o.tag===5&&r!==null&&(o=r,r=Mo(t,n),r!=null&&i.unshift(Oo(t,r,o)),r=Mo(t,e),r!=null&&i.push(Oo(t,r,o))),t=t.return}return i}function Xn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $d(t,e,n,i,o){for(var r=e._reactName,s=[];n!==null&&n!==i;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===i)break;a.tag===5&&d!==null&&(a=d,o?(c=Mo(n,r),c!=null&&s.unshift(Oo(n,c,a))):o||(c=Mo(n,r),c!=null&&s.push(Oo(n,c,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var ZE=/\r\n?/g,jE=/\u0000|\uFFFD/g;function Jd(t){return(typeof t=="string"?t:""+t).replace(ZE,`
`).replace(jE,"")}function Nr(t,e,n){if(e=Jd(e),Jd(t)!==e&&n)throw Error(R(425))}function ls(){}var Pa=null,xa=null;function ka(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ma=typeof setTimeout=="function"?setTimeout:void 0,eC=typeof clearTimeout=="function"?clearTimeout:void 0,Yd=typeof Promise=="function"?Promise:void 0,tC=typeof queueMicrotask=="function"?queueMicrotask:typeof Yd<"u"?function(t){return Yd.resolve(null).then(t).catch(nC)}:Ma;function nC(t){setTimeout(function(){throw t})}function Gl(t,e){var n=e,i=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(i===0){t.removeChild(o),Fo(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=o}while(n);Fo(e)}function ln(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Kd(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var bi=Math.random().toString(36).slice(2),wt="__reactFiber$"+bi,Ho="__reactProps$"+bi,Ot="__reactContainer$"+bi,Da="__reactEvents$"+bi,iC="__reactListeners$"+bi,oC="__reactHandles$"+bi;function Pn(t){var e=t[wt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ot]||n[wt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Kd(t);t!==null;){if(n=t[wt])return n;t=Kd(t)}return e}t=n,n=t.parentNode}return null}function lr(t){return t=t[wt]||t[Ot],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function oi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function Ks(t){return t[Ho]||null}var La=[],ri=-1;function En(t){return{current:t}}function le(t){0>ri||(t.current=La[ri],La[ri]=null,ri--)}function te(t,e){ri++,La[ri]=t.current,t.current=e}var gn={},Ve=En(gn),Je=En(!1),Un=gn;function Ri(t,e){var n=t.type.contextTypes;if(!n)return gn;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var o={},r;for(r in n)o[r]=e[r];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Ye(t){return t=t.childContextTypes,t!=null}function as(){le(Je),le(Ve)}function Qd(t,e,n){if(Ve.current!==gn)throw Error(R(168));te(Ve,e),te(Je,n)}function ng(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var o in i)if(!(o in e))throw Error(R(108,qv(t)||"Unknown",o));return he({},n,i)}function us(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gn,Un=Ve.current,te(Ve,t),te(Je,Je.current),!0}function Xd(t,e,n){var i=t.stateNode;if(!i)throw Error(R(169));n?(t=ng(t,e,Un),i.__reactInternalMemoizedMergedChildContext=t,le(Je),le(Ve),te(Ve,t)):le(Je),te(Je,n)}var kt=null,Qs=!1,Ol=!1;function ig(t){kt===null?kt=[t]:kt.push(t)}function rC(t){Qs=!0,ig(t)}function Cn(){if(!Ol&&kt!==null){Ol=!0;var t=0,e=Q;try{var n=kt;for(Q=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}kt=null,Qs=!1}catch(o){throw kt!==null&&(kt=kt.slice(t+1)),Rm(bu,Cn),o}finally{Q=e,Ol=!1}}return null}var si=[],li=0,cs=null,ds=0,it=[],ot=0,Vn=null,Dt=1,Lt="";function wn(t,e){si[li++]=ds,si[li++]=cs,cs=t,ds=e}function og(t,e,n){it[ot++]=Dt,it[ot++]=Lt,it[ot++]=Vn,Vn=t;var i=Dt;t=Lt;var o=32-_t(i)-1;i&=~(1<<o),n+=1;var r=32-_t(e)+o;if(30<r){var s=o-o%5;r=(i&(1<<s)-1).toString(32),i>>=s,o-=s,Dt=1<<32-_t(e)+o|n<<o|i,Lt=r+t}else Dt=1<<r|n<<o|i,Lt=t}function Zu(t){t.return!==null&&(wn(t,1),og(t,1,0))}function ju(t){for(;t===cs;)cs=si[--li],si[li]=null,ds=si[--li],si[li]=null;for(;t===Vn;)Vn=it[--ot],it[ot]=null,Lt=it[--ot],it[ot]=null,Dt=it[--ot],it[ot]=null}var je=null,Ze=null,ae=!1,pt=null;function rg(t,e){var n=rt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Zd(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,je=t,Ze=ln(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,je=t,Ze=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Vn!==null?{id:Dt,overflow:Lt}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=rt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,je=t,Ze=null,!0):!1;default:return!1}}function Fa(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ua(t){if(ae){var e=Ze;if(e){var n=e;if(!Zd(t,e)){if(Fa(t))throw Error(R(418));e=ln(n.nextSibling);var i=je;e&&Zd(t,e)?rg(i,n):(t.flags=t.flags&-4097|2,ae=!1,je=t)}}else{if(Fa(t))throw Error(R(418));t.flags=t.flags&-4097|2,ae=!1,je=t}}}function jd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;je=t}function Rr(t){if(t!==je)return!1;if(!ae)return jd(t),ae=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ka(t.type,t.memoizedProps)),e&&(e=Ze)){if(Fa(t))throw sg(),Error(R(418));for(;e;)rg(t,e),e=ln(e.nextSibling)}if(jd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ze=ln(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ze=null}}else Ze=je?ln(t.stateNode.nextSibling):null;return!0}function sg(){for(var t=Ze;t;)t=ln(t.nextSibling)}function Pi(){Ze=je=null,ae=!1}function ec(t){pt===null?pt=[t]:pt.push(t)}var sC=$t.ReactCurrentBatchConfig;function no(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(R(309));var i=n.stateNode}if(!i)throw Error(R(147,t));var o=i,r=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(s){var a=o.refs;s===null?delete a[r]:a[r]=s},e._stringRef=r,e)}if(typeof t!="string")throw Error(R(284));if(!n._owner)throw Error(R(290,t))}return t}function Pr(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ef(t){var e=t._init;return e(t._payload)}function lg(t){function e(_,g){if(t){var y=_.deletions;y===null?(_.deletions=[g],_.flags|=16):y.push(g)}}function n(_,g){if(!t)return null;for(;g!==null;)e(_,g),g=g.sibling;return null}function i(_,g){for(_=new Map;g!==null;)g.key!==null?_.set(g.key,g):_.set(g.index,g),g=g.sibling;return _}function o(_,g){return _=dn(_,g),_.index=0,_.sibling=null,_}function r(_,g,y){return _.index=y,t?(y=_.alternate,y!==null?(y=y.index,y<g?(_.flags|=2,g):y):(_.flags|=2,g)):(_.flags|=1048576,g)}function s(_){return t&&_.alternate===null&&(_.flags|=2),_}function a(_,g,y,C){return g===null||g.tag!==6?(g=$l(y,_.mode,C),g.return=_,g):(g=o(g,y),g.return=_,g)}function c(_,g,y,C){var I=y.type;return I===ei?f(_,g,y.props.children,C,y.key):g!==null&&(g.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Xt&&ef(I)===g.type)?(C=o(g,y.props),C.ref=no(_,g,y),C.return=_,C):(C=Kr(y.type,y.key,y.props,null,_.mode,C),C.ref=no(_,g,y),C.return=_,C)}function d(_,g,y,C){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=Jl(y,_.mode,C),g.return=_,g):(g=o(g,y.children||[]),g.return=_,g)}function f(_,g,y,C,I){return g===null||g.tag!==7?(g=Fn(y,_.mode,C,I),g.return=_,g):(g=o(g,y),g.return=_,g)}function h(_,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=$l(""+g,_.mode,y),g.return=_,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case yr:return y=Kr(g.type,g.key,g.props,null,_.mode,y),y.ref=no(_,null,g),y.return=_,y;case jn:return g=Jl(g,_.mode,y),g.return=_,g;case Xt:var C=g._init;return h(_,C(g._payload),y)}if(fo(g)||Xi(g))return g=Fn(g,_.mode,y,null),g.return=_,g;Pr(_,g)}return null}function p(_,g,y,C){var I=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return I!==null?null:a(_,g,""+y,C);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case yr:return y.key===I?c(_,g,y,C):null;case jn:return y.key===I?d(_,g,y,C):null;case Xt:return I=y._init,p(_,g,I(y._payload),C)}if(fo(y)||Xi(y))return I!==null?null:f(_,g,y,C,null);Pr(_,y)}return null}function m(_,g,y,C,I){if(typeof C=="string"&&C!==""||typeof C=="number")return _=_.get(y)||null,a(g,_,""+C,I);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case yr:return _=_.get(C.key===null?y:C.key)||null,c(g,_,C,I);case jn:return _=_.get(C.key===null?y:C.key)||null,d(g,_,C,I);case Xt:var A=C._init;return m(_,g,y,A(C._payload),I)}if(fo(C)||Xi(C))return _=_.get(y)||null,f(g,_,C,I,null);Pr(g,C)}return null}function v(_,g,y,C){for(var I=null,A=null,N=g,k=g=0,w=null;N!==null&&k<y.length;k++){N.index>k?(w=N,N=null):w=N.sibling;var P=p(_,N,y[k],C);if(P===null){N===null&&(N=w);break}t&&N&&P.alternate===null&&e(_,N),g=r(P,g,k),A===null?I=P:A.sibling=P,A=P,N=w}if(k===y.length)return n(_,N),ae&&wn(_,k),I;if(N===null){for(;k<y.length;k++)N=h(_,y[k],C),N!==null&&(g=r(N,g,k),A===null?I=N:A.sibling=N,A=N);return ae&&wn(_,k),I}for(N=i(_,N);k<y.length;k++)w=m(N,_,k,y[k],C),w!==null&&(t&&w.alternate!==null&&N.delete(w.key===null?k:w.key),g=r(w,g,k),A===null?I=w:A.sibling=w,A=w);return t&&N.forEach(function(F){return e(_,F)}),ae&&wn(_,k),I}function E(_,g,y,C){var I=Xi(y);if(typeof I!="function")throw Error(R(150));if(y=I.call(y),y==null)throw Error(R(151));for(var A=I=null,N=g,k=g=0,w=null,P=y.next();N!==null&&!P.done;k++,P=y.next()){N.index>k?(w=N,N=null):w=N.sibling;var F=p(_,N,P.value,C);if(F===null){N===null&&(N=w);break}t&&N&&F.alternate===null&&e(_,N),g=r(F,g,k),A===null?I=F:A.sibling=F,A=F,N=w}if(P.done)return n(_,N),ae&&wn(_,k),I;if(N===null){for(;!P.done;k++,P=y.next())P=h(_,P.value,C),P!==null&&(g=r(P,g,k),A===null?I=P:A.sibling=P,A=P);return ae&&wn(_,k),I}for(N=i(_,N);!P.done;k++,P=y.next())P=m(N,_,k,P.value,C),P!==null&&(t&&P.alternate!==null&&N.delete(P.key===null?k:P.key),g=r(P,g,k),A===null?I=P:A.sibling=P,A=P);return t&&N.forEach(function(U){return e(_,U)}),ae&&wn(_,k),I}function S(_,g,y,C){if(typeof y=="object"&&y!==null&&y.type===ei&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case yr:e:{for(var I=y.key,A=g;A!==null;){if(A.key===I){if(I=y.type,I===ei){if(A.tag===7){n(_,A.sibling),g=o(A,y.props.children),g.return=_,_=g;break e}}else if(A.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Xt&&ef(I)===A.type){n(_,A.sibling),g=o(A,y.props),g.ref=no(_,A,y),g.return=_,_=g;break e}n(_,A);break}else e(_,A);A=A.sibling}y.type===ei?(g=Fn(y.props.children,_.mode,C,y.key),g.return=_,_=g):(C=Kr(y.type,y.key,y.props,null,_.mode,C),C.ref=no(_,g,y),C.return=_,_=C)}return s(_);case jn:e:{for(A=y.key;g!==null;){if(g.key===A)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(_,g.sibling),g=o(g,y.children||[]),g.return=_,_=g;break e}else{n(_,g);break}else e(_,g);g=g.sibling}g=Jl(y,_.mode,C),g.return=_,_=g}return s(_);case Xt:return A=y._init,S(_,g,A(y._payload),C)}if(fo(y))return v(_,g,y,C);if(Xi(y))return E(_,g,y,C);Pr(_,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(_,g.sibling),g=o(g,y),g.return=_,_=g):(n(_,g),g=$l(y,_.mode,C),g.return=_,_=g),s(_)):n(_,g)}return S}var xi=lg(!0),ag=lg(!1),fs=En(null),hs=null,ai=null,tc=null;function nc(){tc=ai=hs=null}function ic(t){var e=fs.current;le(fs),t._currentValue=e}function Va(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function yi(t,e){hs=t,tc=ai=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ze=!0),t.firstContext=null)}function ut(t){var e=t._currentValue;if(tc!==t)if(t={context:t,memoizedValue:e,next:null},ai===null){if(hs===null)throw Error(R(308));ai=t,hs.dependencies={lanes:0,firstContext:t}}else ai=ai.next=t;return e}var xn=null;function oc(t){xn===null?xn=[t]:xn.push(t)}function ug(t,e,n,i){var o=e.interleaved;return o===null?(n.next=n,oc(e)):(n.next=o.next,o.next=n),e.interleaved=n,Ht(t,i)}function Ht(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zt=!1;function rc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cg(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ut(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function an(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,$&2){var o=i.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),i.pending=e,Ht(t,n)}return o=i.interleaved,o===null?(e.next=e,oc(i)):(e.next=o.next,o.next=e),i.interleaved=e,Ht(t,n)}function br(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,zu(t,n)}}function tf(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var o=null,r=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};r===null?o=r=s:r=r.next=s,n=n.next}while(n!==null);r===null?o=r=e:r=r.next=e}else o=r=e;n={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:r,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ps(t,e,n,i){var o=t.updateQueue;Zt=!1;var r=o.firstBaseUpdate,s=o.lastBaseUpdate,a=o.shared.pending;if(a!==null){o.shared.pending=null;var c=a,d=c.next;c.next=null,s===null?r=d:s.next=d,s=c;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==s&&(a===null?f.firstBaseUpdate=d:a.next=d,f.lastBaseUpdate=c))}if(r!==null){var h=o.baseState;s=0,f=d=c=null,a=r;do{var p=a.lane,m=a.eventTime;if((i&p)===p){f!==null&&(f=f.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=t,E=a;switch(p=e,m=n,E.tag){case 1:if(v=E.payload,typeof v=="function"){h=v.call(m,h,p);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=E.payload,p=typeof v=="function"?v.call(m,h,p):v,p==null)break e;h=he({},h,p);break e;case 2:Zt=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=o.effects,p===null?o.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(d=f=m,c=h):f=f.next=m,s|=p;if(a=a.next,a===null){if(a=o.shared.pending,a===null)break;p=a,a=p.next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}while(!0);if(f===null&&(c=h),o.baseState=c,o.firstBaseUpdate=d,o.lastBaseUpdate=f,e=o.shared.interleaved,e!==null){o=e;do s|=o.lane,o=o.next;while(o!==e)}else r===null&&(o.shared.lanes=0);On|=s,t.lanes=s,t.memoizedState=h}}function nf(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],o=i.callback;if(o!==null){if(i.callback=null,i=n,typeof o!="function")throw Error(R(191,o));o.call(i)}}}var ar={},Nt=En(ar),Bo=En(ar),qo=En(ar);function kn(t){if(t===ar)throw Error(R(174));return t}function sc(t,e){switch(te(qo,e),te(Bo,t),te(Nt,ar),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:_a(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=_a(e,t)}le(Nt),te(Nt,e)}function ki(){le(Nt),le(Bo),le(qo)}function dg(t){kn(qo.current);var e=kn(Nt.current),n=_a(e,t.type);e!==n&&(te(Bo,t),te(Nt,n))}function lc(t){Bo.current===t&&(le(Nt),le(Bo))}var ce=En(0);function ms(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Hl=[];function ac(){for(var t=0;t<Hl.length;t++)Hl[t]._workInProgressVersionPrimary=null;Hl.length=0}var zr=$t.ReactCurrentDispatcher,Bl=$t.ReactCurrentBatchConfig,Gn=0,fe=null,Ee=null,we=null,gs=!1,Eo=!1,bo=0,lC=0;function De(){throw Error(R(321))}function uc(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Et(t[n],e[n]))return!1;return!0}function cc(t,e,n,i,o,r){if(Gn=r,fe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zr.current=t===null||t.memoizedState===null?dC:fC,t=n(i,o),Eo){r=0;do{if(Eo=!1,bo=0,25<=r)throw Error(R(301));r+=1,we=Ee=null,e.updateQueue=null,zr.current=hC,t=n(i,o)}while(Eo)}if(zr.current=_s,e=Ee!==null&&Ee.next!==null,Gn=0,we=Ee=fe=null,gs=!1,e)throw Error(R(300));return t}function dc(){var t=bo!==0;return bo=0,t}function It(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return we===null?fe.memoizedState=we=t:we=we.next=t,we}function ct(){if(Ee===null){var t=fe.alternate;t=t!==null?t.memoizedState:null}else t=Ee.next;var e=we===null?fe.memoizedState:we.next;if(e!==null)we=e,Ee=t;else{if(t===null)throw Error(R(310));Ee=t,t={memoizedState:Ee.memoizedState,baseState:Ee.baseState,baseQueue:Ee.baseQueue,queue:Ee.queue,next:null},we===null?fe.memoizedState=we=t:we=we.next=t}return we}function zo(t,e){return typeof e=="function"?e(t):e}function ql(t){var e=ct(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var i=Ee,o=i.baseQueue,r=n.pending;if(r!==null){if(o!==null){var s=o.next;o.next=r.next,r.next=s}i.baseQueue=o=r,n.pending=null}if(o!==null){r=o.next,i=i.baseState;var a=s=null,c=null,d=r;do{var f=d.lane;if((Gn&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),i=d.hasEagerState?d.eagerState:t(i,d.action);else{var h={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=h,s=i):c=c.next=h,fe.lanes|=f,On|=f}d=d.next}while(d!==null&&d!==r);c===null?s=i:c.next=a,Et(i,e.memoizedState)||(ze=!0),e.memoizedState=i,e.baseState=s,e.baseQueue=c,n.lastRenderedState=i}if(t=n.interleaved,t!==null){o=t;do r=o.lane,fe.lanes|=r,On|=r,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function bl(t){var e=ct(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var i=n.dispatch,o=n.pending,r=e.memoizedState;if(o!==null){n.pending=null;var s=o=o.next;do r=t(r,s.action),s=s.next;while(s!==o);Et(r,e.memoizedState)||(ze=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),n.lastRenderedState=r}return[r,i]}function fg(){}function hg(t,e){var n=fe,i=ct(),o=e(),r=!Et(i.memoizedState,o);if(r&&(i.memoizedState=o,ze=!0),i=i.queue,fc(gg.bind(null,n,i,t),[t]),i.getSnapshot!==e||r||we!==null&&we.memoizedState.tag&1){if(n.flags|=2048,Wo(9,mg.bind(null,n,i,o,e),void 0,null),Re===null)throw Error(R(349));Gn&30||pg(n,e,o)}return o}function pg(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=fe.updateQueue,e===null?(e={lastEffect:null,stores:null},fe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function mg(t,e,n,i){e.value=n,e.getSnapshot=i,_g(e)&&yg(t)}function gg(t,e,n){return n(function(){_g(e)&&yg(t)})}function _g(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Et(t,n)}catch{return!0}}function yg(t){var e=Ht(t,1);e!==null&&yt(e,t,1,-1)}function of(t){var e=It();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zo,lastRenderedState:t},e.queue=t,t=t.dispatch=cC.bind(null,fe,t),[e.memoizedState,t]}function Wo(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=fe.updateQueue,e===null?(e={lastEffect:null,stores:null},fe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function vg(){return ct().memoizedState}function Wr(t,e,n,i){var o=It();fe.flags|=t,o.memoizedState=Wo(1|e,n,void 0,i===void 0?null:i)}function Xs(t,e,n,i){var o=ct();i=i===void 0?null:i;var r=void 0;if(Ee!==null){var s=Ee.memoizedState;if(r=s.destroy,i!==null&&uc(i,s.deps)){o.memoizedState=Wo(e,n,r,i);return}}fe.flags|=t,o.memoizedState=Wo(1|e,n,r,i)}function rf(t,e){return Wr(8390656,8,t,e)}function fc(t,e){return Xs(2048,8,t,e)}function Eg(t,e){return Xs(4,2,t,e)}function Cg(t,e){return Xs(4,4,t,e)}function Tg(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Sg(t,e,n){return n=n!=null?n.concat([t]):null,Xs(4,4,Tg.bind(null,e,t),n)}function hc(){}function Ig(t,e){var n=ct();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&uc(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function wg(t,e){var n=ct();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&uc(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Ag(t,e,n){return Gn&21?(Et(n,e)||(n=km(),fe.lanes|=n,On|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ze=!0),t.memoizedState=n)}function aC(t,e){var n=Q;Q=n!==0&&4>n?n:4,t(!0);var i=Bl.transition;Bl.transition={};try{t(!1),e()}finally{Q=n,Bl.transition=i}}function Ng(){return ct().memoizedState}function uC(t,e,n){var i=cn(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Rg(t))Pg(e,n);else if(n=ug(t,e,n,i),n!==null){var o=He();yt(n,t,i,o),xg(n,e,i)}}function cC(t,e,n){var i=cn(t),o={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Rg(t))Pg(e,o);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var s=e.lastRenderedState,a=r(s,n);if(o.hasEagerState=!0,o.eagerState=a,Et(a,s)){var c=e.interleaved;c===null?(o.next=o,oc(e)):(o.next=c.next,c.next=o),e.interleaved=o;return}}catch{}finally{}n=ug(t,e,o,i),n!==null&&(o=He(),yt(n,t,i,o),xg(n,e,i))}}function Rg(t){var e=t.alternate;return t===fe||e!==null&&e===fe}function Pg(t,e){Eo=gs=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function xg(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,zu(t,n)}}var _s={readContext:ut,useCallback:De,useContext:De,useEffect:De,useImperativeHandle:De,useInsertionEffect:De,useLayoutEffect:De,useMemo:De,useReducer:De,useRef:De,useState:De,useDebugValue:De,useDeferredValue:De,useTransition:De,useMutableSource:De,useSyncExternalStore:De,useId:De,unstable_isNewReconciler:!1},dC={readContext:ut,useCallback:function(t,e){return It().memoizedState=[t,e===void 0?null:e],t},useContext:ut,useEffect:rf,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Wr(4194308,4,Tg.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Wr(4194308,4,t,e)},useInsertionEffect:function(t,e){return Wr(4,2,t,e)},useMemo:function(t,e){var n=It();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=It();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=uC.bind(null,fe,t),[i.memoizedState,t]},useRef:function(t){var e=It();return t={current:t},e.memoizedState=t},useState:of,useDebugValue:hc,useDeferredValue:function(t){return It().memoizedState=t},useTransition:function(){var t=of(!1),e=t[0];return t=aC.bind(null,t[1]),It().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=fe,o=It();if(ae){if(n===void 0)throw Error(R(407));n=n()}else{if(n=e(),Re===null)throw Error(R(349));Gn&30||pg(i,e,n)}o.memoizedState=n;var r={value:n,getSnapshot:e};return o.queue=r,rf(gg.bind(null,i,r,t),[t]),i.flags|=2048,Wo(9,mg.bind(null,i,r,n,e),void 0,null),n},useId:function(){var t=It(),e=Re.identifierPrefix;if(ae){var n=Lt,i=Dt;n=(i&~(1<<32-_t(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=bo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=lC++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fC={readContext:ut,useCallback:Ig,useContext:ut,useEffect:fc,useImperativeHandle:Sg,useInsertionEffect:Eg,useLayoutEffect:Cg,useMemo:wg,useReducer:ql,useRef:vg,useState:function(){return ql(zo)},useDebugValue:hc,useDeferredValue:function(t){var e=ct();return Ag(e,Ee.memoizedState,t)},useTransition:function(){var t=ql(zo)[0],e=ct().memoizedState;return[t,e]},useMutableSource:fg,useSyncExternalStore:hg,useId:Ng,unstable_isNewReconciler:!1},hC={readContext:ut,useCallback:Ig,useContext:ut,useEffect:fc,useImperativeHandle:Sg,useInsertionEffect:Eg,useLayoutEffect:Cg,useMemo:wg,useReducer:bl,useRef:vg,useState:function(){return bl(zo)},useDebugValue:hc,useDeferredValue:function(t){var e=ct();return Ee===null?e.memoizedState=t:Ag(e,Ee.memoizedState,t)},useTransition:function(){var t=bl(zo)[0],e=ct().memoizedState;return[t,e]},useMutableSource:fg,useSyncExternalStore:hg,useId:Ng,unstable_isNewReconciler:!1};function ft(t,e){if(t&&t.defaultProps){e=he({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ga(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:he({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Zs={isMounted:function(t){return(t=t._reactInternals)?$n(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=He(),o=cn(t),r=Ut(i,o);r.payload=e,n!=null&&(r.callback=n),e=an(t,r,o),e!==null&&(yt(e,t,o,i),br(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=He(),o=cn(t),r=Ut(i,o);r.tag=1,r.payload=e,n!=null&&(r.callback=n),e=an(t,r,o),e!==null&&(yt(e,t,o,i),br(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=He(),i=cn(t),o=Ut(n,i);o.tag=2,e!=null&&(o.callback=e),e=an(t,o,i),e!==null&&(yt(e,t,i,n),br(e,t,i))}};function sf(t,e,n,i,o,r,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,r,s):e.prototype&&e.prototype.isPureReactComponent?!Vo(n,i)||!Vo(o,r):!0}function kg(t,e,n){var i=!1,o=gn,r=e.contextType;return typeof r=="object"&&r!==null?r=ut(r):(o=Ye(e)?Un:Ve.current,i=e.contextTypes,r=(i=i!=null)?Ri(t,o):gn),e=new e(n,r),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Zs,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=r),e}function lf(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&Zs.enqueueReplaceState(e,e.state,null)}function Oa(t,e,n,i){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs={},rc(t);var r=e.contextType;typeof r=="object"&&r!==null?o.context=ut(r):(r=Ye(e)?Un:Ve.current,o.context=Ri(t,r)),o.state=t.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(Ga(t,e,r,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&Zs.enqueueReplaceState(o,o.state,null),ps(t,n,o,i),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function Mi(t,e){try{var n="",i=e;do n+=Bv(i),i=i.return;while(i);var o=n}catch(r){o=`
Error generating stack: `+r.message+`
`+r.stack}return{value:t,source:e,stack:o,digest:null}}function zl(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ha(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var pC=typeof WeakMap=="function"?WeakMap:Map;function Mg(t,e,n){n=Ut(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){vs||(vs=!0,Qa=i),Ha(t,e)},n}function Dg(t,e,n){n=Ut(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var o=e.value;n.payload=function(){return i(o)},n.callback=function(){Ha(t,e)}}var r=t.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(n.callback=function(){Ha(t,e),typeof i!="function"&&(un===null?un=new Set([this]):un.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function af(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new pC;var o=new Set;i.set(e,o)}else o=i.get(e),o===void 0&&(o=new Set,i.set(e,o));o.has(n)||(o.add(n),t=RC.bind(null,t,e,n),e.then(t,t))}function uf(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function cf(t,e,n,i,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ut(-1,1),e.tag=2,an(n,e,1))),n.lanes|=1),t)}var mC=$t.ReactCurrentOwner,ze=!1;function Oe(t,e,n,i){e.child=t===null?ag(e,null,n,i):xi(e,t.child,n,i)}function df(t,e,n,i,o){n=n.render;var r=e.ref;return yi(e,o),i=cc(t,e,n,i,r,o),n=dc(),t!==null&&!ze?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,Bt(t,e,o)):(ae&&n&&Zu(e),e.flags|=1,Oe(t,e,i,o),e.child)}function ff(t,e,n,i,o){if(t===null){var r=n.type;return typeof r=="function"&&!Cc(r)&&r.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=r,Lg(t,e,r,i,o)):(t=Kr(n.type,null,i,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(r=t.child,!(t.lanes&o)){var s=r.memoizedProps;if(n=n.compare,n=n!==null?n:Vo,n(s,i)&&t.ref===e.ref)return Bt(t,e,o)}return e.flags|=1,t=dn(r,i),t.ref=e.ref,t.return=e,e.child=t}function Lg(t,e,n,i,o){if(t!==null){var r=t.memoizedProps;if(Vo(r,i)&&t.ref===e.ref)if(ze=!1,e.pendingProps=i=r,(t.lanes&o)!==0)t.flags&131072&&(ze=!0);else return e.lanes=t.lanes,Bt(t,e,o)}return Ba(t,e,n,i,o)}function Fg(t,e,n){var i=e.pendingProps,o=i.children,r=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},te(ci,Xe),Xe|=n;else{if(!(n&1073741824))return t=r!==null?r.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,te(ci,Xe),Xe|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=r!==null?r.baseLanes:n,te(ci,Xe),Xe|=i}else r!==null?(i=r.baseLanes|n,e.memoizedState=null):i=n,te(ci,Xe),Xe|=i;return Oe(t,e,o,n),e.child}function Ug(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ba(t,e,n,i,o){var r=Ye(n)?Un:Ve.current;return r=Ri(e,r),yi(e,o),n=cc(t,e,n,i,r,o),i=dc(),t!==null&&!ze?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,Bt(t,e,o)):(ae&&i&&Zu(e),e.flags|=1,Oe(t,e,n,o),e.child)}function hf(t,e,n,i,o){if(Ye(n)){var r=!0;us(e)}else r=!1;if(yi(e,o),e.stateNode===null)$r(t,e),kg(e,n,i),Oa(e,n,i,o),i=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var c=s.context,d=n.contextType;typeof d=="object"&&d!==null?d=ut(d):(d=Ye(n)?Un:Ve.current,d=Ri(e,d));var f=n.getDerivedStateFromProps,h=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==i||c!==d)&&lf(e,s,i,d),Zt=!1;var p=e.memoizedState;s.state=p,ps(e,i,s,o),c=e.memoizedState,a!==i||p!==c||Je.current||Zt?(typeof f=="function"&&(Ga(e,n,f,i),c=e.memoizedState),(a=Zt||sf(e,n,a,i,p,c,d))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),s.props=i,s.state=c,s.context=d,i=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{s=e.stateNode,cg(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:ft(e.type,a),s.props=d,h=e.pendingProps,p=s.context,c=n.contextType,typeof c=="object"&&c!==null?c=ut(c):(c=Ye(n)?Un:Ve.current,c=Ri(e,c));var m=n.getDerivedStateFromProps;(f=typeof m=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==h||p!==c)&&lf(e,s,i,c),Zt=!1,p=e.memoizedState,s.state=p,ps(e,i,s,o);var v=e.memoizedState;a!==h||p!==v||Je.current||Zt?(typeof m=="function"&&(Ga(e,n,m,i),v=e.memoizedState),(d=Zt||sf(e,n,d,i,p,v,c)||!1)?(f||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(i,v,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(i,v,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=v),s.props=i,s.state=v,s.context=c,i=d):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),i=!1)}return qa(t,e,n,i,r,o)}function qa(t,e,n,i,o,r){Ug(t,e);var s=(e.flags&128)!==0;if(!i&&!s)return o&&Xd(e,n,!1),Bt(t,e,r);i=e.stateNode,mC.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&s?(e.child=xi(e,t.child,null,r),e.child=xi(e,null,a,r)):Oe(t,e,a,r),e.memoizedState=i.state,o&&Xd(e,n,!0),e.child}function Vg(t){var e=t.stateNode;e.pendingContext?Qd(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Qd(t,e.context,!1),sc(t,e.containerInfo)}function pf(t,e,n,i,o){return Pi(),ec(o),e.flags|=256,Oe(t,e,n,i),e.child}var ba={dehydrated:null,treeContext:null,retryLane:0};function za(t){return{baseLanes:t,cachePool:null,transitions:null}}function Gg(t,e,n){var i=e.pendingProps,o=ce.current,r=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(o&2)!==0),a?(r=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),te(ce,o&1),t===null)return Ua(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=i.children,t=i.fallback,r?(i=e.mode,r=e.child,s={mode:"hidden",children:s},!(i&1)&&r!==null?(r.childLanes=0,r.pendingProps=s):r=tl(s,i,0,null),t=Fn(t,i,n,null),r.return=e,t.return=e,r.sibling=t,e.child=r,e.child.memoizedState=za(n),e.memoizedState=ba,t):pc(e,s));if(o=t.memoizedState,o!==null&&(a=o.dehydrated,a!==null))return gC(t,e,s,i,a,o,n);if(r){r=i.fallback,s=e.mode,o=t.child,a=o.sibling;var c={mode:"hidden",children:i.children};return!(s&1)&&e.child!==o?(i=e.child,i.childLanes=0,i.pendingProps=c,e.deletions=null):(i=dn(o,c),i.subtreeFlags=o.subtreeFlags&14680064),a!==null?r=dn(a,r):(r=Fn(r,s,n,null),r.flags|=2),r.return=e,i.return=e,i.sibling=r,e.child=i,i=r,r=e.child,s=t.child.memoizedState,s=s===null?za(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},r.memoizedState=s,r.childLanes=t.childLanes&~n,e.memoizedState=ba,i}return r=t.child,t=r.sibling,i=dn(r,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function pc(t,e){return e=tl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function xr(t,e,n,i){return i!==null&&ec(i),xi(e,t.child,null,n),t=pc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gC(t,e,n,i,o,r,s){if(n)return e.flags&256?(e.flags&=-257,i=zl(Error(R(422))),xr(t,e,s,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(r=i.fallback,o=e.mode,i=tl({mode:"visible",children:i.children},o,0,null),r=Fn(r,o,s,null),r.flags|=2,i.return=e,r.return=e,i.sibling=r,e.child=i,e.mode&1&&xi(e,t.child,null,s),e.child.memoizedState=za(s),e.memoizedState=ba,r);if(!(e.mode&1))return xr(t,e,s,null);if(o.data==="$!"){if(i=o.nextSibling&&o.nextSibling.dataset,i)var a=i.dgst;return i=a,r=Error(R(419)),i=zl(r,i,void 0),xr(t,e,s,i)}if(a=(s&t.childLanes)!==0,ze||a){if(i=Re,i!==null){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(i.suspendedLanes|s)?0:o,o!==0&&o!==r.retryLane&&(r.retryLane=o,Ht(t,o),yt(i,t,o,-1))}return Ec(),i=zl(Error(R(421))),xr(t,e,s,i)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=PC.bind(null,t),o._reactRetry=e,null):(t=r.treeContext,Ze=ln(o.nextSibling),je=e,ae=!0,pt=null,t!==null&&(it[ot++]=Dt,it[ot++]=Lt,it[ot++]=Vn,Dt=t.id,Lt=t.overflow,Vn=e),e=pc(e,i.children),e.flags|=4096,e)}function mf(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),Va(t.return,e,n)}function Wl(t,e,n,i,o){var r=t.memoizedState;r===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:o}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=n,r.tailMode=o)}function Og(t,e,n){var i=e.pendingProps,o=i.revealOrder,r=i.tail;if(Oe(t,e,i.children,n),i=ce.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&mf(t,n,e);else if(t.tag===19)mf(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(te(ce,i),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&ms(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),Wl(e,!1,o,n,r);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&ms(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}Wl(e,!0,n,null,r);break;case"together":Wl(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $r(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Bt(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),On|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,n=dn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=dn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function _C(t,e,n){switch(e.tag){case 3:Vg(e),Pi();break;case 5:dg(e);break;case 1:Ye(e.type)&&us(e);break;case 4:sc(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,o=e.memoizedProps.value;te(fs,i._currentValue),i._currentValue=o;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(te(ce,ce.current&1),e.flags|=128,null):n&e.child.childLanes?Gg(t,e,n):(te(ce,ce.current&1),t=Bt(t,e,n),t!==null?t.sibling:null);te(ce,ce.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return Og(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),te(ce,ce.current),i)break;return null;case 22:case 23:return e.lanes=0,Fg(t,e,n)}return Bt(t,e,n)}var Hg,Wa,Bg,qg;Hg=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Wa=function(){};Bg=function(t,e,n,i){var o=t.memoizedProps;if(o!==i){t=e.stateNode,kn(Nt.current);var r=null;switch(n){case"input":o=ha(t,o),i=ha(t,i),r=[];break;case"select":o=he({},o,{value:void 0}),i=he({},i,{value:void 0}),r=[];break;case"textarea":o=ga(t,o),i=ga(t,i),r=[];break;default:typeof o.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=ls)}ya(n,i);var s;n=null;for(d in o)if(!i.hasOwnProperty(d)&&o.hasOwnProperty(d)&&o[d]!=null)if(d==="style"){var a=o[d];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(xo.hasOwnProperty(d)?r||(r=[]):(r=r||[]).push(d,null));for(d in i){var c=i[d];if(a=o!=null?o[d]:void 0,i.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(s in a)!a.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&a[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(r||(r=[]),r.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(r=r||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(xo.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ie("scroll",t),r||a===c||(r=[])):(r=r||[]).push(d,c))}n&&(r=r||[]).push("style",n);var d=r;(e.updateQueue=d)&&(e.flags|=4)}};qg=function(t,e,n,i){n!==i&&(e.flags|=4)};function io(t,e){if(!ae)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Le(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags&14680064,i|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function yC(t,e,n){var i=e.pendingProps;switch(ju(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Le(e),null;case 1:return Ye(e.type)&&as(),Le(e),null;case 3:return i=e.stateNode,ki(),le(Je),le(Ve),ac(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Rr(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,pt!==null&&(ja(pt),pt=null))),Wa(t,e),Le(e),null;case 5:lc(e);var o=kn(qo.current);if(n=e.type,t!==null&&e.stateNode!=null)Bg(t,e,n,i,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(R(166));return Le(e),null}if(t=kn(Nt.current),Rr(e)){i=e.stateNode,n=e.type;var r=e.memoizedProps;switch(i[wt]=e,i[Ho]=r,t=(e.mode&1)!==0,n){case"dialog":ie("cancel",i),ie("close",i);break;case"iframe":case"object":case"embed":ie("load",i);break;case"video":case"audio":for(o=0;o<po.length;o++)ie(po[o],i);break;case"source":ie("error",i);break;case"img":case"image":case"link":ie("error",i),ie("load",i);break;case"details":ie("toggle",i);break;case"input":Sd(i,r),ie("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!r.multiple},ie("invalid",i);break;case"textarea":wd(i,r),ie("invalid",i)}ya(n,r),o=null;for(var s in r)if(r.hasOwnProperty(s)){var a=r[s];s==="children"?typeof a=="string"?i.textContent!==a&&(r.suppressHydrationWarning!==!0&&Nr(i.textContent,a,t),o=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(r.suppressHydrationWarning!==!0&&Nr(i.textContent,a,t),o=["children",""+a]):xo.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&ie("scroll",i)}switch(n){case"input":vr(i),Id(i,r,!0);break;case"textarea":vr(i),Ad(i);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(i.onclick=ls)}i=o,e.updateQueue=i,i!==null&&(e.flags|=4)}else{s=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=gm(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=s.createElement(n,{is:i.is}):(t=s.createElement(n),n==="select"&&(s=t,i.multiple?s.multiple=!0:i.size&&(s.size=i.size))):t=s.createElementNS(t,n),t[wt]=e,t[Ho]=i,Hg(t,e,!1,!1),e.stateNode=t;e:{switch(s=va(n,i),n){case"dialog":ie("cancel",t),ie("close",t),o=i;break;case"iframe":case"object":case"embed":ie("load",t),o=i;break;case"video":case"audio":for(o=0;o<po.length;o++)ie(po[o],t);o=i;break;case"source":ie("error",t),o=i;break;case"img":case"image":case"link":ie("error",t),ie("load",t),o=i;break;case"details":ie("toggle",t),o=i;break;case"input":Sd(t,i),o=ha(t,i),ie("invalid",t);break;case"option":o=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},o=he({},i,{value:void 0}),ie("invalid",t);break;case"textarea":wd(t,i),o=ga(t,i),ie("invalid",t);break;default:o=i}ya(n,o),a=o;for(r in a)if(a.hasOwnProperty(r)){var c=a[r];r==="style"?vm(t,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&_m(t,c)):r==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ko(t,c):typeof c=="number"&&ko(t,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(xo.hasOwnProperty(r)?c!=null&&r==="onScroll"&&ie("scroll",t):c!=null&&Gu(t,r,c,s))}switch(n){case"input":vr(t),Id(t,i,!1);break;case"textarea":vr(t),Ad(t);break;case"option":i.value!=null&&t.setAttribute("value",""+mn(i.value));break;case"select":t.multiple=!!i.multiple,r=i.value,r!=null?pi(t,!!i.multiple,r,!1):i.defaultValue!=null&&pi(t,!!i.multiple,i.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=ls)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Le(e),null;case 6:if(t&&e.stateNode!=null)qg(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(R(166));if(n=kn(qo.current),kn(Nt.current),Rr(e)){if(i=e.stateNode,n=e.memoizedProps,i[wt]=e,(r=i.nodeValue!==n)&&(t=je,t!==null))switch(t.tag){case 3:Nr(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Nr(i.nodeValue,n,(t.mode&1)!==0)}r&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[wt]=e,e.stateNode=i}return Le(e),null;case 13:if(le(ce),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ae&&Ze!==null&&e.mode&1&&!(e.flags&128))sg(),Pi(),e.flags|=98560,r=!1;else if(r=Rr(e),i!==null&&i.dehydrated!==null){if(t===null){if(!r)throw Error(R(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(R(317));r[wt]=e}else Pi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Le(e),r=!1}else pt!==null&&(ja(pt),pt=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||ce.current&1?Ce===0&&(Ce=3):Ec())),e.updateQueue!==null&&(e.flags|=4),Le(e),null);case 4:return ki(),Wa(t,e),t===null&&Go(e.stateNode.containerInfo),Le(e),null;case 10:return ic(e.type._context),Le(e),null;case 17:return Ye(e.type)&&as(),Le(e),null;case 19:if(le(ce),r=e.memoizedState,r===null)return Le(e),null;if(i=(e.flags&128)!==0,s=r.rendering,s===null)if(i)io(r,!1);else{if(Ce!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=ms(t),s!==null){for(e.flags|=128,io(r,!1),i=s.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)r=n,t=i,r.flags&=14680066,s=r.alternate,s===null?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=s.childLanes,r.lanes=s.lanes,r.child=s.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=s.memoizedProps,r.memoizedState=s.memoizedState,r.updateQueue=s.updateQueue,r.type=s.type,t=s.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return te(ce,ce.current&1|2),e.child}t=t.sibling}r.tail!==null&&ge()>Di&&(e.flags|=128,i=!0,io(r,!1),e.lanes=4194304)}else{if(!i)if(t=ms(s),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),io(r,!0),r.tail===null&&r.tailMode==="hidden"&&!s.alternate&&!ae)return Le(e),null}else 2*ge()-r.renderingStartTime>Di&&n!==1073741824&&(e.flags|=128,i=!0,io(r,!1),e.lanes=4194304);r.isBackwards?(s.sibling=e.child,e.child=s):(n=r.last,n!==null?n.sibling=s:e.child=s,r.last=s)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=ge(),e.sibling=null,n=ce.current,te(ce,i?n&1|2:n&1),e):(Le(e),null);case 22:case 23:return vc(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Xe&1073741824&&(Le(e),e.subtreeFlags&6&&(e.flags|=8192)):Le(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function vC(t,e){switch(ju(e),e.tag){case 1:return Ye(e.type)&&as(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ki(),le(Je),le(Ve),ac(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return lc(e),null;case 13:if(le(ce),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));Pi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return le(ce),null;case 4:return ki(),null;case 10:return ic(e.type._context),null;case 22:case 23:return vc(),null;case 24:return null;default:return null}}var kr=!1,Fe=!1,EC=typeof WeakSet=="function"?WeakSet:Set,L=null;function ui(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){pe(t,e,i)}else n.current=null}function $a(t,e,n){try{n()}catch(i){pe(t,e,i)}}var gf=!1;function CC(t,e){if(Pa=os,t=Jm(),Xu(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var o=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{n.nodeType,r.nodeType}catch{n=null;break e}var s=0,a=-1,c=-1,d=0,f=0,h=t,p=null;t:for(;;){for(var m;h!==n||o!==0&&h.nodeType!==3||(a=s+o),h!==r||i!==0&&h.nodeType!==3||(c=s+i),h.nodeType===3&&(s+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===t)break t;if(p===n&&++d===o&&(a=s),p===r&&++f===i&&(c=s),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(xa={focusedElem:t,selectionRange:n},os=!1,L=e;L!==null;)if(e=L,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,L=t;else for(;L!==null;){e=L;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var E=v.memoizedProps,S=v.memoizedState,_=e.stateNode,g=_.getSnapshotBeforeUpdate(e.elementType===e.type?E:ft(e.type,E),S);_.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(C){pe(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,L=t;break}L=e.return}return v=gf,gf=!1,v}function Co(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&t)===t){var r=o.destroy;o.destroy=void 0,r!==void 0&&$a(e,n,r)}o=o.next}while(o!==i)}}function js(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function Ja(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function bg(t){var e=t.alternate;e!==null&&(t.alternate=null,bg(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[wt],delete e[Ho],delete e[Da],delete e[iC],delete e[oC])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function zg(t){return t.tag===5||t.tag===3||t.tag===4}function _f(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||zg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ya(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ls));else if(i!==4&&(t=t.child,t!==null))for(Ya(t,e,n),t=t.sibling;t!==null;)Ya(t,e,n),t=t.sibling}function Ka(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(Ka(t,e,n),t=t.sibling;t!==null;)Ka(t,e,n),t=t.sibling}var Pe=null,ht=!1;function Qt(t,e,n){for(n=n.child;n!==null;)Wg(t,e,n),n=n.sibling}function Wg(t,e,n){if(At&&typeof At.onCommitFiberUnmount=="function")try{At.onCommitFiberUnmount(Ws,n)}catch{}switch(n.tag){case 5:Fe||ui(n,e);case 6:var i=Pe,o=ht;Pe=null,Qt(t,e,n),Pe=i,ht=o,Pe!==null&&(ht?(t=Pe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Pe.removeChild(n.stateNode));break;case 18:Pe!==null&&(ht?(t=Pe,n=n.stateNode,t.nodeType===8?Gl(t.parentNode,n):t.nodeType===1&&Gl(t,n),Fo(t)):Gl(Pe,n.stateNode));break;case 4:i=Pe,o=ht,Pe=n.stateNode.containerInfo,ht=!0,Qt(t,e,n),Pe=i,ht=o;break;case 0:case 11:case 14:case 15:if(!Fe&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){o=i=i.next;do{var r=o,s=r.destroy;r=r.tag,s!==void 0&&(r&2||r&4)&&$a(n,e,s),o=o.next}while(o!==i)}Qt(t,e,n);break;case 1:if(!Fe&&(ui(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){pe(n,e,a)}Qt(t,e,n);break;case 21:Qt(t,e,n);break;case 22:n.mode&1?(Fe=(i=Fe)||n.memoizedState!==null,Qt(t,e,n),Fe=i):Qt(t,e,n);break;default:Qt(t,e,n)}}function yf(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new EC),e.forEach(function(i){var o=xC.bind(null,t,i);n.has(i)||(n.add(i),i.then(o,o))})}}function dt(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i];try{var r=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:Pe=a.stateNode,ht=!1;break e;case 3:Pe=a.stateNode.containerInfo,ht=!0;break e;case 4:Pe=a.stateNode.containerInfo,ht=!0;break e}a=a.return}if(Pe===null)throw Error(R(160));Wg(r,s,o),Pe=null,ht=!1;var c=o.alternate;c!==null&&(c.return=null),o.return=null}catch(d){pe(o,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)$g(e,t),e=e.sibling}function $g(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(dt(e,t),Tt(t),i&4){try{Co(3,t,t.return),js(3,t)}catch(E){pe(t,t.return,E)}try{Co(5,t,t.return)}catch(E){pe(t,t.return,E)}}break;case 1:dt(e,t),Tt(t),i&512&&n!==null&&ui(n,n.return);break;case 5:if(dt(e,t),Tt(t),i&512&&n!==null&&ui(n,n.return),t.flags&32){var o=t.stateNode;try{ko(o,"")}catch(E){pe(t,t.return,E)}}if(i&4&&(o=t.stateNode,o!=null)){var r=t.memoizedProps,s=n!==null?n.memoizedProps:r,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&r.type==="radio"&&r.name!=null&&pm(o,r),va(a,s);var d=va(a,r);for(s=0;s<c.length;s+=2){var f=c[s],h=c[s+1];f==="style"?vm(o,h):f==="dangerouslySetInnerHTML"?_m(o,h):f==="children"?ko(o,h):Gu(o,f,h,d)}switch(a){case"input":pa(o,r);break;case"textarea":mm(o,r);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!r.multiple;var m=r.value;m!=null?pi(o,!!r.multiple,m,!1):p!==!!r.multiple&&(r.defaultValue!=null?pi(o,!!r.multiple,r.defaultValue,!0):pi(o,!!r.multiple,r.multiple?[]:"",!1))}o[Ho]=r}catch(E){pe(t,t.return,E)}}break;case 6:if(dt(e,t),Tt(t),i&4){if(t.stateNode===null)throw Error(R(162));o=t.stateNode,r=t.memoizedProps;try{o.nodeValue=r}catch(E){pe(t,t.return,E)}}break;case 3:if(dt(e,t),Tt(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Fo(e.containerInfo)}catch(E){pe(t,t.return,E)}break;case 4:dt(e,t),Tt(t);break;case 13:dt(e,t),Tt(t),o=t.child,o.flags&8192&&(r=o.memoizedState!==null,o.stateNode.isHidden=r,!r||o.alternate!==null&&o.alternate.memoizedState!==null||(_c=ge())),i&4&&yf(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Fe=(d=Fe)||f,dt(e,t),Fe=d):dt(e,t),Tt(t),i&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(L=t,f=t.child;f!==null;){for(h=L=f;L!==null;){switch(p=L,m=p.child,p.tag){case 0:case 11:case 14:case 15:Co(4,p,p.return);break;case 1:ui(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){i=p,n=p.return;try{e=i,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(E){pe(i,n,E)}}break;case 5:ui(p,p.return);break;case 22:if(p.memoizedState!==null){Ef(h);continue}}m!==null?(m.return=p,L=m):Ef(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{o=h.stateNode,d?(r=o.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(a=h.stateNode,c=h.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=ym("display",s))}catch(E){pe(t,t.return,E)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(E){pe(t,t.return,E)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:dt(e,t),Tt(t),i&4&&yf(t);break;case 21:break;default:dt(e,t),Tt(t)}}function Tt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(zg(n)){var i=n;break e}n=n.return}throw Error(R(160))}switch(i.tag){case 5:var o=i.stateNode;i.flags&32&&(ko(o,""),i.flags&=-33);var r=_f(t);Ka(t,r,o);break;case 3:case 4:var s=i.stateNode.containerInfo,a=_f(t);Ya(t,a,s);break;default:throw Error(R(161))}}catch(c){pe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function TC(t,e,n){L=t,Jg(t)}function Jg(t,e,n){for(var i=(t.mode&1)!==0;L!==null;){var o=L,r=o.child;if(o.tag===22&&i){var s=o.memoizedState!==null||kr;if(!s){var a=o.alternate,c=a!==null&&a.memoizedState!==null||Fe;a=kr;var d=Fe;if(kr=s,(Fe=c)&&!d)for(L=o;L!==null;)s=L,c=s.child,s.tag===22&&s.memoizedState!==null?Cf(o):c!==null?(c.return=s,L=c):Cf(o);for(;r!==null;)L=r,Jg(r),r=r.sibling;L=o,kr=a,Fe=d}vf(t)}else o.subtreeFlags&8772&&r!==null?(r.return=o,L=r):vf(t)}}function vf(t){for(;L!==null;){var e=L;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Fe||js(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Fe)if(n===null)i.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:ft(e.type,n.memoizedProps);i.componentDidUpdate(o,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&nf(e,r,i);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}nf(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Fo(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}Fe||e.flags&512&&Ja(e)}catch(p){pe(e,e.return,p)}}if(e===t){L=null;break}if(n=e.sibling,n!==null){n.return=e.return,L=n;break}L=e.return}}function Ef(t){for(;L!==null;){var e=L;if(e===t){L=null;break}var n=e.sibling;if(n!==null){n.return=e.return,L=n;break}L=e.return}}function Cf(t){for(;L!==null;){var e=L;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{js(4,e)}catch(c){pe(e,n,c)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var o=e.return;try{i.componentDidMount()}catch(c){pe(e,o,c)}}var r=e.return;try{Ja(e)}catch(c){pe(e,r,c)}break;case 5:var s=e.return;try{Ja(e)}catch(c){pe(e,s,c)}}}catch(c){pe(e,e.return,c)}if(e===t){L=null;break}var a=e.sibling;if(a!==null){a.return=e.return,L=a;break}L=e.return}}var SC=Math.ceil,ys=$t.ReactCurrentDispatcher,mc=$t.ReactCurrentOwner,lt=$t.ReactCurrentBatchConfig,$=0,Re=null,ve=null,ke=0,Xe=0,ci=En(0),Ce=0,$o=null,On=0,el=0,gc=0,To=null,be=null,_c=0,Di=1/0,xt=null,vs=!1,Qa=null,un=null,Mr=!1,nn=null,Es=0,So=0,Xa=null,Jr=-1,Yr=0;function He(){return $&6?ge():Jr!==-1?Jr:Jr=ge()}function cn(t){return t.mode&1?$&2&&ke!==0?ke&-ke:sC.transition!==null?(Yr===0&&(Yr=km()),Yr):(t=Q,t!==0||(t=window.event,t=t===void 0?16:Gm(t.type)),t):1}function yt(t,e,n,i){if(50<So)throw So=0,Xa=null,Error(R(185));rr(t,n,i),(!($&2)||t!==Re)&&(t===Re&&(!($&2)&&(el|=n),Ce===4&&en(t,ke)),Ke(t,i),n===1&&$===0&&!(e.mode&1)&&(Di=ge()+500,Qs&&Cn()))}function Ke(t,e){var n=t.callbackNode;sE(t,e);var i=is(t,t===Re?ke:0);if(i===0)n!==null&&Pd(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&Pd(n),e===1)t.tag===0?rC(Tf.bind(null,t)):ig(Tf.bind(null,t)),tC(function(){!($&6)&&Cn()}),n=null;else{switch(Mm(i)){case 1:n=bu;break;case 4:n=Pm;break;case 16:n=ns;break;case 536870912:n=xm;break;default:n=ns}n=t_(n,Yg.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Yg(t,e){if(Jr=-1,Yr=0,$&6)throw Error(R(327));var n=t.callbackNode;if(vi()&&t.callbackNode!==n)return null;var i=is(t,t===Re?ke:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Cs(t,i);else{e=i;var o=$;$|=2;var r=Qg();(Re!==t||ke!==e)&&(xt=null,Di=ge()+500,Ln(t,e));do try{AC();break}catch(a){Kg(t,a)}while(!0);nc(),ys.current=r,$=o,ve!==null?e=0:(Re=null,ke=0,e=Ce)}if(e!==0){if(e===2&&(o=Ia(t),o!==0&&(i=o,e=Za(t,o))),e===1)throw n=$o,Ln(t,0),en(t,i),Ke(t,ge()),n;if(e===6)en(t,i);else{if(o=t.current.alternate,!(i&30)&&!IC(o)&&(e=Cs(t,i),e===2&&(r=Ia(t),r!==0&&(i=r,e=Za(t,r))),e===1))throw n=$o,Ln(t,0),en(t,i),Ke(t,ge()),n;switch(t.finishedWork=o,t.finishedLanes=i,e){case 0:case 1:throw Error(R(345));case 2:An(t,be,xt);break;case 3:if(en(t,i),(i&130023424)===i&&(e=_c+500-ge(),10<e)){if(is(t,0)!==0)break;if(o=t.suspendedLanes,(o&i)!==i){He(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=Ma(An.bind(null,t,be,xt),e);break}An(t,be,xt);break;case 4:if(en(t,i),(i&4194240)===i)break;for(e=t.eventTimes,o=-1;0<i;){var s=31-_t(i);r=1<<s,s=e[s],s>o&&(o=s),i&=~r}if(i=o,i=ge()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*SC(i/1960))-i,10<i){t.timeoutHandle=Ma(An.bind(null,t,be,xt),i);break}An(t,be,xt);break;case 5:An(t,be,xt);break;default:throw Error(R(329))}}}return Ke(t,ge()),t.callbackNode===n?Yg.bind(null,t):null}function Za(t,e){var n=To;return t.current.memoizedState.isDehydrated&&(Ln(t,e).flags|=256),t=Cs(t,e),t!==2&&(e=be,be=n,e!==null&&ja(e)),t}function ja(t){be===null?be=t:be.push.apply(be,t)}function IC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var o=n[i],r=o.getSnapshot;o=o.value;try{if(!Et(r(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function en(t,e){for(e&=~gc,e&=~el,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_t(e),i=1<<n;t[n]=-1,e&=~i}}function Tf(t){if($&6)throw Error(R(327));vi();var e=is(t,0);if(!(e&1))return Ke(t,ge()),null;var n=Cs(t,e);if(t.tag!==0&&n===2){var i=Ia(t);i!==0&&(e=i,n=Za(t,i))}if(n===1)throw n=$o,Ln(t,0),en(t,e),Ke(t,ge()),n;if(n===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,An(t,be,xt),Ke(t,ge()),null}function yc(t,e){var n=$;$|=1;try{return t(e)}finally{$=n,$===0&&(Di=ge()+500,Qs&&Cn())}}function Hn(t){nn!==null&&nn.tag===0&&!($&6)&&vi();var e=$;$|=1;var n=lt.transition,i=Q;try{if(lt.transition=null,Q=1,t)return t()}finally{Q=i,lt.transition=n,$=e,!($&6)&&Cn()}}function vc(){Xe=ci.current,le(ci)}function Ln(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,eC(n)),ve!==null)for(n=ve.return;n!==null;){var i=n;switch(ju(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&as();break;case 3:ki(),le(Je),le(Ve),ac();break;case 5:lc(i);break;case 4:ki();break;case 13:le(ce);break;case 19:le(ce);break;case 10:ic(i.type._context);break;case 22:case 23:vc()}n=n.return}if(Re=t,ve=t=dn(t.current,null),ke=Xe=e,Ce=0,$o=null,gc=el=On=0,be=To=null,xn!==null){for(e=0;e<xn.length;e++)if(n=xn[e],i=n.interleaved,i!==null){n.interleaved=null;var o=i.next,r=n.pending;if(r!==null){var s=r.next;r.next=o,i.next=s}n.pending=i}xn=null}return t}function Kg(t,e){do{var n=ve;try{if(nc(),zr.current=_s,gs){for(var i=fe.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}gs=!1}if(Gn=0,we=Ee=fe=null,Eo=!1,bo=0,mc.current=null,n===null||n.return===null){Ce=1,$o=e,ve=null;break}e:{var r=t,s=n.return,a=n,c=e;if(e=ke,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=a,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=uf(s);if(m!==null){m.flags&=-257,cf(m,s,a,r,e),m.mode&1&&af(r,d,e),e=m,c=d;var v=e.updateQueue;if(v===null){var E=new Set;E.add(c),e.updateQueue=E}else v.add(c);break e}else{if(!(e&1)){af(r,d,e),Ec();break e}c=Error(R(426))}}else if(ae&&a.mode&1){var S=uf(s);if(S!==null){!(S.flags&65536)&&(S.flags|=256),cf(S,s,a,r,e),ec(Mi(c,a));break e}}r=c=Mi(c,a),Ce!==4&&(Ce=2),To===null?To=[r]:To.push(r),r=s;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var _=Mg(r,c,e);tf(r,_);break e;case 1:a=c;var g=r.type,y=r.stateNode;if(!(r.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(un===null||!un.has(y)))){r.flags|=65536,e&=-e,r.lanes|=e;var C=Dg(r,a,e);tf(r,C);break e}}r=r.return}while(r!==null)}Zg(n)}catch(I){e=I,ve===n&&n!==null&&(ve=n=n.return);continue}break}while(!0)}function Qg(){var t=ys.current;return ys.current=_s,t===null?_s:t}function Ec(){(Ce===0||Ce===3||Ce===2)&&(Ce=4),Re===null||!(On&268435455)&&!(el&268435455)||en(Re,ke)}function Cs(t,e){var n=$;$|=2;var i=Qg();(Re!==t||ke!==e)&&(xt=null,Ln(t,e));do try{wC();break}catch(o){Kg(t,o)}while(!0);if(nc(),$=n,ys.current=i,ve!==null)throw Error(R(261));return Re=null,ke=0,Ce}function wC(){for(;ve!==null;)Xg(ve)}function AC(){for(;ve!==null&&!Xv();)Xg(ve)}function Xg(t){var e=e_(t.alternate,t,Xe);t.memoizedProps=t.pendingProps,e===null?Zg(t):ve=e,mc.current=null}function Zg(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=vC(n,e),n!==null){n.flags&=32767,ve=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ce=6,ve=null;return}}else if(n=yC(n,e,Xe),n!==null){ve=n;return}if(e=e.sibling,e!==null){ve=e;return}ve=e=t}while(e!==null);Ce===0&&(Ce=5)}function An(t,e,n){var i=Q,o=lt.transition;try{lt.transition=null,Q=1,NC(t,e,n,i)}finally{lt.transition=o,Q=i}return null}function NC(t,e,n,i){do vi();while(nn!==null);if($&6)throw Error(R(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var r=n.lanes|n.childLanes;if(lE(t,r),t===Re&&(ve=Re=null,ke=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Mr||(Mr=!0,t_(ns,function(){return vi(),null})),r=(n.flags&15990)!==0,n.subtreeFlags&15990||r){r=lt.transition,lt.transition=null;var s=Q;Q=1;var a=$;$|=4,mc.current=null,CC(t,n),$g(n,t),JE(xa),os=!!Pa,xa=Pa=null,t.current=n,TC(n),Zv(),$=a,Q=s,lt.transition=r}else t.current=n;if(Mr&&(Mr=!1,nn=t,Es=o),r=t.pendingLanes,r===0&&(un=null),tE(n.stateNode),Ke(t,ge()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],i(o.value,{componentStack:o.stack,digest:o.digest});if(vs)throw vs=!1,t=Qa,Qa=null,t;return Es&1&&t.tag!==0&&vi(),r=t.pendingLanes,r&1?t===Xa?So++:(So=0,Xa=t):So=0,Cn(),null}function vi(){if(nn!==null){var t=Mm(Es),e=lt.transition,n=Q;try{if(lt.transition=null,Q=16>t?16:t,nn===null)var i=!1;else{if(t=nn,nn=null,Es=0,$&6)throw Error(R(331));var o=$;for($|=4,L=t.current;L!==null;){var r=L,s=r.child;if(L.flags&16){var a=r.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(L=d;L!==null;){var f=L;switch(f.tag){case 0:case 11:case 15:Co(8,f,r)}var h=f.child;if(h!==null)h.return=f,L=h;else for(;L!==null;){f=L;var p=f.sibling,m=f.return;if(bg(f),f===d){L=null;break}if(p!==null){p.return=m,L=p;break}L=m}}}var v=r.alternate;if(v!==null){var E=v.child;if(E!==null){v.child=null;do{var S=E.sibling;E.sibling=null,E=S}while(E!==null)}}L=r}}if(r.subtreeFlags&2064&&s!==null)s.return=r,L=s;else e:for(;L!==null;){if(r=L,r.flags&2048)switch(r.tag){case 0:case 11:case 15:Co(9,r,r.return)}var _=r.sibling;if(_!==null){_.return=r.return,L=_;break e}L=r.return}}var g=t.current;for(L=g;L!==null;){s=L;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,L=y;else e:for(s=g;L!==null;){if(a=L,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:js(9,a)}}catch(I){pe(a,a.return,I)}if(a===s){L=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,L=C;break e}L=a.return}}if($=o,Cn(),At&&typeof At.onPostCommitFiberRoot=="function")try{At.onPostCommitFiberRoot(Ws,t)}catch{}i=!0}return i}finally{Q=n,lt.transition=e}}return!1}function Sf(t,e,n){e=Mi(n,e),e=Mg(t,e,1),t=an(t,e,1),e=He(),t!==null&&(rr(t,1,e),Ke(t,e))}function pe(t,e,n){if(t.tag===3)Sf(t,t,n);else for(;e!==null;){if(e.tag===3){Sf(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(un===null||!un.has(i))){t=Mi(n,t),t=Dg(e,t,1),e=an(e,t,1),t=He(),e!==null&&(rr(e,1,t),Ke(e,t));break}}e=e.return}}function RC(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=He(),t.pingedLanes|=t.suspendedLanes&n,Re===t&&(ke&n)===n&&(Ce===4||Ce===3&&(ke&130023424)===ke&&500>ge()-_c?Ln(t,0):gc|=n),Ke(t,e)}function jg(t,e){e===0&&(t.mode&1?(e=Tr,Tr<<=1,!(Tr&130023424)&&(Tr=4194304)):e=1);var n=He();t=Ht(t,e),t!==null&&(rr(t,e,n),Ke(t,n))}function PC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),jg(t,n)}function xC(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(R(314))}i!==null&&i.delete(e),jg(t,n)}var e_;e_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Je.current)ze=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ze=!1,_C(t,e,n);ze=!!(t.flags&131072)}else ze=!1,ae&&e.flags&1048576&&og(e,ds,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;$r(t,e),t=e.pendingProps;var o=Ri(e,Ve.current);yi(e,n),o=cc(null,e,i,t,o,n);var r=dc();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ye(i)?(r=!0,us(e)):r=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,rc(e),o.updater=Zs,e.stateNode=o,o._reactInternals=e,Oa(e,i,t,n),e=qa(null,e,i,!0,r,n)):(e.tag=0,ae&&r&&Zu(e),Oe(null,e,o,n),e=e.child),e;case 16:i=e.elementType;e:{switch($r(t,e),t=e.pendingProps,o=i._init,i=o(i._payload),e.type=i,o=e.tag=MC(i),t=ft(i,t),o){case 0:e=Ba(null,e,i,t,n);break e;case 1:e=hf(null,e,i,t,n);break e;case 11:e=df(null,e,i,t,n);break e;case 14:e=ff(null,e,i,ft(i.type,t),n);break e}throw Error(R(306,i,""))}return e;case 0:return i=e.type,o=e.pendingProps,o=e.elementType===i?o:ft(i,o),Ba(t,e,i,o,n);case 1:return i=e.type,o=e.pendingProps,o=e.elementType===i?o:ft(i,o),hf(t,e,i,o,n);case 3:e:{if(Vg(e),t===null)throw Error(R(387));i=e.pendingProps,r=e.memoizedState,o=r.element,cg(t,e),ps(e,i,null,n);var s=e.memoizedState;if(i=s.element,r.isDehydrated)if(r={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){o=Mi(Error(R(423)),e),e=pf(t,e,i,n,o);break e}else if(i!==o){o=Mi(Error(R(424)),e),e=pf(t,e,i,n,o);break e}else for(Ze=ln(e.stateNode.containerInfo.firstChild),je=e,ae=!0,pt=null,n=ag(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Pi(),i===o){e=Bt(t,e,n);break e}Oe(t,e,i,n)}e=e.child}return e;case 5:return dg(e),t===null&&Ua(e),i=e.type,o=e.pendingProps,r=t!==null?t.memoizedProps:null,s=o.children,ka(i,o)?s=null:r!==null&&ka(i,r)&&(e.flags|=32),Ug(t,e),Oe(t,e,s,n),e.child;case 6:return t===null&&Ua(e),null;case 13:return Gg(t,e,n);case 4:return sc(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=xi(e,null,i,n):Oe(t,e,i,n),e.child;case 11:return i=e.type,o=e.pendingProps,o=e.elementType===i?o:ft(i,o),df(t,e,i,o,n);case 7:return Oe(t,e,e.pendingProps,n),e.child;case 8:return Oe(t,e,e.pendingProps.children,n),e.child;case 12:return Oe(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,o=e.pendingProps,r=e.memoizedProps,s=o.value,te(fs,i._currentValue),i._currentValue=s,r!==null)if(Et(r.value,s)){if(r.children===o.children&&!Je.current){e=Bt(t,e,n);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var a=r.dependencies;if(a!==null){s=r.child;for(var c=a.firstContext;c!==null;){if(c.context===i){if(r.tag===1){c=Ut(-1,n&-n),c.tag=2;var d=r.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}r.lanes|=n,c=r.alternate,c!==null&&(c.lanes|=n),Va(r.return,n,e),a.lanes|=n;break}c=c.next}}else if(r.tag===10)s=r.type===e.type?null:r.child;else if(r.tag===18){if(s=r.return,s===null)throw Error(R(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Va(s,n,e),s=r.sibling}else s=r.child;if(s!==null)s.return=r;else for(s=r;s!==null;){if(s===e){s=null;break}if(r=s.sibling,r!==null){r.return=s.return,s=r;break}s=s.return}r=s}Oe(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,i=e.pendingProps.children,yi(e,n),o=ut(o),i=i(o),e.flags|=1,Oe(t,e,i,n),e.child;case 14:return i=e.type,o=ft(i,e.pendingProps),o=ft(i.type,o),ff(t,e,i,o,n);case 15:return Lg(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,o=e.pendingProps,o=e.elementType===i?o:ft(i,o),$r(t,e),e.tag=1,Ye(i)?(t=!0,us(e)):t=!1,yi(e,n),kg(e,i,o),Oa(e,i,o,n),qa(null,e,i,!0,t,n);case 19:return Og(t,e,n);case 22:return Fg(t,e,n)}throw Error(R(156,e.tag))};function t_(t,e){return Rm(t,e)}function kC(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rt(t,e,n,i){return new kC(t,e,n,i)}function Cc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function MC(t){if(typeof t=="function")return Cc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Hu)return 11;if(t===Bu)return 14}return 2}function dn(t,e){var n=t.alternate;return n===null?(n=rt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Kr(t,e,n,i,o,r){var s=2;if(i=t,typeof t=="function")Cc(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case ei:return Fn(n.children,o,r,e);case Ou:s=8,o|=8;break;case ua:return t=rt(12,n,e,o|2),t.elementType=ua,t.lanes=r,t;case ca:return t=rt(13,n,e,o),t.elementType=ca,t.lanes=r,t;case da:return t=rt(19,n,e,o),t.elementType=da,t.lanes=r,t;case dm:return tl(n,o,r,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case um:s=10;break e;case cm:s=9;break e;case Hu:s=11;break e;case Bu:s=14;break e;case Xt:s=16,i=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=rt(s,n,e,o),e.elementType=t,e.type=i,e.lanes=r,e}function Fn(t,e,n,i){return t=rt(7,t,i,e),t.lanes=n,t}function tl(t,e,n,i){return t=rt(22,t,i,e),t.elementType=dm,t.lanes=n,t.stateNode={isHidden:!1},t}function $l(t,e,n){return t=rt(6,t,null,e),t.lanes=n,t}function Jl(t,e,n){return e=rt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function DC(t,e,n,i,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nl(0),this.expirationTimes=Nl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nl(0),this.identifierPrefix=i,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Tc(t,e,n,i,o,r,s,a,c){return t=new DC(t,e,n,a,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=rt(3,null,null,e),t.current=r,r.stateNode=t,r.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},rc(r),t}function LC(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:jn,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function n_(t){if(!t)return gn;t=t._reactInternals;e:{if($n(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ye(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var n=t.type;if(Ye(n))return ng(t,n,e)}return e}function i_(t,e,n,i,o,r,s,a,c){return t=Tc(n,i,!0,t,o,r,s,a,c),t.context=n_(null),n=t.current,i=He(),o=cn(n),r=Ut(i,o),r.callback=e??null,an(n,r,o),t.current.lanes=o,rr(t,o,i),Ke(t,i),t}function nl(t,e,n,i){var o=e.current,r=He(),s=cn(o);return n=n_(n),e.context===null?e.context=n:e.pendingContext=n,e=Ut(r,s),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=an(o,e,s),t!==null&&(yt(t,o,s,r),br(t,o,s)),s}function Ts(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function If(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Sc(t,e){If(t,e),(t=t.alternate)&&If(t,e)}function FC(){return null}var o_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ic(t){this._internalRoot=t}il.prototype.render=Ic.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));nl(t,e,null,null)};il.prototype.unmount=Ic.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Hn(function(){nl(null,t,null,null)}),e[Ot]=null}};function il(t){this._internalRoot=t}il.prototype.unstable_scheduleHydration=function(t){if(t){var e=Fm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<jt.length&&e!==0&&e<jt[n].priority;n++);jt.splice(n,0,t),n===0&&Vm(t)}};function wc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ol(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function wf(){}function UC(t,e,n,i,o){if(o){if(typeof i=="function"){var r=i;i=function(){var d=Ts(s);r.call(d)}}var s=i_(e,i,t,0,null,!1,!1,"",wf);return t._reactRootContainer=s,t[Ot]=s.current,Go(t.nodeType===8?t.parentNode:t),Hn(),s}for(;o=t.lastChild;)t.removeChild(o);if(typeof i=="function"){var a=i;i=function(){var d=Ts(c);a.call(d)}}var c=Tc(t,0,!1,null,null,!1,!1,"",wf);return t._reactRootContainer=c,t[Ot]=c.current,Go(t.nodeType===8?t.parentNode:t),Hn(function(){nl(e,c,n,i)}),c}function rl(t,e,n,i,o){var r=n._reactRootContainer;if(r){var s=r;if(typeof o=="function"){var a=o;o=function(){var c=Ts(s);a.call(c)}}nl(e,s,t,o)}else s=UC(n,e,t,o,i);return Ts(s)}Dm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ho(e.pendingLanes);n!==0&&(zu(e,n|1),Ke(e,ge()),!($&6)&&(Di=ge()+500,Cn()))}break;case 13:Hn(function(){var i=Ht(t,1);if(i!==null){var o=He();yt(i,t,1,o)}}),Sc(t,1)}};Wu=function(t){if(t.tag===13){var e=Ht(t,134217728);if(e!==null){var n=He();yt(e,t,134217728,n)}Sc(t,134217728)}};Lm=function(t){if(t.tag===13){var e=cn(t),n=Ht(t,e);if(n!==null){var i=He();yt(n,t,e,i)}Sc(t,e)}};Fm=function(){return Q};Um=function(t,e){var n=Q;try{return Q=t,e()}finally{Q=n}};Ca=function(t,e,n){switch(e){case"input":if(pa(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var o=Ks(i);if(!o)throw Error(R(90));hm(i),pa(i,o)}}}break;case"textarea":mm(t,n);break;case"select":e=n.value,e!=null&&pi(t,!!n.multiple,e,!1)}};Tm=yc;Sm=Hn;var VC={usingClientEntryPoint:!1,Events:[lr,oi,Ks,Em,Cm,yc]},oo={findFiberByHostInstance:Pn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GC={bundleType:oo.bundleType,version:oo.version,rendererPackageName:oo.rendererPackageName,rendererConfig:oo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$t.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Am(t),t===null?null:t.stateNode},findFiberByHostInstance:oo.findFiberByHostInstance||FC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dr.isDisabled&&Dr.supportsFiber)try{Ws=Dr.inject(GC),At=Dr}catch{}}tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VC;tt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wc(e))throw Error(R(200));return LC(t,e,null,n)};tt.createRoot=function(t,e){if(!wc(t))throw Error(R(299));var n=!1,i="",o=o_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=Tc(t,1,!1,null,null,n,!1,i,o),t[Ot]=e.current,Go(t.nodeType===8?t.parentNode:t),new Ic(e)};tt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=Am(e),t=t===null?null:t.stateNode,t};tt.flushSync=function(t){return Hn(t)};tt.hydrate=function(t,e,n){if(!ol(e))throw Error(R(200));return rl(null,t,e,!0,n)};tt.hydrateRoot=function(t,e,n){if(!wc(t))throw Error(R(405));var i=n!=null&&n.hydratedSources||null,o=!1,r="",s=o_;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=i_(e,null,t,1,n??null,o,!1,r,s),t[Ot]=e.current,Go(t),i)for(t=0;t<i.length;t++)n=i[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new il(e)};tt.render=function(t,e,n){if(!ol(e))throw Error(R(200));return rl(null,t,e,!1,n)};tt.unmountComponentAtNode=function(t){if(!ol(t))throw Error(R(40));return t._reactRootContainer?(Hn(function(){rl(null,null,t,!1,function(){t._reactRootContainer=null,t[Ot]=null})}),!0):!1};tt.unstable_batchedUpdates=yc;tt.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!ol(n))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return rl(t,e,n,!1,i)};tt.version="18.3.1-next-f1338f8080-20240426";function r_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r_)}catch(t){console.error(t)}}r_(),rm.exports=tt;var OC=rm.exports,Af=OC;la.createRoot=Af.createRoot,la.hydrateRoot=Af.hydrateRoot;const HC=({users:t,theme:e})=>{const n=re.useRef(null),i=re.useRef(0),o=(s,a,c,d,f,h)=>{s.beginPath();const p=f%4;if(p===0)s.arc(a,c,d,0,Math.PI*2);else if(p===1)s.moveTo(a,c-d),s.lineTo(a+d,c),s.lineTo(a,c+d),s.lineTo(a-d,c),s.closePath();else if(p===2)s.moveTo(a,c-d),s.lineTo(a+d,c+d),s.lineTo(a-d,c+d),s.closePath();else if(p===3){for(let m=0;m<6;m++){const v=Math.PI/3*m,E=a+Math.cos(v)*d,S=c+Math.sin(v)*d;m===0?s.moveTo(E,S):s.lineTo(E,S)}s.closePath()}h?s.fill():s.stroke()},r=s=>{const a=n.current;if(!a)return;const c=a.getContext("2d");if(!c)return;c.fillStyle="rgba(5, 5, 5, 0.25)",c.fillRect(0,0,a.width,a.height);const d=a.width/2,f=a.height/2,h=Math.min(a.width,a.height)*.45,p=Math.PI*2/t.length,m=Math.max(1,Math.floor(12/t.length)),v=p/m;t.forEach((E,S)=>{if(!E)return;const _=S*p,g=E.activeEffects||[],y=E.activeNotes||[],C=g.includes("vibrato"),I=g.includes("filter_close"),A=g.includes("distort"),N=g.includes("reverb_max");t.length>1&&(c.beginPath(),c.moveTo(d,f),c.lineTo(d+Math.cos(_)*h*1.2,f+Math.sin(_)*h*1.2),c.strokeStyle="rgba(255, 255, 255, 0.1)",c.lineWidth=1,c.stroke()),y.forEach(k=>{const w=h/15;let F=(k+1)*w;C&&(F+=Math.sin(s*.05)*8);const U=e.colors[k%e.colors.length];c.fillStyle=U,c.strokeStyle=U,c.shadowColor=U,c.shadowBlur=N?30:5,c.lineWidth=A?3:2,I?(c.globalAlpha=.3,c.shadowBlur=0):c.globalAlpha=1;for(let O=0;O<m;O++){const Y=_+O*v+v/2,ne=d+Math.cos(Y)*F,W=f+Math.sin(Y)*F;c.save(),c.translate(ne,W),c.rotate(Y+Math.PI/2);const Te=Math.max(4,15-k*.8);o(c,0,0,Te,k,!A),c.restore()}c.globalAlpha=1})}),c.beginPath(),c.arc(d,f,3,0,Math.PI*2),c.fillStyle="#fff",c.shadowBlur=10,c.shadowColor="#fff",c.fill(),c.shadowBlur=0,i.current=requestAnimationFrame(E=>r(E))};return re.useEffect(()=>{const s=n.current;if(!s)return;const a=()=>{s.width=window.innerWidth,s.height=window.innerHeight};return window.addEventListener("resize",a),a(),i.current=requestAnimationFrame(c=>r(c)),()=>{window.removeEventListener("resize",a),i.current&&cancelAnimationFrame(i.current)}},[t,e]),T.jsx("canvas",{ref:n,className:"absolute top-0 left-0 w-full h-full z-0"})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let BC,qC;function bC(){return{geminiUrl:BC,vertexUrl:qC}}function zC(t,e,n,i){var o,r;if(!(t!=null&&t.baseUrl)){const s=bC();return e?(o=s.vertexUrl)!==null&&o!==void 0?o:n:(r=s.geminiUrl)!==null&&r!==void 0?r:i}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Jt{}function M(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(i,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const r=e[o];return r!=null?String(r):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function u(t,e,n){for(let r=0;r<e.length-1;r++){const s=e[r];if(s.endsWith("[]")){const a=s.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(t[a])){const c=t[a];if(Array.isArray(n))for(let d=0;d<c.length;d++){const f=c[d];u(f,e.slice(r+1),n[d])}else for(const d of c)u(d,e.slice(r+1),n)}return}else if(s.endsWith("[0]")){const a=s.slice(0,-3);a in t||(t[a]=[{}]);const c=t[a];u(c[0],e.slice(r+1),n);return}(!t[s]||typeof t[s]!="object")&&(t[s]={}),t=t[s]}const i=e[e.length-1],o=t[i];if(o!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===o)return;if(typeof o=="object"&&typeof n=="object"&&o!==null&&n!==null)Object.assign(o,n);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[i]=n}function l(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let i=0;i<e.length;i++){if(typeof t!="object"||t===null)return n;const o=e[i];if(o.endsWith("[]")){const r=o.slice(0,-2);if(r in t){const s=t[r];return Array.isArray(s)?s.map(a=>l(a,e.slice(i+1),n)):n}else return n}else t=t[o]}return t}catch(i){if(i instanceof TypeError)return n;throw i}}function WC(t,e){for(const[n,i]of Object.entries(e)){const o=n.split("."),r=i.split("."),s=new Set;let a=-1;for(let c=0;c<o.length;c++)if(o[c]==="*"){a=c;break}if(a!==-1&&r.length>a)for(let c=a;c<r.length;c++){const d=r[c];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&s.add(d)}eu(t,o,r,0,s)}}function eu(t,e,n,i,o){if(i>=e.length||typeof t!="object"||t===null)return;const r=e[i];if(r.endsWith("[]")){const s=r.slice(0,-2),a=t;if(s in a&&Array.isArray(a[s]))for(const c of a[s])eu(c,e,n,i+1,o)}else if(r==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const s=t,a=Object.keys(s).filter(d=>!d.startsWith("_")&&!o.has(d)),c={};for(const d of a)c[d]=s[d];for(const[d,f]of Object.entries(c)){const h=[];for(const p of n.slice(i))p==="*"?h.push(d):h.push(p);u(s,h,f)}for(const d of a)delete s[d]}}else{const s=t;r in s&&eu(s[r],e,n,i+1,o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ac(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $C(t){const e={},n=l(t,["operationName"]);n!=null&&u(e,["operationName"],n);const i=l(t,["resourceName"]);return i!=null&&u(e,["_url","resourceName"],i),e}function JC(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["metadata"]);i!=null&&u(e,["metadata"],i);const o=l(t,["done"]);o!=null&&u(e,["done"],o);const r=l(t,["error"]);r!=null&&u(e,["error"],r);const s=l(t,["response","generateVideoResponse"]);return s!=null&&u(e,["response"],KC(s)),e}function YC(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["metadata"]);i!=null&&u(e,["metadata"],i);const o=l(t,["done"]);o!=null&&u(e,["done"],o);const r=l(t,["error"]);r!=null&&u(e,["error"],r);const s=l(t,["response"]);return s!=null&&u(e,["response"],QC(s)),e}function KC(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>XC(s))),u(e,["generatedVideos"],r)}const i=l(t,["raiMediaFilteredCount"]);i!=null&&u(e,["raiMediaFilteredCount"],i);const o=l(t,["raiMediaFilteredReasons"]);return o!=null&&u(e,["raiMediaFilteredReasons"],o),e}function QC(t){const e={},n=l(t,["videos"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>ZC(s))),u(e,["generatedVideos"],r)}const i=l(t,["raiMediaFilteredCount"]);i!=null&&u(e,["raiMediaFilteredCount"],i);const o=l(t,["raiMediaFilteredReasons"]);return o!=null&&u(e,["raiMediaFilteredReasons"],o),e}function XC(t){const e={},n=l(t,["video"]);return n!=null&&u(e,["video"],oT(n)),e}function ZC(t){const e={},n=l(t,["_self"]);return n!=null&&u(e,["video"],rT(n)),e}function jC(t){const e={},n=l(t,["operationName"]);return n!=null&&u(e,["_url","operationName"],n),e}function eT(t){const e={},n=l(t,["operationName"]);return n!=null&&u(e,["_url","operationName"],n),e}function tT(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["metadata"]);i!=null&&u(e,["metadata"],i);const o=l(t,["done"]);o!=null&&u(e,["done"],o);const r=l(t,["error"]);r!=null&&u(e,["error"],r);const s=l(t,["response"]);return s!=null&&u(e,["response"],nT(s)),e}function nT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["parent"]);i!=null&&u(e,["parent"],i);const o=l(t,["documentName"]);return o!=null&&u(e,["documentName"],o),e}function s_(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["metadata"]);i!=null&&u(e,["metadata"],i);const o=l(t,["done"]);o!=null&&u(e,["done"],o);const r=l(t,["error"]);r!=null&&u(e,["error"],r);const s=l(t,["response"]);return s!=null&&u(e,["response"],iT(s)),e}function iT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["parent"]);i!=null&&u(e,["parent"],i);const o=l(t,["documentName"]);return o!=null&&u(e,["documentName"],o),e}function oT(t){const e={},n=l(t,["uri"]);n!=null&&u(e,["uri"],n);const i=l(t,["encodedVideo"]);i!=null&&u(e,["videoBytes"],Ac(i));const o=l(t,["encoding"]);return o!=null&&u(e,["mimeType"],o),e}function rT(t){const e={},n=l(t,["gcsUri"]);n!=null&&u(e,["uri"],n);const i=l(t,["bytesBase64Encoded"]);i!=null&&u(e,["videoBytes"],Ac(i));const o=l(t,["mimeType"]);return o!=null&&u(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Nf;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Nf||(Nf={}));var Rf;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Rf||(Rf={}));var Pf;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Pf||(Pf={}));var j;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(j||(j={}));var xf;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(xf||(xf={}));var kf;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(kf||(kf={}));var Mf;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Mf||(Mf={}));var Df;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Df||(Df={}));var Lf;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Lf||(Lf={}));var Ff;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.HIGH="HIGH"})(Ff||(Ff={}));var Uf;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Uf||(Uf={}));var Vf;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Vf||(Vf={}));var Gf;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Gf||(Gf={}));var Of;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(Of||(Of={}));var Hf;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Hf||(Hf={}));var Bf;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Bf||(Bf={}));var qf;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(qf||(qf={}));var bf;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(bf||(bf={}));var zf;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(zf||(zf={}));var Ss;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Ss||(Ss={}));var Wf;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Wf||(Wf={}));var $f;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})($f||($f={}));var Jf;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Jf||(Jf={}));var tu;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(tu||(tu={}));var Yf;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Yf||(Yf={}));var Kf;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Kf||(Kf={}));var Qf;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Qf||(Qf={}));var Xf;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Xf||(Xf={}));var Zf;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Zf||(Zf={}));var jf;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(jf||(jf={}));var eh;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(eh||(eh={}));var th;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(th||(th={}));var nh;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(nh||(nh={}));var ih;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(ih||(ih={}));var oh;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(oh||(oh={}));var rh;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(rh||(rh={}));var sh;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(sh||(sh={}));var lh;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(lh||(lh={}));var ah;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(ah||(ah={}));var uh;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(uh||(uh={}));var ch;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(ch||(ch={}));var dh;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(dh||(dh={}));var fh;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(fh||(fh={}));var hh;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(hh||(hh={}));var ph;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(ph||(ph={}));var mh;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(mh||(mh={}));var gh;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(gh||(gh={}));var _h;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(_h||(_h={}));var yh;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(yh||(yh={}));var vh;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(vh||(vh={}));var Eh;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Eh||(Eh={}));var Ch;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Ch||(Ch={}));var Th;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Th||(Th={}));var Sh;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Sh||(Sh={}));var di;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(di||(di={}));class nu{constructor(e){const n={};for(const i of e.headers.entries())n[i[0]]=i[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class ro{get text(){var e,n,i,o,r,s,a,c;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",f=!1;const h=[];for(const p of(c=(a=(s=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[m,v]of Object.entries(p))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(v!==null||v!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;f=!0,d+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?d:void 0}get data(){var e,n,i,o,r,s,a,c;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const f=[];for(const h of(c=(a=(s=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&f.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(d+=atob(h.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,n,i,o,r,s,a,c;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(a=(s=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,n,i,o,r,s,a,c,d;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(c=(a=(s=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,n,i,o,r,s,a,c,d;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(c=(a=(s=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.output}}class Ih{}class wh{}class sT{}class lT{}class aT{}class uT{}class Ah{}class Nh{}class Rh{}class cT{}class Is{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const i=new Is;let o;const r=e;return n?o=YC(r):o=JC(r),Object.assign(i,o),i}}class Ph{}class xh{}class kh{}class Mh{}class dT{}class fT{}class hT{}class Nc{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const i=new Nc,r=tT(e);return Object.assign(i,r),i}}class pT{}class mT{}class gT{}class Dh{}class _T{get text(){var e,n,i;let o="",r=!1;const s=[];for(const a of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[c,d]of Object.entries(a))c!=="text"&&c!=="thought"&&d!==null&&s.push(c);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;r=!0,o+=a.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?o:void 0}get data(){var e,n,i;let o="";const r=[];for(const s of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[a,c]of Object.entries(s))a!=="inlineData"&&c!==null&&r.push(a);s.inlineData&&typeof s.inlineData.data=="string"&&(o+=atob(s.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class yT{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Rc{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const i=new Rc,r=s_(e);return Object.assign(i,r),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function J(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function l_(t,e){const n=J(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function a_(t){return Array.isArray(t)?t.map(e=>ws(e)):[ws(t)]}function ws(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function u_(t){const e=ws(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function c_(t){const e=ws(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Lh(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function d_(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Lh(e)):[Lh(t)]}function iu(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Fh(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Uh(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Ue(t){if(t==null)throw new Error("ContentUnion is required");return iu(t)?t:{role:"user",parts:d_(t)}}function Pc(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const i=Ue(n);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(t.isVertexAI()){const n=Ue(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Ue(n)):[Ue(e)]}function at(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Fh(t)||Uh(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ue(t)]}const e=[],n=[],i=iu(t[0]);for(const o of t){const r=iu(o);if(r!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(o);else{if(Fh(o)||Uh(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(o)}}return i||e.push({role:"user",parts:d_(n)}),e}function vT(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(i=>i!=="null");if(n.length===1)e.type=Object.values(j).includes(n[0].toUpperCase())?n[0].toUpperCase():j.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of n)e.anyOf.push({type:Object.values(j).includes(i.toUpperCase())?i.toUpperCase():j.TYPE_UNSPECIFIED})}}function Ei(t){const e={},n=["items"],i=["anyOf"],o=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=t.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,t=r[1]):r[1].type==="null"&&(e.nullable=!0,t=r[0])),t.type instanceof Array&&vT(t.type,e);for(const[s,a]of Object.entries(t))if(a!=null)if(s=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(j).includes(a.toUpperCase())?a.toUpperCase():j.TYPE_UNSPECIFIED}else if(n.includes(s))e[s]=Ei(a);else if(i.includes(s)){const c=[];for(const d of a){if(d.type=="null"){e.nullable=!0;continue}c.push(Ei(d))}e[s]=c}else if(o.includes(s)){const c={};for(const[d,f]of Object.entries(a))c[d]=Ei(f);e[s]=c}else{if(s==="additionalProperties")continue;e[s]=a}return e}function xc(t){return Ei(t)}function kc(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Mc(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function zi(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ei(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ei(e.response));return t}function Wi(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function ET(t,e,n,i=1){const o=!e.startsWith(`${n}/`)&&e.split("/").length===i;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:o?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:o?`${n}/${e}`:e}function Yt(t,e){if(typeof e!="string")throw new Error("name must be a string");return ET(t,e,"cachedContents")}function f_(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Tn(t){return Ac(t)}function CT(t){return t!=null&&typeof t=="object"&&"name"in t}function TT(t){return t!=null&&typeof t=="object"&&"video"in t}function ST(t){return t!=null&&typeof t=="object"&&"uri"in t}function h_(t){var e;let n;if(CT(t)&&(n=t.name),!(ST(t)&&(n=t.uri,n===void 0))&&!(TT(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const o=n.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${n}`);n=o[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function p_(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function m_(t){for(const e of["models","tunedModels","publisherModels"])if(IT(t,e))return t[e];return[]}function IT(t,e){return t!==null&&typeof t=="object"&&e in t}function wT(t,e={}){const n=t,i={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(i.responseJsonSchema=n.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function AT(t,e={}){const n=[],i=new Set;for(const o of t){const r=o.name;if(i.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);i.add(r);const s=wT(o,e);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}function g_(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,o=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(o>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function NT(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function __(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const o=n.inlinedResponses;if(!Array.isArray(o)||o.length===0)return t;let r=!1;for(const s of o){if(typeof s!="object"||s===null)continue;const c=s.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){r=!0;break}}return r&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function $i(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function y_(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RT(t){const e={},n=l(t,["responsesFile"]);n!=null&&u(e,["fileName"],n);const i=l(t,["inlinedResponses","inlinedResponses"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>aS(s))),u(e,["inlinedResponses"],r)}const o=l(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(s=>s)),u(e,["inlinedEmbedContentResponses"],r)}return e}function PT(t){const e={},n=l(t,["predictionsFormat"]);n!=null&&u(e,["format"],n);const i=l(t,["gcsDestination","outputUriPrefix"]);i!=null&&u(e,["gcsUri"],i);const o=l(t,["bigqueryDestination","outputUri"]);return o!=null&&u(e,["bigqueryUri"],o),e}function xT(t){const e={},n=l(t,["format"]);n!=null&&u(e,["predictionsFormat"],n);const i=l(t,["gcsUri"]);i!=null&&u(e,["gcsDestination","outputUriPrefix"],i);const o=l(t,["bigqueryUri"]);if(o!=null&&u(e,["bigqueryDestination","outputUri"],o),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(l(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Qr(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["metadata","displayName"]);i!=null&&u(e,["displayName"],i);const o=l(t,["metadata","state"]);o!=null&&u(e,["state"],y_(o));const r=l(t,["metadata","createTime"]);r!=null&&u(e,["createTime"],r);const s=l(t,["metadata","endTime"]);s!=null&&u(e,["endTime"],s);const a=l(t,["metadata","updateTime"]);a!=null&&u(e,["updateTime"],a);const c=l(t,["metadata","model"]);c!=null&&u(e,["model"],c);const d=l(t,["metadata","output"]);return d!=null&&u(e,["dest"],RT(__(d))),e}function ou(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["displayName"]);i!=null&&u(e,["displayName"],i);const o=l(t,["state"]);o!=null&&u(e,["state"],y_(o));const r=l(t,["error"]);r!=null&&u(e,["error"],r);const s=l(t,["createTime"]);s!=null&&u(e,["createTime"],s);const a=l(t,["startTime"]);a!=null&&u(e,["startTime"],a);const c=l(t,["endTime"]);c!=null&&u(e,["endTime"],c);const d=l(t,["updateTime"]);d!=null&&u(e,["updateTime"],d);const f=l(t,["model"]);f!=null&&u(e,["model"],f);const h=l(t,["inputConfig"]);h!=null&&u(e,["src"],kT(h));const p=l(t,["outputConfig"]);p!=null&&u(e,["dest"],PT(__(p)));const m=l(t,["completionStats"]);return m!=null&&u(e,["completionStats"],m),e}function kT(t){const e={},n=l(t,["instancesFormat"]);n!=null&&u(e,["format"],n);const i=l(t,["gcsSource","uris"]);i!=null&&u(e,["gcsUri"],i);const o=l(t,["bigquerySource","inputUri"]);return o!=null&&u(e,["bigqueryUri"],o),e}function MT(t,e){const n={};if(l(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=l(e,["fileName"]);i!=null&&u(n,["fileName"],i);const o=l(e,["inlinedRequests"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(s=>lS(t,s))),u(n,["requests","requests"],r)}return n}function DT(t){const e={},n=l(t,["format"]);n!=null&&u(e,["instancesFormat"],n);const i=l(t,["gcsUri"]);i!=null&&u(e,["gcsSource","uris"],i);const o=l(t,["bigqueryUri"]);if(o!=null&&u(e,["bigquerySource","inputUri"],o),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function LT(t){const e={},n=l(t,["data"]);if(n!=null&&u(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function FT(t,e){const n={},i=l(e,["name"]);return i!=null&&u(n,["_url","name"],$i(t,i)),n}function UT(t,e){const n={},i=l(e,["name"]);return i!=null&&u(n,["_url","name"],$i(t,i)),n}function VT(t){const e={},n=l(t,["content"]);n!=null&&u(e,["content"],n);const i=l(t,["citationMetadata"]);i!=null&&u(e,["citationMetadata"],GT(i));const o=l(t,["tokenCount"]);o!=null&&u(e,["tokenCount"],o);const r=l(t,["finishReason"]);r!=null&&u(e,["finishReason"],r);const s=l(t,["avgLogprobs"]);s!=null&&u(e,["avgLogprobs"],s);const a=l(t,["groundingMetadata"]);a!=null&&u(e,["groundingMetadata"],a);const c=l(t,["index"]);c!=null&&u(e,["index"],c);const d=l(t,["logprobsResult"]);d!=null&&u(e,["logprobsResult"],d);const f=l(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),u(e,["safetyRatings"],p)}const h=l(t,["urlContextMetadata"]);return h!=null&&u(e,["urlContextMetadata"],h),e}function GT(t){const e={},n=l(t,["citationSources"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>o)),u(e,["citations"],i)}return e}function v_(t){const e={},n=l(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>mS(r))),u(e,["parts"],o)}const i=l(t,["role"]);return i!=null&&u(e,["role"],i),e}function OT(t,e){const n={},i=l(t,["displayName"]);if(e!==void 0&&i!=null&&u(e,["batch","displayName"],i),l(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function HT(t,e){const n={},i=l(t,["displayName"]);e!==void 0&&i!=null&&u(e,["displayName"],i);const o=l(t,["dest"]);return e!==void 0&&o!=null&&u(e,["outputConfig"],xT(NT(o))),n}function Vh(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["src"]);o!=null&&u(n,["batch","inputConfig"],MT(t,g_(t,o)));const r=l(e,["config"]);return r!=null&&OT(r,n),n}function BT(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["model"],J(t,i));const o=l(e,["src"]);o!=null&&u(n,["inputConfig"],DT(g_(t,o)));const r=l(e,["config"]);return r!=null&&HT(r,n),n}function qT(t,e){const n={},i=l(t,["displayName"]);return e!==void 0&&i!=null&&u(e,["batch","displayName"],i),n}function bT(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["src"]);o!=null&&u(n,["batch","inputConfig"],QT(t,o));const r=l(e,["config"]);return r!=null&&qT(r,n),n}function zT(t,e){const n={},i=l(e,["name"]);return i!=null&&u(n,["_url","name"],$i(t,i)),n}function WT(t,e){const n={},i=l(e,["name"]);return i!=null&&u(n,["_url","name"],$i(t,i)),n}function $T(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["name"]);i!=null&&u(e,["name"],i);const o=l(t,["done"]);o!=null&&u(e,["done"],o);const r=l(t,["error"]);return r!=null&&u(e,["error"],r),e}function JT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["name"]);i!=null&&u(e,["name"],i);const o=l(t,["done"]);o!=null&&u(e,["done"],o);const r=l(t,["error"]);return r!=null&&u(e,["error"],r),e}function YT(t,e){const n={},i=l(e,["contents"]);if(i!=null){let r=Pc(t,i);Array.isArray(r)&&(r=r.map(s=>s)),u(n,["requests[]","request","content"],r)}const o=l(e,["config"]);return o!=null&&(u(n,["_self"],KT(o,n)),WC(n,{"requests[].*":"requests[].request.*"})),n}function KT(t,e){const n={},i=l(t,["taskType"]);e!==void 0&&i!=null&&u(e,["requests[]","taskType"],i);const o=l(t,["title"]);e!==void 0&&o!=null&&u(e,["requests[]","title"],o);const r=l(t,["outputDimensionality"]);if(e!==void 0&&r!=null&&u(e,["requests[]","outputDimensionality"],r),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function QT(t,e){const n={},i=l(e,["fileName"]);i!=null&&u(n,["file_name"],i);const o=l(e,["inlinedRequests"]);return o!=null&&u(n,["requests"],YT(t,o)),n}function XT(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&u(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function ZT(t){const e={},n=l(t,["id"]);n!=null&&u(e,["id"],n);const i=l(t,["args"]);i!=null&&u(e,["args"],i);const o=l(t,["name"]);if(o!=null&&u(e,["name"],o),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function jT(t){const e={},n=l(t,["mode"]);n!=null&&u(e,["mode"],n);const i=l(t,["allowedFunctionNames"]);if(i!=null&&u(e,["allowedFunctionNames"],i),l(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function eS(t,e,n){const i={},o=l(e,["systemInstruction"]);n!==void 0&&o!=null&&u(n,["systemInstruction"],v_(Ue(o)));const r=l(e,["temperature"]);r!=null&&u(i,["temperature"],r);const s=l(e,["topP"]);s!=null&&u(i,["topP"],s);const a=l(e,["topK"]);a!=null&&u(i,["topK"],a);const c=l(e,["candidateCount"]);c!=null&&u(i,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&u(i,["maxOutputTokens"],d);const f=l(e,["stopSequences"]);f!=null&&u(i,["stopSequences"],f);const h=l(e,["responseLogprobs"]);h!=null&&u(i,["responseLogprobs"],h);const p=l(e,["logprobs"]);p!=null&&u(i,["logprobs"],p);const m=l(e,["presencePenalty"]);m!=null&&u(i,["presencePenalty"],m);const v=l(e,["frequencyPenalty"]);v!=null&&u(i,["frequencyPenalty"],v);const E=l(e,["seed"]);E!=null&&u(i,["seed"],E);const S=l(e,["responseMimeType"]);S!=null&&u(i,["responseMimeType"],S);const _=l(e,["responseSchema"]);_!=null&&u(i,["responseSchema"],xc(_));const g=l(e,["responseJsonSchema"]);if(g!=null&&u(i,["responseJsonSchema"],g),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=l(e,["safetySettings"]);if(n!==void 0&&y!=null){let U=y;Array.isArray(U)&&(U=U.map(O=>gS(O))),u(n,["safetySettings"],U)}const C=l(e,["tools"]);if(n!==void 0&&C!=null){let U=Wi(C);Array.isArray(U)&&(U=U.map(O=>yS(zi(O)))),u(n,["tools"],U)}const I=l(e,["toolConfig"]);if(n!==void 0&&I!=null&&u(n,["toolConfig"],_S(I)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=l(e,["cachedContent"]);n!==void 0&&A!=null&&u(n,["cachedContent"],Yt(t,A));const N=l(e,["responseModalities"]);N!=null&&u(i,["responseModalities"],N);const k=l(e,["mediaResolution"]);k!=null&&u(i,["mediaResolution"],k);const w=l(e,["speechConfig"]);if(w!=null&&u(i,["speechConfig"],kc(w)),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=l(e,["thinkingConfig"]);P!=null&&u(i,["thinkingConfig"],P);const F=l(e,["imageConfig"]);return F!=null&&u(i,["imageConfig"],sS(F)),i}function tS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>VT(d))),u(e,["candidates"],c)}const o=l(t,["modelVersion"]);o!=null&&u(e,["modelVersion"],o);const r=l(t,["promptFeedback"]);r!=null&&u(e,["promptFeedback"],r);const s=l(t,["responseId"]);s!=null&&u(e,["responseId"],s);const a=l(t,["usageMetadata"]);return a!=null&&u(e,["usageMetadata"],a),e}function nS(t,e){const n={},i=l(e,["name"]);return i!=null&&u(n,["_url","name"],$i(t,i)),n}function iS(t,e){const n={},i=l(e,["name"]);return i!=null&&u(n,["_url","name"],$i(t,i)),n}function oS(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&u(e,["enableWidget"],n),e}function rS(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&u(e,["timeRangeFilter"],n),e}function sS(t){const e={},n=l(t,["aspectRatio"]);n!=null&&u(e,["aspectRatio"],n);const i=l(t,["imageSize"]);if(i!=null&&u(e,["imageSize"],i),l(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(l(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function lS(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["request","model"],J(t,i));const o=l(e,["contents"]);if(o!=null){let a=at(o);Array.isArray(a)&&(a=a.map(c=>v_(c))),u(n,["request","contents"],a)}const r=l(e,["metadata"]);r!=null&&u(n,["metadata"],r);const s=l(e,["config"]);return s!=null&&u(n,["request","generationConfig"],eS(t,s,l(n,["request"],{}))),n}function aS(t){const e={},n=l(t,["response"]);n!=null&&u(e,["response"],tS(n));const i=l(t,["error"]);return i!=null&&u(e,["error"],i),e}function uS(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&u(e,["_query","pageSize"],i);const o=l(t,["pageToken"]);if(e!==void 0&&o!=null&&u(e,["_query","pageToken"],o),l(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function cS(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&u(e,["_query","pageSize"],i);const o=l(t,["pageToken"]);e!==void 0&&o!=null&&u(e,["_query","pageToken"],o);const r=l(t,["filter"]);return e!==void 0&&r!=null&&u(e,["_query","filter"],r),n}function dS(t){const e={},n=l(t,["config"]);return n!=null&&uS(n,e),e}function fS(t){const e={},n=l(t,["config"]);return n!=null&&cS(n,e),e}function hS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&u(e,["nextPageToken"],i);const o=l(t,["operations"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(s=>Qr(s))),u(e,["batchJobs"],r)}return e}function pS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&u(e,["nextPageToken"],i);const o=l(t,["batchPredictionJobs"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(s=>ou(s))),u(e,["batchJobs"],r)}return e}function mS(t){const e={},n=l(t,["mediaResolution"]);n!=null&&u(e,["mediaResolution"],n);const i=l(t,["codeExecutionResult"]);i!=null&&u(e,["codeExecutionResult"],i);const o=l(t,["executableCode"]);o!=null&&u(e,["executableCode"],o);const r=l(t,["fileData"]);r!=null&&u(e,["fileData"],XT(r));const s=l(t,["functionCall"]);s!=null&&u(e,["functionCall"],ZT(s));const a=l(t,["functionResponse"]);a!=null&&u(e,["functionResponse"],a);const c=l(t,["inlineData"]);c!=null&&u(e,["inlineData"],LT(c));const d=l(t,["text"]);d!=null&&u(e,["text"],d);const f=l(t,["thought"]);f!=null&&u(e,["thought"],f);const h=l(t,["thoughtSignature"]);h!=null&&u(e,["thoughtSignature"],h);const p=l(t,["videoMetadata"]);return p!=null&&u(e,["videoMetadata"],p),e}function gS(t){const e={},n=l(t,["category"]);if(n!=null&&u(e,["category"],n),l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=l(t,["threshold"]);return i!=null&&u(e,["threshold"],i),e}function _S(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&u(e,["functionCallingConfig"],jT(n));const i=l(t,["retrievalConfig"]);return i!=null&&u(e,["retrievalConfig"],i),e}function yS(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>h)),u(e,["functionDeclarations"],f)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(t,["googleSearchRetrieval"]);i!=null&&u(e,["googleSearchRetrieval"],i);const o=l(t,["computerUse"]);o!=null&&u(e,["computerUse"],o);const r=l(t,["fileSearch"]);r!=null&&u(e,["fileSearch"],r);const s=l(t,["codeExecution"]);if(s!=null&&u(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=l(t,["googleMaps"]);a!=null&&u(e,["googleMaps"],oS(a));const c=l(t,["googleSearch"]);c!=null&&u(e,["googleSearch"],rS(c));const d=l(t,["urlContext"]);return d!=null&&u(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var qt;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(qt||(qt={}));class Jn{constructor(e,n,i,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,i,o)}init(e,n,i){var o,r;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!i||Object.keys(i).length===0?s={config:{}}:typeof i=="object"?s=Object.assign({},i):s=i,s.config&&(s.config.pageToken=n.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(r=(o=s.config)===null||o===void 0?void 0:o.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vS extends Jt{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Jn(qt.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=Vh(this.apiClient,e),i=n._url,o=M("{model}:batchGenerateContent",i),a=n.batch.inputConfig.requests,c=a.requests,d=[];for(const f of c){const h=Object.assign({},f);if(h.systemInstruction){const p=h.systemInstruction;delete h.systemInstruction;const m=h.request;m.systemInstruction=p,h.request=m}d.push(h)}return a.requests=d,delete n.config,delete n._url,delete n._query,{path:o,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const i=n?Object.assign({},n):{},o=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${o}`),i.dest===void 0){const r=this.getGcsUri(e),s=this.getBigqueryUri(e);if(r)r.endsWith(".jsonl")?i.dest=`${r.slice(0,-6)}/dest`:i.dest=`${r}_dest_${o}`;else if(s)i.dest=`${s}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=BT(this.apiClient,e);return a=M("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>ou(f))}else{const d=Vh(this.apiClient,e);return a=M("{model}:batchGenerateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>Qr(f))}}async createEmbeddingsInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=bT(this.apiClient,e);return r=M("{model}:asyncBatchEmbedContent",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>Qr(c))}}async get(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=iS(this.apiClient,e);return a=M("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>ou(f))}else{const d=nS(this.apiClient,e);return a=M("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>Qr(f))}}async cancel(e){var n,i,o,r;let s="",a={};if(this.apiClient.isVertexAI()){const c=UT(this.apiClient,e);s=M("batchPredictionJobs/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const c=FT(this.apiClient,e);s=M("batches/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=fS(e);return a=M("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=pS(f),p=new Dh;return Object.assign(p,h),p})}else{const d=dS(e);return a=M("batches",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=hS(f),p=new Dh;return Object.assign(p,h),p})}}async delete(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=WT(this.apiClient,e);return a=M("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>JT(f))}else{const d=zT(this.apiClient,e);return a=M("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>$T(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ES(t){const e={},n=l(t,["data"]);if(n!=null&&u(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function Gh(t){const e={},n=l(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>bS(r))),u(e,["parts"],o)}const i=l(t,["role"]);return i!=null&&u(e,["role"],i),e}function CS(t,e){const n={},i=l(t,["ttl"]);e!==void 0&&i!=null&&u(e,["ttl"],i);const o=l(t,["expireTime"]);e!==void 0&&o!=null&&u(e,["expireTime"],o);const r=l(t,["displayName"]);e!==void 0&&r!=null&&u(e,["displayName"],r);const s=l(t,["contents"]);if(e!==void 0&&s!=null){let f=at(s);Array.isArray(f)&&(f=f.map(h=>Gh(h))),u(e,["contents"],f)}const a=l(t,["systemInstruction"]);e!==void 0&&a!=null&&u(e,["systemInstruction"],Gh(Ue(a)));const c=l(t,["tools"]);if(e!==void 0&&c!=null){let f=c;Array.isArray(f)&&(f=f.map(h=>WS(h))),u(e,["tools"],f)}const d=l(t,["toolConfig"]);if(e!==void 0&&d!=null&&u(e,["toolConfig"],zS(d)),l(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function TS(t,e){const n={},i=l(t,["ttl"]);e!==void 0&&i!=null&&u(e,["ttl"],i);const o=l(t,["expireTime"]);e!==void 0&&o!=null&&u(e,["expireTime"],o);const r=l(t,["displayName"]);e!==void 0&&r!=null&&u(e,["displayName"],r);const s=l(t,["contents"]);if(e!==void 0&&s!=null){let h=at(s);Array.isArray(h)&&(h=h.map(p=>p)),u(e,["contents"],h)}const a=l(t,["systemInstruction"]);e!==void 0&&a!=null&&u(e,["systemInstruction"],Ue(a));const c=l(t,["tools"]);if(e!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(p=>$S(p))),u(e,["tools"],h)}const d=l(t,["toolConfig"]);e!==void 0&&d!=null&&u(e,["toolConfig"],d);const f=l(t,["kmsKeyName"]);return e!==void 0&&f!=null&&u(e,["encryption_spec","kmsKeyName"],f),n}function SS(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["model"],l_(t,i));const o=l(e,["config"]);return o!=null&&CS(o,n),n}function IS(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["model"],l_(t,i));const o=l(e,["config"]);return o!=null&&TS(o,n),n}function wS(t,e){const n={},i=l(e,["name"]);return i!=null&&u(n,["_url","name"],Yt(t,i)),n}function AS(t,e){const n={},i=l(e,["name"]);return i!=null&&u(n,["_url","name"],Yt(t,i)),n}function NS(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function RS(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function PS(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&u(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function xS(t){const e={},n=l(t,["id"]);n!=null&&u(e,["id"],n);const i=l(t,["args"]);i!=null&&u(e,["args"],i);const o=l(t,["name"]);if(o!=null&&u(e,["name"],o),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function kS(t){const e={},n=l(t,["mode"]);n!=null&&u(e,["mode"],n);const i=l(t,["allowedFunctionNames"]);if(i!=null&&u(e,["allowedFunctionNames"],i),l(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function MS(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&u(e,["description"],n);const i=l(t,["name"]);i!=null&&u(e,["name"],i);const o=l(t,["parameters"]);o!=null&&u(e,["parameters"],o);const r=l(t,["parametersJsonSchema"]);r!=null&&u(e,["parametersJsonSchema"],r);const s=l(t,["response"]);s!=null&&u(e,["response"],s);const a=l(t,["responseJsonSchema"]);return a!=null&&u(e,["responseJsonSchema"],a),e}function DS(t,e){const n={},i=l(e,["name"]);return i!=null&&u(n,["_url","name"],Yt(t,i)),n}function LS(t,e){const n={},i=l(e,["name"]);return i!=null&&u(n,["_url","name"],Yt(t,i)),n}function FS(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&u(e,["enableWidget"],n),e}function US(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&u(e,["timeRangeFilter"],n),e}function VS(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&u(e,["_query","pageSize"],i);const o=l(t,["pageToken"]);return e!==void 0&&o!=null&&u(e,["_query","pageToken"],o),n}function GS(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&u(e,["_query","pageSize"],i);const o=l(t,["pageToken"]);return e!==void 0&&o!=null&&u(e,["_query","pageToken"],o),n}function OS(t){const e={},n=l(t,["config"]);return n!=null&&VS(n,e),e}function HS(t){const e={},n=l(t,["config"]);return n!=null&&GS(n,e),e}function BS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&u(e,["nextPageToken"],i);const o=l(t,["cachedContents"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(s=>s)),u(e,["cachedContents"],r)}return e}function qS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&u(e,["nextPageToken"],i);const o=l(t,["cachedContents"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(s=>s)),u(e,["cachedContents"],r)}return e}function bS(t){const e={},n=l(t,["mediaResolution"]);n!=null&&u(e,["mediaResolution"],n);const i=l(t,["codeExecutionResult"]);i!=null&&u(e,["codeExecutionResult"],i);const o=l(t,["executableCode"]);o!=null&&u(e,["executableCode"],o);const r=l(t,["fileData"]);r!=null&&u(e,["fileData"],PS(r));const s=l(t,["functionCall"]);s!=null&&u(e,["functionCall"],xS(s));const a=l(t,["functionResponse"]);a!=null&&u(e,["functionResponse"],a);const c=l(t,["inlineData"]);c!=null&&u(e,["inlineData"],ES(c));const d=l(t,["text"]);d!=null&&u(e,["text"],d);const f=l(t,["thought"]);f!=null&&u(e,["thought"],f);const h=l(t,["thoughtSignature"]);h!=null&&u(e,["thoughtSignature"],h);const p=l(t,["videoMetadata"]);return p!=null&&u(e,["videoMetadata"],p),e}function zS(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&u(e,["functionCallingConfig"],kS(n));const i=l(t,["retrievalConfig"]);return i!=null&&u(e,["retrievalConfig"],i),e}function WS(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>h)),u(e,["functionDeclarations"],f)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(t,["googleSearchRetrieval"]);i!=null&&u(e,["googleSearchRetrieval"],i);const o=l(t,["computerUse"]);o!=null&&u(e,["computerUse"],o);const r=l(t,["fileSearch"]);r!=null&&u(e,["fileSearch"],r);const s=l(t,["codeExecution"]);if(s!=null&&u(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=l(t,["googleMaps"]);a!=null&&u(e,["googleMaps"],FS(a));const c=l(t,["googleSearch"]);c!=null&&u(e,["googleSearch"],US(c));const d=l(t,["urlContext"]);return d!=null&&u(e,["urlContext"],d),e}function $S(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>MS(p))),u(e,["functionDeclarations"],h)}const i=l(t,["retrieval"]);i!=null&&u(e,["retrieval"],i);const o=l(t,["googleSearchRetrieval"]);o!=null&&u(e,["googleSearchRetrieval"],o);const r=l(t,["computerUse"]);if(r!=null&&u(e,["computerUse"],r),l(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=l(t,["codeExecution"]);s!=null&&u(e,["codeExecution"],s);const a=l(t,["enterpriseWebSearch"]);a!=null&&u(e,["enterpriseWebSearch"],a);const c=l(t,["googleMaps"]);c!=null&&u(e,["googleMaps"],c);const d=l(t,["googleSearch"]);d!=null&&u(e,["googleSearch"],d);const f=l(t,["urlContext"]);return f!=null&&u(e,["urlContext"],f),e}function JS(t,e){const n={},i=l(t,["ttl"]);e!==void 0&&i!=null&&u(e,["ttl"],i);const o=l(t,["expireTime"]);return e!==void 0&&o!=null&&u(e,["expireTime"],o),n}function YS(t,e){const n={},i=l(t,["ttl"]);e!==void 0&&i!=null&&u(e,["ttl"],i);const o=l(t,["expireTime"]);return e!==void 0&&o!=null&&u(e,["expireTime"],o),n}function KS(t,e){const n={},i=l(e,["name"]);i!=null&&u(n,["_url","name"],Yt(t,i));const o=l(e,["config"]);return o!=null&&JS(o,n),n}function QS(t,e){const n={},i=l(e,["name"]);i!=null&&u(n,["_url","name"],Yt(t,i));const o=l(e,["config"]);return o!=null&&YS(o,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XS extends Jt{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Jn(qt.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(n),n)}async create(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=IS(this.apiClient,e);return a=M("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{const d=SS(this.apiClient,e);return a=M("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async get(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=LS(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{const d=DS(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async delete(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=AS(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=RS(f),p=new kh;return Object.assign(p,h),p})}else{const d=wS(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=NS(f),p=new kh;return Object.assign(p,h),p})}}async update(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=QS(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{const d=KS(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async listInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=HS(e);return a=M("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=qS(f),p=new Mh;return Object.assign(p,h),p})}else{const d=OS(e);return a=M("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=BS(f),p=new Mh;return Object.assign(p,h),p})}}}function Oh(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function oe(t){return this instanceof oe?(this.v=t,this):new oe(t)}function Ci(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),o,r=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(m){return function(v){return Promise.resolve(v).then(m,h)}}function a(m,v){i[m]&&(o[m]=function(E){return new Promise(function(S,_){r.push([m,E,S,_])>1||c(m,E)})},v&&(o[m]=v(o[m])))}function c(m,v){try{d(i[m](v))}catch(E){p(r[0][3],E)}}function d(m){m.value instanceof oe?Promise.resolve(m.value.v).then(f,h):p(r[0][2],m)}function f(m){c("next",m)}function h(m){c("throw",m)}function p(m,v){m(v),r.shift(),r.length&&c(r[0][0],r[0][1])}}function Io(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Oh=="function"?Oh(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(r){n[r]=t[r]&&function(s){return new Promise(function(a,c){s=t[r](s),o(a,c,s.done,s.value)})}}function o(r,s,a,c){Promise.resolve(c).then(function(d){r({value:d,done:a})},s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZS(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:E_(n)}function E_(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function jS(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Hh(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let i=0;for(;i<n;)if(t[i].role==="user")e.push(t[i]),i++;else{const o=[];let r=!0;for(;i<n&&t[i].role==="model";)o.push(t[i]),r&&!E_(t[i])&&(r=!1),i++;r?e.push(...o):e.pop()}return e}class e0{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new t0(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class t0{constructor(e,n,i,o={},r=[]){this.apiClient=e,this.modelsModule=n,this.model=i,this.config=o,this.history=r,this.sendPromise=Promise.resolve(),jS(r)}async sendMessage(e){var n;await this.sendPromise;const i=Ue(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var r,s,a;const c=await o,d=(s=(r=c.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content,f=c.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];f!=null&&(p=(a=f.slice(h))!==null&&a!==void 0?a:[]);const m=d?[d]:[];this.recordHistory(i,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var n;await this.sendPromise;const i=Ue(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const r=await o;return this.processStreamResponse(r,i)}getHistory(e=!1){const n=e?Hh(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var i,o;return Ci(this,arguments,function*(){var s,a,c,d;const f=[];try{for(var h=!0,p=Io(e),m;m=yield oe(p.next()),s=m.done,!s;h=!0){d=m.value,h=!1;const v=d;if(ZS(v)){const E=(o=(i=v.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content;E!==void 0&&f.push(E)}yield yield oe(v)}}catch(v){a={error:v}}finally{try{!h&&!s&&(c=p.return)&&(yield oe(c.call(p)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,i){let o=[];n.length>0&&n.every(r=>r.role!==void 0)?o=n:o.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...Hh(i)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sl extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,sl.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n0(t){const e={},n=l(t,["file"]);return n!=null&&u(e,["file"],n),e}function i0(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function o0(t){const e={},n=l(t,["name"]);return n!=null&&u(e,["_url","file"],h_(n)),e}function r0(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function s0(t){const e={},n=l(t,["name"]);return n!=null&&u(e,["_url","file"],h_(n)),e}function l0(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&u(e,["_query","pageSize"],i);const o=l(t,["pageToken"]);return e!==void 0&&o!=null&&u(e,["_query","pageToken"],o),n}function a0(t){const e={},n=l(t,["config"]);return n!=null&&l0(n,e),e}function u0(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&u(e,["nextPageToken"],i);const o=l(t,["files"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(s=>s)),u(e,["files"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class c0 extends Jt{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Jn(qt.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=a0(e);return r=M("files",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),o.then(c=>{const d=u0(c),f=new pT;return Object.assign(f,d),f})}}async createInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=n0(e);return r=M("upload/v1beta/files",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>{const d=i0(c),f=new mT;return Object.assign(f,d),f})}}async get(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=s0(e);return r=M("files/{file}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>c)}}async delete(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=o0(e);return r=M("files/{file}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),o.then(c=>{const d=r0(c),f=new gT;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Xr(t){const e={},n=l(t,["data"]);if(n!=null&&u(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function d0(t){const e={},n=l(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>N0(r))),u(e,["parts"],o)}const i=l(t,["role"]);return i!=null&&u(e,["role"],i),e}function f0(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&u(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function h0(t){const e={},n=l(t,["id"]);n!=null&&u(e,["id"],n);const i=l(t,["args"]);i!=null&&u(e,["args"],i);const o=l(t,["name"]);if(o!=null&&u(e,["name"],o),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function p0(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&u(e,["description"],n);const i=l(t,["name"]);i!=null&&u(e,["name"],i);const o=l(t,["parameters"]);o!=null&&u(e,["parameters"],o);const r=l(t,["parametersJsonSchema"]);r!=null&&u(e,["parametersJsonSchema"],r);const s=l(t,["response"]);s!=null&&u(e,["response"],s);const a=l(t,["responseJsonSchema"]);return a!=null&&u(e,["responseJsonSchema"],a),e}function m0(t){const e={},n=l(t,["modelSelectionConfig"]);n!=null&&u(e,["modelConfig"],n);const i=l(t,["responseJsonSchema"]);i!=null&&u(e,["responseJsonSchema"],i);const o=l(t,["audioTimestamp"]);o!=null&&u(e,["audioTimestamp"],o);const r=l(t,["candidateCount"]);r!=null&&u(e,["candidateCount"],r);const s=l(t,["enableAffectiveDialog"]);s!=null&&u(e,["enableAffectiveDialog"],s);const a=l(t,["frequencyPenalty"]);a!=null&&u(e,["frequencyPenalty"],a);const c=l(t,["logprobs"]);c!=null&&u(e,["logprobs"],c);const d=l(t,["maxOutputTokens"]);d!=null&&u(e,["maxOutputTokens"],d);const f=l(t,["mediaResolution"]);f!=null&&u(e,["mediaResolution"],f);const h=l(t,["presencePenalty"]);h!=null&&u(e,["presencePenalty"],h);const p=l(t,["responseLogprobs"]);p!=null&&u(e,["responseLogprobs"],p);const m=l(t,["responseMimeType"]);m!=null&&u(e,["responseMimeType"],m);const v=l(t,["responseModalities"]);v!=null&&u(e,["responseModalities"],v);const E=l(t,["responseSchema"]);E!=null&&u(e,["responseSchema"],E);const S=l(t,["routingConfig"]);S!=null&&u(e,["routingConfig"],S);const _=l(t,["seed"]);_!=null&&u(e,["seed"],_);const g=l(t,["speechConfig"]);g!=null&&u(e,["speechConfig"],C_(g));const y=l(t,["stopSequences"]);y!=null&&u(e,["stopSequences"],y);const C=l(t,["temperature"]);C!=null&&u(e,["temperature"],C);const I=l(t,["thinkingConfig"]);I!=null&&u(e,["thinkingConfig"],I);const A=l(t,["topK"]);A!=null&&u(e,["topK"],A);const N=l(t,["topP"]);if(N!=null&&u(e,["topP"],N),l(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function g0(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&u(e,["enableWidget"],n),e}function _0(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&u(e,["timeRangeFilter"],n),e}function y0(t,e){const n={},i=l(t,["generationConfig"]);e!==void 0&&i!=null&&u(e,["setup","generationConfig"],i);const o=l(t,["responseModalities"]);e!==void 0&&o!=null&&u(e,["setup","generationConfig","responseModalities"],o);const r=l(t,["temperature"]);e!==void 0&&r!=null&&u(e,["setup","generationConfig","temperature"],r);const s=l(t,["topP"]);e!==void 0&&s!=null&&u(e,["setup","generationConfig","topP"],s);const a=l(t,["topK"]);e!==void 0&&a!=null&&u(e,["setup","generationConfig","topK"],a);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&u(e,["setup","generationConfig","maxOutputTokens"],c);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&u(e,["setup","generationConfig","mediaResolution"],d);const f=l(t,["seed"]);e!==void 0&&f!=null&&u(e,["setup","generationConfig","seed"],f);const h=l(t,["speechConfig"]);e!==void 0&&h!=null&&u(e,["setup","generationConfig","speechConfig"],Mc(h));const p=l(t,["thinkingConfig"]);e!==void 0&&p!=null&&u(e,["setup","generationConfig","thinkingConfig"],p);const m=l(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&u(e,["setup","generationConfig","enableAffectiveDialog"],m);const v=l(t,["systemInstruction"]);e!==void 0&&v!=null&&u(e,["setup","systemInstruction"],d0(Ue(v)));const E=l(t,["tools"]);if(e!==void 0&&E!=null){let A=Wi(E);Array.isArray(A)&&(A=A.map(N=>P0(zi(N)))),u(e,["setup","tools"],A)}const S=l(t,["sessionResumption"]);e!==void 0&&S!=null&&u(e,["setup","sessionResumption"],R0(S));const _=l(t,["inputAudioTranscription"]);e!==void 0&&_!=null&&u(e,["setup","inputAudioTranscription"],_);const g=l(t,["outputAudioTranscription"]);e!==void 0&&g!=null&&u(e,["setup","outputAudioTranscription"],g);const y=l(t,["realtimeInputConfig"]);e!==void 0&&y!=null&&u(e,["setup","realtimeInputConfig"],y);const C=l(t,["contextWindowCompression"]);e!==void 0&&C!=null&&u(e,["setup","contextWindowCompression"],C);const I=l(t,["proactivity"]);return e!==void 0&&I!=null&&u(e,["setup","proactivity"],I),n}function v0(t,e){const n={},i=l(t,["generationConfig"]);e!==void 0&&i!=null&&u(e,["setup","generationConfig"],m0(i));const o=l(t,["responseModalities"]);e!==void 0&&o!=null&&u(e,["setup","generationConfig","responseModalities"],o);const r=l(t,["temperature"]);e!==void 0&&r!=null&&u(e,["setup","generationConfig","temperature"],r);const s=l(t,["topP"]);e!==void 0&&s!=null&&u(e,["setup","generationConfig","topP"],s);const a=l(t,["topK"]);e!==void 0&&a!=null&&u(e,["setup","generationConfig","topK"],a);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&u(e,["setup","generationConfig","maxOutputTokens"],c);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&u(e,["setup","generationConfig","mediaResolution"],d);const f=l(t,["seed"]);e!==void 0&&f!=null&&u(e,["setup","generationConfig","seed"],f);const h=l(t,["speechConfig"]);e!==void 0&&h!=null&&u(e,["setup","generationConfig","speechConfig"],C_(Mc(h)));const p=l(t,["thinkingConfig"]);e!==void 0&&p!=null&&u(e,["setup","generationConfig","thinkingConfig"],p);const m=l(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&u(e,["setup","generationConfig","enableAffectiveDialog"],m);const v=l(t,["systemInstruction"]);e!==void 0&&v!=null&&u(e,["setup","systemInstruction"],Ue(v));const E=l(t,["tools"]);if(e!==void 0&&E!=null){let A=Wi(E);Array.isArray(A)&&(A=A.map(N=>x0(zi(N)))),u(e,["setup","tools"],A)}const S=l(t,["sessionResumption"]);e!==void 0&&S!=null&&u(e,["setup","sessionResumption"],S);const _=l(t,["inputAudioTranscription"]);e!==void 0&&_!=null&&u(e,["setup","inputAudioTranscription"],_);const g=l(t,["outputAudioTranscription"]);e!==void 0&&g!=null&&u(e,["setup","outputAudioTranscription"],g);const y=l(t,["realtimeInputConfig"]);e!==void 0&&y!=null&&u(e,["setup","realtimeInputConfig"],y);const C=l(t,["contextWindowCompression"]);e!==void 0&&C!=null&&u(e,["setup","contextWindowCompression"],C);const I=l(t,["proactivity"]);return e!==void 0&&I!=null&&u(e,["setup","proactivity"],I),n}function E0(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["setup","model"],J(t,i));const o=l(e,["config"]);return o!=null&&u(n,["config"],y0(o,n)),n}function C0(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["setup","model"],J(t,i));const o=l(e,["config"]);return o!=null&&u(n,["config"],v0(o,n)),n}function T0(t){const e={},n=l(t,["musicGenerationConfig"]);return n!=null&&u(e,["musicGenerationConfig"],n),e}function S0(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>o)),u(e,["weightedPrompts"],i)}return e}function I0(t){const e={},n=l(t,["media"]);if(n!=null){let d=a_(n);Array.isArray(d)&&(d=d.map(f=>Xr(f))),u(e,["mediaChunks"],d)}const i=l(t,["audio"]);i!=null&&u(e,["audio"],Xr(c_(i)));const o=l(t,["audioStreamEnd"]);o!=null&&u(e,["audioStreamEnd"],o);const r=l(t,["video"]);r!=null&&u(e,["video"],Xr(u_(r)));const s=l(t,["text"]);s!=null&&u(e,["text"],s);const a=l(t,["activityStart"]);a!=null&&u(e,["activityStart"],a);const c=l(t,["activityEnd"]);return c!=null&&u(e,["activityEnd"],c),e}function w0(t){const e={},n=l(t,["media"]);if(n!=null){let d=a_(n);Array.isArray(d)&&(d=d.map(f=>f)),u(e,["mediaChunks"],d)}const i=l(t,["audio"]);i!=null&&u(e,["audio"],c_(i));const o=l(t,["audioStreamEnd"]);o!=null&&u(e,["audioStreamEnd"],o);const r=l(t,["video"]);r!=null&&u(e,["video"],u_(r));const s=l(t,["text"]);s!=null&&u(e,["text"],s);const a=l(t,["activityStart"]);a!=null&&u(e,["activityStart"],a);const c=l(t,["activityEnd"]);return c!=null&&u(e,["activityEnd"],c),e}function A0(t){const e={},n=l(t,["setupComplete"]);n!=null&&u(e,["setupComplete"],n);const i=l(t,["serverContent"]);i!=null&&u(e,["serverContent"],i);const o=l(t,["toolCall"]);o!=null&&u(e,["toolCall"],o);const r=l(t,["toolCallCancellation"]);r!=null&&u(e,["toolCallCancellation"],r);const s=l(t,["usageMetadata"]);s!=null&&u(e,["usageMetadata"],k0(s));const a=l(t,["goAway"]);a!=null&&u(e,["goAway"],a);const c=l(t,["sessionResumptionUpdate"]);return c!=null&&u(e,["sessionResumptionUpdate"],c),e}function N0(t){const e={},n=l(t,["mediaResolution"]);n!=null&&u(e,["mediaResolution"],n);const i=l(t,["codeExecutionResult"]);i!=null&&u(e,["codeExecutionResult"],i);const o=l(t,["executableCode"]);o!=null&&u(e,["executableCode"],o);const r=l(t,["fileData"]);r!=null&&u(e,["fileData"],f0(r));const s=l(t,["functionCall"]);s!=null&&u(e,["functionCall"],h0(s));const a=l(t,["functionResponse"]);a!=null&&u(e,["functionResponse"],a);const c=l(t,["inlineData"]);c!=null&&u(e,["inlineData"],Xr(c));const d=l(t,["text"]);d!=null&&u(e,["text"],d);const f=l(t,["thought"]);f!=null&&u(e,["thought"],f);const h=l(t,["thoughtSignature"]);h!=null&&u(e,["thoughtSignature"],h);const p=l(t,["videoMetadata"]);return p!=null&&u(e,["videoMetadata"],p),e}function R0(t){const e={},n=l(t,["handle"]);if(n!=null&&u(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function C_(t){const e={},n=l(t,["languageCode"]);n!=null&&u(e,["languageCode"],n);const i=l(t,["voiceConfig"]);if(i!=null&&u(e,["voiceConfig"],i),l(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function P0(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>h)),u(e,["functionDeclarations"],f)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(t,["googleSearchRetrieval"]);i!=null&&u(e,["googleSearchRetrieval"],i);const o=l(t,["computerUse"]);o!=null&&u(e,["computerUse"],o);const r=l(t,["fileSearch"]);r!=null&&u(e,["fileSearch"],r);const s=l(t,["codeExecution"]);if(s!=null&&u(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=l(t,["googleMaps"]);a!=null&&u(e,["googleMaps"],g0(a));const c=l(t,["googleSearch"]);c!=null&&u(e,["googleSearch"],_0(c));const d=l(t,["urlContext"]);return d!=null&&u(e,["urlContext"],d),e}function x0(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>p0(p))),u(e,["functionDeclarations"],h)}const i=l(t,["retrieval"]);i!=null&&u(e,["retrieval"],i);const o=l(t,["googleSearchRetrieval"]);o!=null&&u(e,["googleSearchRetrieval"],o);const r=l(t,["computerUse"]);if(r!=null&&u(e,["computerUse"],r),l(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=l(t,["codeExecution"]);s!=null&&u(e,["codeExecution"],s);const a=l(t,["enterpriseWebSearch"]);a!=null&&u(e,["enterpriseWebSearch"],a);const c=l(t,["googleMaps"]);c!=null&&u(e,["googleMaps"],c);const d=l(t,["googleSearch"]);d!=null&&u(e,["googleSearch"],d);const f=l(t,["urlContext"]);return f!=null&&u(e,["urlContext"],f),e}function k0(t){const e={},n=l(t,["promptTokenCount"]);n!=null&&u(e,["promptTokenCount"],n);const i=l(t,["cachedContentTokenCount"]);i!=null&&u(e,["cachedContentTokenCount"],i);const o=l(t,["candidatesTokenCount"]);o!=null&&u(e,["responseTokenCount"],o);const r=l(t,["toolUsePromptTokenCount"]);r!=null&&u(e,["toolUsePromptTokenCount"],r);const s=l(t,["thoughtsTokenCount"]);s!=null&&u(e,["thoughtsTokenCount"],s);const a=l(t,["totalTokenCount"]);a!=null&&u(e,["totalTokenCount"],a);const c=l(t,["promptTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(v=>v)),u(e,["promptTokensDetails"],m)}const d=l(t,["cacheTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(v=>v)),u(e,["cacheTokensDetails"],m)}const f=l(t,["candidatesTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(v=>v)),u(e,["responseTokensDetails"],m)}const h=l(t,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(v=>v)),u(e,["toolUsePromptTokensDetails"],m)}const p=l(t,["trafficType"]);return p!=null&&u(e,["trafficType"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function M0(t){const e={},n=l(t,["data"]);if(n!=null&&u(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function D0(t){const e={},n=l(t,["content"]);n!=null&&u(e,["content"],n);const i=l(t,["citationMetadata"]);i!=null&&u(e,["citationMetadata"],L0(i));const o=l(t,["tokenCount"]);o!=null&&u(e,["tokenCount"],o);const r=l(t,["finishReason"]);r!=null&&u(e,["finishReason"],r);const s=l(t,["avgLogprobs"]);s!=null&&u(e,["avgLogprobs"],s);const a=l(t,["groundingMetadata"]);a!=null&&u(e,["groundingMetadata"],a);const c=l(t,["index"]);c!=null&&u(e,["index"],c);const d=l(t,["logprobsResult"]);d!=null&&u(e,["logprobsResult"],d);const f=l(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),u(e,["safetyRatings"],p)}const h=l(t,["urlContextMetadata"]);return h!=null&&u(e,["urlContextMetadata"],h),e}function L0(t){const e={},n=l(t,["citationSources"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>o)),u(e,["citations"],i)}return e}function F0(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["contents"]);if(o!=null){let r=at(o);Array.isArray(r)&&(r=r.map(s=>s)),u(n,["contents"],r)}return n}function U0(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["tokensInfo"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>r)),u(e,["tokensInfo"],o)}return e}function V0(t){const e={},n=l(t,["values"]);n!=null&&u(e,["values"],n);const i=l(t,["statistics"]);return i!=null&&u(e,["statistics"],G0(i)),e}function G0(t){const e={},n=l(t,["truncated"]);n!=null&&u(e,["truncated"],n);const i=l(t,["token_count"]);return i!=null&&u(e,["tokenCount"],i),e}function ll(t){const e={},n=l(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>JI(r))),u(e,["parts"],o)}const i=l(t,["role"]);return i!=null&&u(e,["role"],i),e}function O0(t){const e={},n=l(t,["controlType"]);n!=null&&u(e,["controlType"],n);const i=l(t,["enableControlImageComputation"]);return i!=null&&u(e,["computeControl"],i),e}function H0(t){const e={};if(l(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(l(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(l(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function B0(t,e){const n={},i=l(t,["systemInstruction"]);e!==void 0&&i!=null&&u(e,["systemInstruction"],Ue(i));const o=l(t,["tools"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>A_(a))),u(e,["tools"],s)}const r=l(t,["generationConfig"]);return e!==void 0&&r!=null&&u(e,["generationConfig"],MI(r)),n}function q0(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["contents"]);if(o!=null){let s=at(o);Array.isArray(s)&&(s=s.map(a=>ll(a))),u(n,["contents"],s)}const r=l(e,["config"]);return r!=null&&H0(r),n}function b0(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["contents"]);if(o!=null){let s=at(o);Array.isArray(s)&&(s=s.map(a=>a)),u(n,["contents"],s)}const r=l(e,["config"]);return r!=null&&B0(r,n),n}function z0(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["totalTokens"]);i!=null&&u(e,["totalTokens"],i);const o=l(t,["cachedContentTokenCount"]);return o!=null&&u(e,["cachedContentTokenCount"],o),e}function W0(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["totalTokens"]);return i!=null&&u(e,["totalTokens"],i),e}function $0(t,e){const n={},i=l(e,["model"]);return i!=null&&u(n,["_url","name"],J(t,i)),n}function J0(t,e){const n={},i=l(e,["model"]);return i!=null&&u(n,["_url","name"],J(t,i)),n}function Y0(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function K0(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function Q0(t,e){const n={},i=l(t,["outputGcsUri"]);e!==void 0&&i!=null&&u(e,["parameters","storageUri"],i);const o=l(t,["negativePrompt"]);e!==void 0&&o!=null&&u(e,["parameters","negativePrompt"],o);const r=l(t,["numberOfImages"]);e!==void 0&&r!=null&&u(e,["parameters","sampleCount"],r);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&u(e,["parameters","aspectRatio"],s);const a=l(t,["guidanceScale"]);e!==void 0&&a!=null&&u(e,["parameters","guidanceScale"],a);const c=l(t,["seed"]);e!==void 0&&c!=null&&u(e,["parameters","seed"],c);const d=l(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&u(e,["parameters","safetySetting"],d);const f=l(t,["personGeneration"]);e!==void 0&&f!=null&&u(e,["parameters","personGeneration"],f);const h=l(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&u(e,["parameters","includeSafetyAttributes"],h);const p=l(t,["includeRaiReason"]);e!==void 0&&p!=null&&u(e,["parameters","includeRaiReason"],p);const m=l(t,["language"]);e!==void 0&&m!=null&&u(e,["parameters","language"],m);const v=l(t,["outputMimeType"]);e!==void 0&&v!=null&&u(e,["parameters","outputOptions","mimeType"],v);const E=l(t,["outputCompressionQuality"]);e!==void 0&&E!=null&&u(e,["parameters","outputOptions","compressionQuality"],E);const S=l(t,["addWatermark"]);e!==void 0&&S!=null&&u(e,["parameters","addWatermark"],S);const _=l(t,["labels"]);e!==void 0&&_!=null&&u(e,["labels"],_);const g=l(t,["editMode"]);e!==void 0&&g!=null&&u(e,["parameters","editMode"],g);const y=l(t,["baseSteps"]);return e!==void 0&&y!=null&&u(e,["parameters","editConfig","baseSteps"],y),n}function X0(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["prompt"]);o!=null&&u(n,["instances[0]","prompt"],o);const r=l(e,["referenceImages"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>jI(c))),u(n,["instances[0]","referenceImages"],a)}const s=l(e,["config"]);return s!=null&&Q0(s,n),n}function Z0(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>al(r))),u(e,["generatedImages"],o)}return e}function j0(t,e){const n={},i=l(t,["taskType"]);e!==void 0&&i!=null&&u(e,["requests[]","taskType"],i);const o=l(t,["title"]);e!==void 0&&o!=null&&u(e,["requests[]","title"],o);const r=l(t,["outputDimensionality"]);if(e!==void 0&&r!=null&&u(e,["requests[]","outputDimensionality"],r),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function eI(t,e){const n={},i=l(t,["taskType"]);e!==void 0&&i!=null&&u(e,["instances[]","task_type"],i);const o=l(t,["title"]);e!==void 0&&o!=null&&u(e,["instances[]","title"],o);const r=l(t,["outputDimensionality"]);e!==void 0&&r!=null&&u(e,["parameters","outputDimensionality"],r);const s=l(t,["mimeType"]);e!==void 0&&s!=null&&u(e,["instances[]","mimeType"],s);const a=l(t,["autoTruncate"]);return e!==void 0&&a!=null&&u(e,["parameters","autoTruncate"],a),n}function tI(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["contents"]);if(o!=null){let a=Pc(t,o);Array.isArray(a)&&(a=a.map(c=>c)),u(n,["requests[]","content"],a)}const r=l(e,["config"]);r!=null&&j0(r,n);const s=l(e,["model"]);return s!==void 0&&u(n,["requests[]","model"],J(t,s)),n}function nI(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["contents"]);if(o!=null){let s=Pc(t,o);Array.isArray(s)&&(s=s.map(a=>a)),u(n,["instances[]","content"],s)}const r=l(e,["config"]);return r!=null&&eI(r,n),n}function iI(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["embeddings"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>s)),u(e,["embeddings"],r)}const o=l(t,["metadata"]);return o!=null&&u(e,["metadata"],o),e}function oI(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["predictions[]","embeddings"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>V0(s))),u(e,["embeddings"],r)}const o=l(t,["metadata"]);return o!=null&&u(e,["metadata"],o),e}function rI(t){const e={},n=l(t,["endpoint"]);n!=null&&u(e,["name"],n);const i=l(t,["deployedModelId"]);return i!=null&&u(e,["deployedModelId"],i),e}function sI(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&u(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function lI(t){const e={},n=l(t,["id"]);n!=null&&u(e,["id"],n);const i=l(t,["args"]);i!=null&&u(e,["args"],i);const o=l(t,["name"]);if(o!=null&&u(e,["name"],o),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function aI(t){const e={},n=l(t,["mode"]);n!=null&&u(e,["mode"],n);const i=l(t,["allowedFunctionNames"]);if(i!=null&&u(e,["allowedFunctionNames"],i),l(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function uI(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&u(e,["description"],n);const i=l(t,["name"]);i!=null&&u(e,["name"],i);const o=l(t,["parameters"]);o!=null&&u(e,["parameters"],o);const r=l(t,["parametersJsonSchema"]);r!=null&&u(e,["parametersJsonSchema"],r);const s=l(t,["response"]);s!=null&&u(e,["response"],s);const a=l(t,["responseJsonSchema"]);return a!=null&&u(e,["responseJsonSchema"],a),e}function cI(t,e,n){const i={},o=l(e,["systemInstruction"]);n!==void 0&&o!=null&&u(n,["systemInstruction"],ll(Ue(o)));const r=l(e,["temperature"]);r!=null&&u(i,["temperature"],r);const s=l(e,["topP"]);s!=null&&u(i,["topP"],s);const a=l(e,["topK"]);a!=null&&u(i,["topK"],a);const c=l(e,["candidateCount"]);c!=null&&u(i,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&u(i,["maxOutputTokens"],d);const f=l(e,["stopSequences"]);f!=null&&u(i,["stopSequences"],f);const h=l(e,["responseLogprobs"]);h!=null&&u(i,["responseLogprobs"],h);const p=l(e,["logprobs"]);p!=null&&u(i,["logprobs"],p);const m=l(e,["presencePenalty"]);m!=null&&u(i,["presencePenalty"],m);const v=l(e,["frequencyPenalty"]);v!=null&&u(i,["frequencyPenalty"],v);const E=l(e,["seed"]);E!=null&&u(i,["seed"],E);const S=l(e,["responseMimeType"]);S!=null&&u(i,["responseMimeType"],S);const _=l(e,["responseSchema"]);_!=null&&u(i,["responseSchema"],xc(_));const g=l(e,["responseJsonSchema"]);if(g!=null&&u(i,["responseJsonSchema"],g),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=l(e,["safetySettings"]);if(n!==void 0&&y!=null){let U=y;Array.isArray(U)&&(U=U.map(O=>ew(O))),u(n,["safetySettings"],U)}const C=l(e,["tools"]);if(n!==void 0&&C!=null){let U=Wi(C);Array.isArray(U)&&(U=U.map(O=>lw(zi(O)))),u(n,["tools"],U)}const I=l(e,["toolConfig"]);if(n!==void 0&&I!=null&&u(n,["toolConfig"],sw(I)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=l(e,["cachedContent"]);n!==void 0&&A!=null&&u(n,["cachedContent"],Yt(t,A));const N=l(e,["responseModalities"]);N!=null&&u(i,["responseModalities"],N);const k=l(e,["mediaResolution"]);k!=null&&u(i,["mediaResolution"],k);const w=l(e,["speechConfig"]);if(w!=null&&u(i,["speechConfig"],kc(w)),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=l(e,["thinkingConfig"]);P!=null&&u(i,["thinkingConfig"],P);const F=l(e,["imageConfig"]);return F!=null&&u(i,["imageConfig"],VI(F)),i}function dI(t,e,n){const i={},o=l(e,["systemInstruction"]);n!==void 0&&o!=null&&u(n,["systemInstruction"],Ue(o));const r=l(e,["temperature"]);r!=null&&u(i,["temperature"],r);const s=l(e,["topP"]);s!=null&&u(i,["topP"],s);const a=l(e,["topK"]);a!=null&&u(i,["topK"],a);const c=l(e,["candidateCount"]);c!=null&&u(i,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&u(i,["maxOutputTokens"],d);const f=l(e,["stopSequences"]);f!=null&&u(i,["stopSequences"],f);const h=l(e,["responseLogprobs"]);h!=null&&u(i,["responseLogprobs"],h);const p=l(e,["logprobs"]);p!=null&&u(i,["logprobs"],p);const m=l(e,["presencePenalty"]);m!=null&&u(i,["presencePenalty"],m);const v=l(e,["frequencyPenalty"]);v!=null&&u(i,["frequencyPenalty"],v);const E=l(e,["seed"]);E!=null&&u(i,["seed"],E);const S=l(e,["responseMimeType"]);S!=null&&u(i,["responseMimeType"],S);const _=l(e,["responseSchema"]);_!=null&&u(i,["responseSchema"],xc(_));const g=l(e,["responseJsonSchema"]);g!=null&&u(i,["responseJsonSchema"],g);const y=l(e,["routingConfig"]);y!=null&&u(i,["routingConfig"],y);const C=l(e,["modelSelectionConfig"]);C!=null&&u(i,["modelConfig"],C);const I=l(e,["safetySettings"]);if(n!==void 0&&I!=null){let W=I;Array.isArray(W)&&(W=W.map(Te=>Te)),u(n,["safetySettings"],W)}const A=l(e,["tools"]);if(n!==void 0&&A!=null){let W=Wi(A);Array.isArray(W)&&(W=W.map(Te=>A_(zi(Te)))),u(n,["tools"],W)}const N=l(e,["toolConfig"]);n!==void 0&&N!=null&&u(n,["toolConfig"],N);const k=l(e,["labels"]);n!==void 0&&k!=null&&u(n,["labels"],k);const w=l(e,["cachedContent"]);n!==void 0&&w!=null&&u(n,["cachedContent"],Yt(t,w));const P=l(e,["responseModalities"]);P!=null&&u(i,["responseModalities"],P);const F=l(e,["mediaResolution"]);F!=null&&u(i,["mediaResolution"],F);const U=l(e,["speechConfig"]);U!=null&&u(i,["speechConfig"],w_(kc(U)));const O=l(e,["audioTimestamp"]);O!=null&&u(i,["audioTimestamp"],O);const Y=l(e,["thinkingConfig"]);Y!=null&&u(i,["thinkingConfig"],Y);const ne=l(e,["imageConfig"]);return ne!=null&&u(i,["imageConfig"],GI(ne)),i}function Bh(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["contents"]);if(o!=null){let s=at(o);Array.isArray(s)&&(s=s.map(a=>ll(a))),u(n,["contents"],s)}const r=l(e,["config"]);return r!=null&&u(n,["generationConfig"],cI(t,r,n)),n}function qh(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["contents"]);if(o!=null){let s=at(o);Array.isArray(s)&&(s=s.map(a=>a)),u(n,["contents"],s)}const r=l(e,["config"]);return r!=null&&u(n,["generationConfig"],dI(t,r,n)),n}function bh(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>D0(d))),u(e,["candidates"],c)}const o=l(t,["modelVersion"]);o!=null&&u(e,["modelVersion"],o);const r=l(t,["promptFeedback"]);r!=null&&u(e,["promptFeedback"],r);const s=l(t,["responseId"]);s!=null&&u(e,["responseId"],s);const a=l(t,["usageMetadata"]);return a!=null&&u(e,["usageMetadata"],a),e}function zh(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["candidates"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(f=>f)),u(e,["candidates"],d)}const o=l(t,["createTime"]);o!=null&&u(e,["createTime"],o);const r=l(t,["modelVersion"]);r!=null&&u(e,["modelVersion"],r);const s=l(t,["promptFeedback"]);s!=null&&u(e,["promptFeedback"],s);const a=l(t,["responseId"]);a!=null&&u(e,["responseId"],a);const c=l(t,["usageMetadata"]);return c!=null&&u(e,["usageMetadata"],c),e}function fI(t,e){const n={};if(l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=l(t,["numberOfImages"]);e!==void 0&&i!=null&&u(e,["parameters","sampleCount"],i);const o=l(t,["aspectRatio"]);e!==void 0&&o!=null&&u(e,["parameters","aspectRatio"],o);const r=l(t,["guidanceScale"]);if(e!==void 0&&r!=null&&u(e,["parameters","guidanceScale"],r),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=l(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&u(e,["parameters","safetySetting"],s);const a=l(t,["personGeneration"]);e!==void 0&&a!=null&&u(e,["parameters","personGeneration"],a);const c=l(t,["includeSafetyAttributes"]);e!==void 0&&c!=null&&u(e,["parameters","includeSafetyAttributes"],c);const d=l(t,["includeRaiReason"]);e!==void 0&&d!=null&&u(e,["parameters","includeRaiReason"],d);const f=l(t,["language"]);e!==void 0&&f!=null&&u(e,["parameters","language"],f);const h=l(t,["outputMimeType"]);e!==void 0&&h!=null&&u(e,["parameters","outputOptions","mimeType"],h);const p=l(t,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&u(e,["parameters","outputOptions","compressionQuality"],p),l(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(l(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const m=l(t,["imageSize"]);if(e!==void 0&&m!=null&&u(e,["parameters","sampleImageSize"],m),l(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function hI(t,e){const n={},i=l(t,["outputGcsUri"]);e!==void 0&&i!=null&&u(e,["parameters","storageUri"],i);const o=l(t,["negativePrompt"]);e!==void 0&&o!=null&&u(e,["parameters","negativePrompt"],o);const r=l(t,["numberOfImages"]);e!==void 0&&r!=null&&u(e,["parameters","sampleCount"],r);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&u(e,["parameters","aspectRatio"],s);const a=l(t,["guidanceScale"]);e!==void 0&&a!=null&&u(e,["parameters","guidanceScale"],a);const c=l(t,["seed"]);e!==void 0&&c!=null&&u(e,["parameters","seed"],c);const d=l(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&u(e,["parameters","safetySetting"],d);const f=l(t,["personGeneration"]);e!==void 0&&f!=null&&u(e,["parameters","personGeneration"],f);const h=l(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&u(e,["parameters","includeSafetyAttributes"],h);const p=l(t,["includeRaiReason"]);e!==void 0&&p!=null&&u(e,["parameters","includeRaiReason"],p);const m=l(t,["language"]);e!==void 0&&m!=null&&u(e,["parameters","language"],m);const v=l(t,["outputMimeType"]);e!==void 0&&v!=null&&u(e,["parameters","outputOptions","mimeType"],v);const E=l(t,["outputCompressionQuality"]);e!==void 0&&E!=null&&u(e,["parameters","outputOptions","compressionQuality"],E);const S=l(t,["addWatermark"]);e!==void 0&&S!=null&&u(e,["parameters","addWatermark"],S);const _=l(t,["labels"]);e!==void 0&&_!=null&&u(e,["labels"],_);const g=l(t,["imageSize"]);e!==void 0&&g!=null&&u(e,["parameters","sampleImageSize"],g);const y=l(t,["enhancePrompt"]);return e!==void 0&&y!=null&&u(e,["parameters","enhancePrompt"],y),n}function pI(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["prompt"]);o!=null&&u(n,["instances[0]","prompt"],o);const r=l(e,["config"]);return r!=null&&fI(r,n),n}function mI(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["prompt"]);o!=null&&u(n,["instances[0]","prompt"],o);const r=l(e,["config"]);return r!=null&&hI(r,n),n}function gI(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>RI(s))),u(e,["generatedImages"],r)}const o=l(t,["positivePromptSafetyAttributes"]);return o!=null&&u(e,["positivePromptSafetyAttributes"],S_(o)),e}function _I(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>al(s))),u(e,["generatedImages"],r)}const o=l(t,["positivePromptSafetyAttributes"]);return o!=null&&u(e,["positivePromptSafetyAttributes"],I_(o)),e}function yI(t,e){const n={},i=l(t,["numberOfVideos"]);if(e!==void 0&&i!=null&&u(e,["parameters","sampleCount"],i),l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=l(t,["durationSeconds"]);if(e!==void 0&&o!=null&&u(e,["parameters","durationSeconds"],o),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=l(t,["aspectRatio"]);e!==void 0&&r!=null&&u(e,["parameters","aspectRatio"],r);const s=l(t,["resolution"]);e!==void 0&&s!=null&&u(e,["parameters","resolution"],s);const a=l(t,["personGeneration"]);if(e!==void 0&&a!=null&&u(e,["parameters","personGeneration"],a),l(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=l(t,["negativePrompt"]);e!==void 0&&c!=null&&u(e,["parameters","negativePrompt"],c);const d=l(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&u(e,["parameters","enhancePrompt"],d),l(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=l(t,["lastFrame"]);e!==void 0&&f!=null&&u(e,["instances[0]","lastFrame"],ul(f));const h=l(t,["referenceImages"]);if(e!==void 0&&h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>Ew(m))),u(e,["instances[0]","referenceImages"],p)}if(l(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(l(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function vI(t,e){const n={},i=l(t,["numberOfVideos"]);e!==void 0&&i!=null&&u(e,["parameters","sampleCount"],i);const o=l(t,["outputGcsUri"]);e!==void 0&&o!=null&&u(e,["parameters","storageUri"],o);const r=l(t,["fps"]);e!==void 0&&r!=null&&u(e,["parameters","fps"],r);const s=l(t,["durationSeconds"]);e!==void 0&&s!=null&&u(e,["parameters","durationSeconds"],s);const a=l(t,["seed"]);e!==void 0&&a!=null&&u(e,["parameters","seed"],a);const c=l(t,["aspectRatio"]);e!==void 0&&c!=null&&u(e,["parameters","aspectRatio"],c);const d=l(t,["resolution"]);e!==void 0&&d!=null&&u(e,["parameters","resolution"],d);const f=l(t,["personGeneration"]);e!==void 0&&f!=null&&u(e,["parameters","personGeneration"],f);const h=l(t,["pubsubTopic"]);e!==void 0&&h!=null&&u(e,["parameters","pubsubTopic"],h);const p=l(t,["negativePrompt"]);e!==void 0&&p!=null&&u(e,["parameters","negativePrompt"],p);const m=l(t,["enhancePrompt"]);e!==void 0&&m!=null&&u(e,["parameters","enhancePrompt"],m);const v=l(t,["generateAudio"]);e!==void 0&&v!=null&&u(e,["parameters","generateAudio"],v);const E=l(t,["lastFrame"]);e!==void 0&&E!=null&&u(e,["instances[0]","lastFrame"],Ct(E));const S=l(t,["referenceImages"]);if(e!==void 0&&S!=null){let y=S;Array.isArray(y)&&(y=y.map(C=>Cw(C))),u(e,["instances[0]","referenceImages"],y)}const _=l(t,["mask"]);e!==void 0&&_!=null&&u(e,["instances[0]","mask"],vw(_));const g=l(t,["compressionQuality"]);return e!==void 0&&g!=null&&u(e,["parameters","compressionQuality"],g),n}function EI(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["metadata"]);i!=null&&u(e,["metadata"],i);const o=l(t,["done"]);o!=null&&u(e,["done"],o);const r=l(t,["error"]);r!=null&&u(e,["error"],r);const s=l(t,["response","generateVideoResponse"]);return s!=null&&u(e,["response"],II(s)),e}function CI(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["metadata"]);i!=null&&u(e,["metadata"],i);const o=l(t,["done"]);o!=null&&u(e,["done"],o);const r=l(t,["error"]);r!=null&&u(e,["error"],r);const s=l(t,["response"]);return s!=null&&u(e,["response"],wI(s)),e}function TI(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["prompt"]);o!=null&&u(n,["instances[0]","prompt"],o);const r=l(e,["image"]);r!=null&&u(n,["instances[0]","image"],ul(r));const s=l(e,["video"]);s!=null&&u(n,["instances[0]","video"],N_(s));const a=l(e,["source"]);a!=null&&AI(a,n);const c=l(e,["config"]);return c!=null&&yI(c,n),n}function SI(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["prompt"]);o!=null&&u(n,["instances[0]","prompt"],o);const r=l(e,["image"]);r!=null&&u(n,["instances[0]","image"],Ct(r));const s=l(e,["video"]);s!=null&&u(n,["instances[0]","video"],R_(s));const a=l(e,["source"]);a!=null&&NI(a,n);const c=l(e,["config"]);return c!=null&&vI(c,n),n}function II(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>xI(s))),u(e,["generatedVideos"],r)}const i=l(t,["raiMediaFilteredCount"]);i!=null&&u(e,["raiMediaFilteredCount"],i);const o=l(t,["raiMediaFilteredReasons"]);return o!=null&&u(e,["raiMediaFilteredReasons"],o),e}function wI(t){const e={},n=l(t,["videos"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>kI(s))),u(e,["generatedVideos"],r)}const i=l(t,["raiMediaFilteredCount"]);i!=null&&u(e,["raiMediaFilteredCount"],i);const o=l(t,["raiMediaFilteredReasons"]);return o!=null&&u(e,["raiMediaFilteredReasons"],o),e}function AI(t,e){const n={},i=l(t,["prompt"]);e!==void 0&&i!=null&&u(e,["instances[0]","prompt"],i);const o=l(t,["image"]);e!==void 0&&o!=null&&u(e,["instances[0]","image"],ul(o));const r=l(t,["video"]);return e!==void 0&&r!=null&&u(e,["instances[0]","video"],N_(r)),n}function NI(t,e){const n={},i=l(t,["prompt"]);e!==void 0&&i!=null&&u(e,["instances[0]","prompt"],i);const o=l(t,["image"]);e!==void 0&&o!=null&&u(e,["instances[0]","image"],Ct(o));const r=l(t,["video"]);return e!==void 0&&r!=null&&u(e,["instances[0]","video"],R_(r)),n}function RI(t){const e={},n=l(t,["_self"]);n!=null&&u(e,["image"],OI(n));const i=l(t,["raiFilteredReason"]);i!=null&&u(e,["raiFilteredReason"],i);const o=l(t,["_self"]);return o!=null&&u(e,["safetyAttributes"],S_(o)),e}function al(t){const e={},n=l(t,["_self"]);n!=null&&u(e,["image"],T_(n));const i=l(t,["raiFilteredReason"]);i!=null&&u(e,["raiFilteredReason"],i);const o=l(t,["_self"]);o!=null&&u(e,["safetyAttributes"],I_(o));const r=l(t,["prompt"]);return r!=null&&u(e,["enhancedPrompt"],r),e}function PI(t){const e={},n=l(t,["_self"]);n!=null&&u(e,["mask"],T_(n));const i=l(t,["labels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>r)),u(e,["labels"],o)}return e}function xI(t){const e={},n=l(t,["video"]);return n!=null&&u(e,["video"],_w(n)),e}function kI(t){const e={},n=l(t,["_self"]);return n!=null&&u(e,["video"],yw(n)),e}function MI(t){const e={},n=l(t,["modelSelectionConfig"]);n!=null&&u(e,["modelConfig"],n);const i=l(t,["responseJsonSchema"]);i!=null&&u(e,["responseJsonSchema"],i);const o=l(t,["audioTimestamp"]);o!=null&&u(e,["audioTimestamp"],o);const r=l(t,["candidateCount"]);r!=null&&u(e,["candidateCount"],r);const s=l(t,["enableAffectiveDialog"]);s!=null&&u(e,["enableAffectiveDialog"],s);const a=l(t,["frequencyPenalty"]);a!=null&&u(e,["frequencyPenalty"],a);const c=l(t,["logprobs"]);c!=null&&u(e,["logprobs"],c);const d=l(t,["maxOutputTokens"]);d!=null&&u(e,["maxOutputTokens"],d);const f=l(t,["mediaResolution"]);f!=null&&u(e,["mediaResolution"],f);const h=l(t,["presencePenalty"]);h!=null&&u(e,["presencePenalty"],h);const p=l(t,["responseLogprobs"]);p!=null&&u(e,["responseLogprobs"],p);const m=l(t,["responseMimeType"]);m!=null&&u(e,["responseMimeType"],m);const v=l(t,["responseModalities"]);v!=null&&u(e,["responseModalities"],v);const E=l(t,["responseSchema"]);E!=null&&u(e,["responseSchema"],E);const S=l(t,["routingConfig"]);S!=null&&u(e,["routingConfig"],S);const _=l(t,["seed"]);_!=null&&u(e,["seed"],_);const g=l(t,["speechConfig"]);g!=null&&u(e,["speechConfig"],w_(g));const y=l(t,["stopSequences"]);y!=null&&u(e,["stopSequences"],y);const C=l(t,["temperature"]);C!=null&&u(e,["temperature"],C);const I=l(t,["thinkingConfig"]);I!=null&&u(e,["thinkingConfig"],I);const A=l(t,["topK"]);A!=null&&u(e,["topK"],A);const N=l(t,["topP"]);if(N!=null&&u(e,["topP"],N),l(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function DI(t,e){const n={},i=l(e,["model"]);return i!=null&&u(n,["_url","name"],J(t,i)),n}function LI(t,e){const n={},i=l(e,["model"]);return i!=null&&u(n,["_url","name"],J(t,i)),n}function FI(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&u(e,["enableWidget"],n),e}function UI(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&u(e,["timeRangeFilter"],n),e}function VI(t){const e={},n=l(t,["aspectRatio"]);n!=null&&u(e,["aspectRatio"],n);const i=l(t,["imageSize"]);if(i!=null&&u(e,["imageSize"],i),l(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(l(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function GI(t){const e={},n=l(t,["aspectRatio"]);n!=null&&u(e,["aspectRatio"],n);const i=l(t,["imageSize"]);i!=null&&u(e,["imageSize"],i);const o=l(t,["outputMimeType"]);o!=null&&u(e,["imageOutputOptions","mimeType"],o);const r=l(t,["outputCompressionQuality"]);return r!=null&&u(e,["imageOutputOptions","compressionQuality"],r),e}function OI(t){const e={},n=l(t,["bytesBase64Encoded"]);n!=null&&u(e,["imageBytes"],Tn(n));const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function T_(t){const e={},n=l(t,["gcsUri"]);n!=null&&u(e,["gcsUri"],n);const i=l(t,["bytesBase64Encoded"]);i!=null&&u(e,["imageBytes"],Tn(i));const o=l(t,["mimeType"]);return o!=null&&u(e,["mimeType"],o),e}function ul(t){const e={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=l(t,["imageBytes"]);n!=null&&u(e,["bytesBase64Encoded"],Tn(n));const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function Ct(t){const e={},n=l(t,["gcsUri"]);n!=null&&u(e,["gcsUri"],n);const i=l(t,["imageBytes"]);i!=null&&u(e,["bytesBase64Encoded"],Tn(i));const o=l(t,["mimeType"]);return o!=null&&u(e,["mimeType"],o),e}function HI(t,e,n){const i={},o=l(e,["pageSize"]);n!==void 0&&o!=null&&u(n,["_query","pageSize"],o);const r=l(e,["pageToken"]);n!==void 0&&r!=null&&u(n,["_query","pageToken"],r);const s=l(e,["filter"]);n!==void 0&&s!=null&&u(n,["_query","filter"],s);const a=l(e,["queryBase"]);return n!==void 0&&a!=null&&u(n,["_url","models_url"],p_(t,a)),i}function BI(t,e,n){const i={},o=l(e,["pageSize"]);n!==void 0&&o!=null&&u(n,["_query","pageSize"],o);const r=l(e,["pageToken"]);n!==void 0&&r!=null&&u(n,["_query","pageToken"],r);const s=l(e,["filter"]);n!==void 0&&s!=null&&u(n,["_query","filter"],s);const a=l(e,["queryBase"]);return n!==void 0&&a!=null&&u(n,["_url","models_url"],p_(t,a)),i}function qI(t,e){const n={},i=l(e,["config"]);return i!=null&&HI(t,i,n),n}function bI(t,e){const n={},i=l(e,["config"]);return i!=null&&BI(t,i,n),n}function zI(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&u(e,["nextPageToken"],i);const o=l(t,["_self"]);if(o!=null){let r=m_(o);Array.isArray(r)&&(r=r.map(s=>ru(s))),u(e,["models"],r)}return e}function WI(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&u(e,["nextPageToken"],i);const o=l(t,["_self"]);if(o!=null){let r=m_(o);Array.isArray(r)&&(r=r.map(s=>su(s))),u(e,["models"],r)}return e}function $I(t){const e={},n=l(t,["maskMode"]);n!=null&&u(e,["maskMode"],n);const i=l(t,["segmentationClasses"]);i!=null&&u(e,["maskClasses"],i);const o=l(t,["maskDilation"]);return o!=null&&u(e,["dilation"],o),e}function ru(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["displayName"]);i!=null&&u(e,["displayName"],i);const o=l(t,["description"]);o!=null&&u(e,["description"],o);const r=l(t,["version"]);r!=null&&u(e,["version"],r);const s=l(t,["_self"]);s!=null&&u(e,["tunedModelInfo"],aw(s));const a=l(t,["inputTokenLimit"]);a!=null&&u(e,["inputTokenLimit"],a);const c=l(t,["outputTokenLimit"]);c!=null&&u(e,["outputTokenLimit"],c);const d=l(t,["supportedGenerationMethods"]);d!=null&&u(e,["supportedActions"],d);const f=l(t,["temperature"]);f!=null&&u(e,["temperature"],f);const h=l(t,["maxTemperature"]);h!=null&&u(e,["maxTemperature"],h);const p=l(t,["topP"]);p!=null&&u(e,["topP"],p);const m=l(t,["topK"]);m!=null&&u(e,["topK"],m);const v=l(t,["thinking"]);return v!=null&&u(e,["thinking"],v),e}function su(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["displayName"]);i!=null&&u(e,["displayName"],i);const o=l(t,["description"]);o!=null&&u(e,["description"],o);const r=l(t,["versionId"]);r!=null&&u(e,["version"],r);const s=l(t,["deployedModels"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>rI(p))),u(e,["endpoints"],h)}const a=l(t,["labels"]);a!=null&&u(e,["labels"],a);const c=l(t,["_self"]);c!=null&&u(e,["tunedModelInfo"],uw(c));const d=l(t,["defaultCheckpointId"]);d!=null&&u(e,["defaultCheckpointId"],d);const f=l(t,["checkpoints"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(p=>p)),u(e,["checkpoints"],h)}return e}function JI(t){const e={},n=l(t,["mediaResolution"]);n!=null&&u(e,["mediaResolution"],n);const i=l(t,["codeExecutionResult"]);i!=null&&u(e,["codeExecutionResult"],i);const o=l(t,["executableCode"]);o!=null&&u(e,["executableCode"],o);const r=l(t,["fileData"]);r!=null&&u(e,["fileData"],sI(r));const s=l(t,["functionCall"]);s!=null&&u(e,["functionCall"],lI(s));const a=l(t,["functionResponse"]);a!=null&&u(e,["functionResponse"],a);const c=l(t,["inlineData"]);c!=null&&u(e,["inlineData"],M0(c));const d=l(t,["text"]);d!=null&&u(e,["text"],d);const f=l(t,["thought"]);f!=null&&u(e,["thought"],f);const h=l(t,["thoughtSignature"]);h!=null&&u(e,["thoughtSignature"],h);const p=l(t,["videoMetadata"]);return p!=null&&u(e,["videoMetadata"],p),e}function YI(t){const e={},n=l(t,["productImage"]);return n!=null&&u(e,["image"],Ct(n)),e}function KI(t,e){const n={},i=l(t,["numberOfImages"]);e!==void 0&&i!=null&&u(e,["parameters","sampleCount"],i);const o=l(t,["baseSteps"]);e!==void 0&&o!=null&&u(e,["parameters","baseSteps"],o);const r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&u(e,["parameters","storageUri"],r);const s=l(t,["seed"]);e!==void 0&&s!=null&&u(e,["parameters","seed"],s);const a=l(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&u(e,["parameters","safetySetting"],a);const c=l(t,["personGeneration"]);e!==void 0&&c!=null&&u(e,["parameters","personGeneration"],c);const d=l(t,["addWatermark"]);e!==void 0&&d!=null&&u(e,["parameters","addWatermark"],d);const f=l(t,["outputMimeType"]);e!==void 0&&f!=null&&u(e,["parameters","outputOptions","mimeType"],f);const h=l(t,["outputCompressionQuality"]);e!==void 0&&h!=null&&u(e,["parameters","outputOptions","compressionQuality"],h);const p=l(t,["enhancePrompt"]);e!==void 0&&p!=null&&u(e,["parameters","enhancePrompt"],p);const m=l(t,["labels"]);return e!==void 0&&m!=null&&u(e,["labels"],m),n}function QI(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["source"]);o!=null&&ZI(o,n);const r=l(e,["config"]);return r!=null&&KI(r,n),n}function XI(t){const e={},n=l(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>al(o))),u(e,["generatedImages"],i)}return e}function ZI(t,e){const n={},i=l(t,["prompt"]);e!==void 0&&i!=null&&u(e,["instances[0]","prompt"],i);const o=l(t,["personImage"]);e!==void 0&&o!=null&&u(e,["instances[0]","personImage","image"],Ct(o));const r=l(t,["productImages"]);if(e!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>YI(a))),u(e,["instances[0]","productImages"],s)}return n}function jI(t){const e={},n=l(t,["referenceImage"]);n!=null&&u(e,["referenceImage"],Ct(n));const i=l(t,["referenceId"]);i!=null&&u(e,["referenceId"],i);const o=l(t,["referenceType"]);o!=null&&u(e,["referenceType"],o);const r=l(t,["maskImageConfig"]);r!=null&&u(e,["maskImageConfig"],$I(r));const s=l(t,["controlImageConfig"]);s!=null&&u(e,["controlImageConfig"],O0(s));const a=l(t,["styleImageConfig"]);a!=null&&u(e,["styleImageConfig"],a);const c=l(t,["subjectImageConfig"]);return c!=null&&u(e,["subjectImageConfig"],c),e}function S_(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&u(e,["categories"],n);const i=l(t,["safetyAttributes","scores"]);i!=null&&u(e,["scores"],i);const o=l(t,["contentType"]);return o!=null&&u(e,["contentType"],o),e}function I_(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&u(e,["categories"],n);const i=l(t,["safetyAttributes","scores"]);i!=null&&u(e,["scores"],i);const o=l(t,["contentType"]);return o!=null&&u(e,["contentType"],o),e}function ew(t){const e={},n=l(t,["category"]);if(n!=null&&u(e,["category"],n),l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=l(t,["threshold"]);return i!=null&&u(e,["threshold"],i),e}function tw(t){const e={},n=l(t,["image"]);return n!=null&&u(e,["image"],Ct(n)),e}function nw(t,e){const n={},i=l(t,["mode"]);e!==void 0&&i!=null&&u(e,["parameters","mode"],i);const o=l(t,["maxPredictions"]);e!==void 0&&o!=null&&u(e,["parameters","maxPredictions"],o);const r=l(t,["confidenceThreshold"]);e!==void 0&&r!=null&&u(e,["parameters","confidenceThreshold"],r);const s=l(t,["maskDilation"]);e!==void 0&&s!=null&&u(e,["parameters","maskDilation"],s);const a=l(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&u(e,["parameters","binaryColorThreshold"],a);const c=l(t,["labels"]);return e!==void 0&&c!=null&&u(e,["labels"],c),n}function iw(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["source"]);o!=null&&rw(o,n);const r=l(e,["config"]);return r!=null&&nw(r,n),n}function ow(t){const e={},n=l(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>PI(o))),u(e,["generatedMasks"],i)}return e}function rw(t,e){const n={},i=l(t,["prompt"]);e!==void 0&&i!=null&&u(e,["instances[0]","prompt"],i);const o=l(t,["image"]);e!==void 0&&o!=null&&u(e,["instances[0]","image"],Ct(o));const r=l(t,["scribbleImage"]);return e!==void 0&&r!=null&&u(e,["instances[0]","scribble"],tw(r)),n}function w_(t){const e={},n=l(t,["languageCode"]);n!=null&&u(e,["languageCode"],n);const i=l(t,["voiceConfig"]);if(i!=null&&u(e,["voiceConfig"],i),l(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function sw(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&u(e,["functionCallingConfig"],aI(n));const i=l(t,["retrievalConfig"]);return i!=null&&u(e,["retrievalConfig"],i),e}function lw(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>h)),u(e,["functionDeclarations"],f)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(t,["googleSearchRetrieval"]);i!=null&&u(e,["googleSearchRetrieval"],i);const o=l(t,["computerUse"]);o!=null&&u(e,["computerUse"],o);const r=l(t,["fileSearch"]);r!=null&&u(e,["fileSearch"],r);const s=l(t,["codeExecution"]);if(s!=null&&u(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=l(t,["googleMaps"]);a!=null&&u(e,["googleMaps"],FI(a));const c=l(t,["googleSearch"]);c!=null&&u(e,["googleSearch"],UI(c));const d=l(t,["urlContext"]);return d!=null&&u(e,["urlContext"],d),e}function A_(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>uI(p))),u(e,["functionDeclarations"],h)}const i=l(t,["retrieval"]);i!=null&&u(e,["retrieval"],i);const o=l(t,["googleSearchRetrieval"]);o!=null&&u(e,["googleSearchRetrieval"],o);const r=l(t,["computerUse"]);if(r!=null&&u(e,["computerUse"],r),l(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=l(t,["codeExecution"]);s!=null&&u(e,["codeExecution"],s);const a=l(t,["enterpriseWebSearch"]);a!=null&&u(e,["enterpriseWebSearch"],a);const c=l(t,["googleMaps"]);c!=null&&u(e,["googleMaps"],c);const d=l(t,["googleSearch"]);d!=null&&u(e,["googleSearch"],d);const f=l(t,["urlContext"]);return f!=null&&u(e,["urlContext"],f),e}function aw(t){const e={},n=l(t,["baseModel"]);n!=null&&u(e,["baseModel"],n);const i=l(t,["createTime"]);i!=null&&u(e,["createTime"],i);const o=l(t,["updateTime"]);return o!=null&&u(e,["updateTime"],o),e}function uw(t){const e={},n=l(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&u(e,["baseModel"],n);const i=l(t,["createTime"]);i!=null&&u(e,["createTime"],i);const o=l(t,["updateTime"]);return o!=null&&u(e,["updateTime"],o),e}function cw(t,e){const n={},i=l(t,["displayName"]);e!==void 0&&i!=null&&u(e,["displayName"],i);const o=l(t,["description"]);e!==void 0&&o!=null&&u(e,["description"],o);const r=l(t,["defaultCheckpointId"]);return e!==void 0&&r!=null&&u(e,["defaultCheckpointId"],r),n}function dw(t,e){const n={},i=l(t,["displayName"]);e!==void 0&&i!=null&&u(e,["displayName"],i);const o=l(t,["description"]);e!==void 0&&o!=null&&u(e,["description"],o);const r=l(t,["defaultCheckpointId"]);return e!==void 0&&r!=null&&u(e,["defaultCheckpointId"],r),n}function fw(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","name"],J(t,i));const o=l(e,["config"]);return o!=null&&cw(o,n),n}function hw(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["config"]);return o!=null&&dw(o,n),n}function pw(t,e){const n={},i=l(t,["outputGcsUri"]);e!==void 0&&i!=null&&u(e,["parameters","storageUri"],i);const o=l(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&u(e,["parameters","safetySetting"],o);const r=l(t,["personGeneration"]);e!==void 0&&r!=null&&u(e,["parameters","personGeneration"],r);const s=l(t,["includeRaiReason"]);e!==void 0&&s!=null&&u(e,["parameters","includeRaiReason"],s);const a=l(t,["outputMimeType"]);e!==void 0&&a!=null&&u(e,["parameters","outputOptions","mimeType"],a);const c=l(t,["outputCompressionQuality"]);e!==void 0&&c!=null&&u(e,["parameters","outputOptions","compressionQuality"],c);const d=l(t,["enhanceInputImage"]);e!==void 0&&d!=null&&u(e,["parameters","upscaleConfig","enhanceInputImage"],d);const f=l(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&u(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const h=l(t,["labels"]);e!==void 0&&h!=null&&u(e,["labels"],h);const p=l(t,["numberOfImages"]);e!==void 0&&p!=null&&u(e,["parameters","sampleCount"],p);const m=l(t,["mode"]);return e!==void 0&&m!=null&&u(e,["parameters","mode"],m),n}function mw(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["_url","model"],J(t,i));const o=l(e,["image"]);o!=null&&u(n,["instances[0]","image"],Ct(o));const r=l(e,["upscaleFactor"]);r!=null&&u(n,["parameters","upscaleConfig","upscaleFactor"],r);const s=l(e,["config"]);return s!=null&&pw(s,n),n}function gw(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>al(r))),u(e,["generatedImages"],o)}return e}function _w(t){const e={},n=l(t,["uri"]);n!=null&&u(e,["uri"],n);const i=l(t,["encodedVideo"]);i!=null&&u(e,["videoBytes"],Tn(i));const o=l(t,["encoding"]);return o!=null&&u(e,["mimeType"],o),e}function yw(t){const e={},n=l(t,["gcsUri"]);n!=null&&u(e,["uri"],n);const i=l(t,["bytesBase64Encoded"]);i!=null&&u(e,["videoBytes"],Tn(i));const o=l(t,["mimeType"]);return o!=null&&u(e,["mimeType"],o),e}function vw(t){const e={},n=l(t,["image"]);n!=null&&u(e,["_self"],Ct(n));const i=l(t,["maskMode"]);return i!=null&&u(e,["maskMode"],i),e}function Ew(t){const e={},n=l(t,["image"]);n!=null&&u(e,["image"],ul(n));const i=l(t,["referenceType"]);return i!=null&&u(e,["referenceType"],i),e}function Cw(t){const e={},n=l(t,["image"]);n!=null&&u(e,["image"],Ct(n));const i=l(t,["referenceType"]);return i!=null&&u(e,["referenceType"],i),e}function N_(t){const e={},n=l(t,["uri"]);n!=null&&u(e,["uri"],n);const i=l(t,["videoBytes"]);i!=null&&u(e,["encodedVideo"],Tn(i));const o=l(t,["mimeType"]);return o!=null&&u(e,["encoding"],o),e}function R_(t){const e={},n=l(t,["uri"]);n!=null&&u(e,["gcsUri"],n);const i=l(t,["videoBytes"]);i!=null&&u(e,["bytesBase64Encoded"],Tn(i));const o=l(t,["mimeType"]);return o!=null&&u(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tw(t,e){const n={},i=l(t,["displayName"]);return e!==void 0&&i!=null&&u(e,["displayName"],i),n}function Sw(t){const e={},n=l(t,["config"]);return n!=null&&Tw(n,e),e}function Iw(t,e){const n={},i=l(t,["force"]);return e!==void 0&&i!=null&&u(e,["_query","force"],i),n}function ww(t){const e={},n=l(t,["name"]);n!=null&&u(e,["_url","name"],n);const i=l(t,["config"]);return i!=null&&Iw(i,e),e}function Aw(t){const e={},n=l(t,["name"]);return n!=null&&u(e,["_url","name"],n),e}function Nw(t,e){const n={},i=l(t,["customMetadata"]);if(e!==void 0&&i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>s)),u(e,["customMetadata"],r)}const o=l(t,["chunkingConfig"]);return e!==void 0&&o!=null&&u(e,["chunkingConfig"],o),n}function Rw(t){const e={},n=l(t,["name"]);n!=null&&u(e,["name"],n);const i=l(t,["metadata"]);i!=null&&u(e,["metadata"],i);const o=l(t,["done"]);o!=null&&u(e,["done"],o);const r=l(t,["error"]);r!=null&&u(e,["error"],r);const s=l(t,["response"]);return s!=null&&u(e,["response"],xw(s)),e}function Pw(t){const e={},n=l(t,["fileSearchStoreName"]);n!=null&&u(e,["_url","file_search_store_name"],n);const i=l(t,["fileName"]);i!=null&&u(e,["fileName"],i);const o=l(t,["config"]);return o!=null&&Nw(o,e),e}function xw(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["parent"]);i!=null&&u(e,["parent"],i);const o=l(t,["documentName"]);return o!=null&&u(e,["documentName"],o),e}function kw(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&u(e,["_query","pageSize"],i);const o=l(t,["pageToken"]);return e!==void 0&&o!=null&&u(e,["_query","pageToken"],o),n}function Mw(t){const e={},n=l(t,["config"]);return n!=null&&kw(n,e),e}function Dw(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&u(e,["nextPageToken"],i);const o=l(t,["fileSearchStores"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(s=>s)),u(e,["fileSearchStores"],r)}return e}function P_(t,e){const n={},i=l(t,["mimeType"]);e!==void 0&&i!=null&&u(e,["mimeType"],i);const o=l(t,["displayName"]);e!==void 0&&o!=null&&u(e,["displayName"],o);const r=l(t,["customMetadata"]);if(e!==void 0&&r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>c)),u(e,["customMetadata"],a)}const s=l(t,["chunkingConfig"]);return e!==void 0&&s!=null&&u(e,["chunkingConfig"],s),n}function Lw(t){const e={},n=l(t,["fileSearchStoreName"]);n!=null&&u(e,["_url","file_search_store_name"],n);const i=l(t,["config"]);return i!=null&&P_(i,e),e}function Fw(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Uw="Content-Type",Vw="X-Server-Timeout",Gw="User-Agent",lu="x-goog-api-client",Ow="1.31.0",Hw=`google-genai-sdk/${Ow}`,Bw="v1beta1",qw="v1beta",Wh=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class bw{constructor(e){var n,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Bw,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:qw,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,i){const o=[this.getRequestUrlInternal(n)];return i&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,n,i);if(e.queryParams)for(const[s,a]of Object.entries(e.queryParams))o.searchParams.append(s,String(a));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,n,o.toString(),e.abortSignal),this.unaryApiCall(o,r,e.httpMethod)}patchHttpOptions(e,n){const i=JSON.parse(JSON.stringify(e));for(const[o,r]of Object.entries(n))typeof r=="object"?i[o]=Object.assign(Object.assign({},i[o]),r):r!==void 0&&(i[o]=r);return i}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,n,i);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,n,o.toString(),e.abortSignal),this.streamApiCall(o,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,i,o){if(n&&n.timeout||o){const r=new AbortController,s=r.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>r.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}o&&o.addEventListener("abort",()=>{r.abort()}),e.signal=s}return n&&n.extraBody!==null&&zw(e,n.extraBody),e.headers=await this.getHeadersInternal(n,i),e}async unaryApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async o=>(await $h(o),new nu(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async o=>(await $h(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){var n;return Ci(this,arguments,function*(){const o=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),r=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let s="";for(;;){const{done:a,value:c}=yield oe(o.read());if(a){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=r.decode(c,{stream:!0});try{const h=JSON.parse(d);if("error"in h){const p=JSON.parse(JSON.stringify(h.error)),m=p.status,v=p.code,E=`got status: ${m}. ${JSON.stringify(h)}`;if(v>=400&&v<600)throw new sl({message:E,status:v})}}catch(h){if(h.name==="ApiError")throw h}s+=d;let f=s.match(Wh);for(;f;){const h=f[1];try{const p=new Response(h,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield oe(new nu(p)),s=s.slice(f[0].length),f=s.match(Wh)}catch(p){throw new Error(`exception parsing stream chunk ${h}. ${p}`)}}}}finally{o.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},n=Hw+" "+this.clientOptions.userAgentExtra;return e[Gw]=n,e[lu]=n,e[Uw]="application/json",e}async getHeadersInternal(e,n){const i=new Headers;if(e&&e.headers){for(const[o,r]of Object.entries(e.headers))i.append(o,r);e.timeout&&e.timeout>0&&i.append(Vw,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,n),i}getFileName(e){var n;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(n=i.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),i}async uploadFile(e,n){var i;const o={};n!=null&&(o.mimeType=n.mimeType,o.name=n.name,o.displayName=n.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const r=this.clientOptions.uploader,s=await r.stat(e);o.sizeBytes=String(s.size);const a=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:s.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=a;const c={file:o},d=this.getFileName(e),f=M("upload/v1beta/files",c._url),h=await this.fetchUploadUrl(f,o.sizeBytes,o.mimeType,d,c,n==null?void 0:n.httpOptions);return r.upload(e,h,this)}async uploadFileToFileSearchStore(e,n,i){var o;const r=this.clientOptions.uploader,s=await r.stat(n),a=String(s.size),c=(o=i==null?void 0:i.mimeType)!==null&&o!==void 0?o:s.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const d=`upload/v1beta/${e}:uploadToFileSearchStore`,f=this.getFileName(n),h={};i!=null&&P_(i,h);const p=await this.fetchUploadUrl(d,a,c,f,h,i==null?void 0:i.httpOptions);return r.uploadToFileSearchStore(n,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,i,o,r,s){var a;let c={};s?c=s:c={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${i}`},o?{"X-Goog-Upload-File-Name":o}:{})};const d=await this.request({path:e,body:JSON.stringify(r),httpMethod:"POST",httpOptions:c});if(!d||!(d!=null&&d.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(a=d==null?void 0:d.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function $h(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let i;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await t.json():i={error:{message:await t.text(),code:t.status,status:t.statusText}};const o=JSON.stringify(i);throw n>=400&&n<600?new sl({message:o,status:n}):new Error(o)}}function zw(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const r=JSON.parse(t.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))n=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(r,s){const a=Object.assign({},r);for(const c in s)if(Object.prototype.hasOwnProperty.call(s,c)){const d=s[c],f=a[c];d&&typeof d=="object"&&!Array.isArray(d)&&f&&typeof f=="object"&&!Array.isArray(f)?a[c]=i(f,d):(f&&d&&typeof f!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof f}, New type: ${typeof d}. Overwriting.`),a[c]=d)}return a}const o=i(n,e);t.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ww="mcp_used/unknown";let $w=!1;function x_(t){for(const e of t)if(Jw(e)||typeof e=="object"&&"inputSchema"in e)return!0;return $w}function k_(t){var e;const n=(e=t[lu])!==null&&e!==void 0?e:"";t[lu]=(n+` ${Ww}`).trimStart()}function Jw(t){return t!==null&&typeof t=="object"&&t instanceof Dc}function Yw(t,e=100){return Ci(this,arguments,function*(){let i,o=0;for(;o<e;){const r=yield oe(t.listTools({cursor:i}));for(const s of r.tools)yield yield oe(s),o++;if(!r.nextCursor)break;i=r.nextCursor}})}class Dc{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Dc(e,n)}async initialize(){var e,n,i,o;if(this.mcpTools.length>0)return;const r={},s=[];for(const f of this.mcpClients)try{for(var a=!0,c=(n=void 0,Io(Yw(f))),d;d=await c.next(),e=d.done,!e;a=!0){o=d.value,a=!1;const h=o;s.push(h);const p=h.name;if(r[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);r[p]=f}}catch(h){n={error:h}}finally{try{!a&&!e&&(i=c.return)&&await i.call(c)}finally{if(n)throw n.error}}this.mcpTools=s,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),AT(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[i.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const s=await o.callTool({name:i.name,arguments:i.args},void 0,r);n.push({functionResponse:{name:i.name,response:s.isError?{error:s}:s}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Kw(t,e,n){const i=new yT;let o;n.data instanceof Blob?o=JSON.parse(await n.data.text()):o=JSON.parse(n.data),Object.assign(i,o),e(i)}class Qw{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i}async connect(e){var n,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),s=jw(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),c=`${o}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${a}`;let d=()=>{};const f=new Promise(y=>{d=y}),h=e.callbacks,p=function(){d({})},m=this.apiClient,v={onopen:p,onmessage:y=>{Kw(m,h.onmessage,y)},onerror:(n=h==null?void 0:h.onerror)!==null&&n!==void 0?n:function(y){},onclose:(i=h==null?void 0:h.onclose)!==null&&i!==void 0?i:function(y){}},E=this.webSocketFactory.create(c,Zw(s),v);E.connect(),await f;const g={setup:{model:J(this.apiClient,e.model)}};return E.send(JSON.stringify(g)),new Xw(E,this.apiClient)}}class Xw{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=S0(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=T0(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(di.PLAY)}pause(){this.sendPlaybackControl(di.PAUSE)}stop(){this.sendPlaybackControl(di.STOP)}resetContext(){this.sendPlaybackControl(di.RESET_CONTEXT)}close(){this.conn.close()}}function Zw(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function jw(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eA="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function tA(t,e,n){const i=new _T;let o;n.data instanceof Blob?o=await n.data.text():n.data instanceof ArrayBuffer?o=new TextDecoder().decode(n.data):o=n.data;const r=JSON.parse(o);if(t.isVertexAI()){const s=A0(r);Object.assign(i,s)}else Object.assign(i,r);e(i)}class nA{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i,this.music=new Qw(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,i,o,r,s,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const h=this.apiClient.getHeaders();e.config&&e.config.tools&&x_(e.config.tools)&&k_(h);const p=sA(h);if(this.apiClient.isVertexAI())f=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,f);else{const w=this.apiClient.getApiKey();let P="BidiGenerateContent",F="key";w!=null&&w.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),P="BidiGenerateContentConstrained",F="access_token"),f=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.${P}?${F}=${w}`}let m=()=>{};const v=new Promise(w=>{m=w}),E=e.callbacks,S=function(){var w;(w=E==null?void 0:E.onopen)===null||w===void 0||w.call(E),m({})},_=this.apiClient,g={onopen:S,onmessage:w=>{tA(_,E.onmessage,w)},onerror:(n=E==null?void 0:E.onerror)!==null&&n!==void 0?n:function(w){},onclose:(i=E==null?void 0:E.onclose)!==null&&i!==void 0?i:function(w){}},y=this.webSocketFactory.create(f,rA(p),g);y.connect(),await v;let C=J(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&C.startsWith("publishers/")){const w=this.apiClient.getProject(),P=this.apiClient.getLocation();C=`projects/${w}/locations/${P}/`+C}let I={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Ss.AUDIO]}:e.config.responseModalities=[Ss.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const A=(a=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[],N=[];for(const w of A)if(this.isCallableTool(w)){const P=w;N.push(await P.tool())}else N.push(w);N.length>0&&(e.config.tools=N);const k={model:C,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?I=C0(this.apiClient,k):I=E0(this.apiClient,k),delete I.config,y.send(JSON.stringify(I)),new oA(y,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const iA={turnComplete:!0};class oA{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let i=[];try{i=at(n.turns),e.isVertexAI()||(i=i.map(o=>ll(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:i,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let i=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?i=n.functionResponses:i=[n.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const r of i){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(eA)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},iA),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:w0(e)}:n={realtimeInput:I0(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function rA(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function sA(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Jh=10;function Yh(t){var e,n,i;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const s of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Ti(s)){o=!0;break}if(!o)return!0;const r=(i=t==null?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function Ti(t){return"callTool"in t&&typeof t.callTool=="function"}function lA(t){var e,n,i;return(i=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(o=>Ti(o)))!==null&&i!==void 0?i:!1}function Kh(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((i,o)=>{if(Ti(i))return;const r=i;r.functionDeclarations&&r.functionDeclarations.length>0&&n.push(o)}),n}function Qh(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aA extends Jt{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var i,o,r,s,a;const c=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!lA(n)||Yh(n.config))return await this.generateContentInternal(c);const d=Kh(n);if(d.length>0){const E=d.map(S=>`tools[${S}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${E}.`)}let f,h;const p=at(c.contents),m=(r=(o=(i=c.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&r!==void 0?r:Jh;let v=0;for(;v<m&&(f=await this.generateContentInternal(c),!(!f.functionCalls||f.functionCalls.length===0));){const E=f.candidates[0].content,S=[];for(const _ of(a=(s=n.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[])if(Ti(_)){const y=await _.callTool(f.functionCalls);S.push(...y)}v++,h={role:"user",parts:S},c.contents=at(c.contents),c.contents.push(E),c.contents.push(h),Qh(c.config)&&(p.push(E),p.push(h))}return Qh(c.config)&&(f.automaticFunctionCallingHistory=p),f},this.generateContentStream=async n=>{var i,o,r,s,a;if(this.maybeMoveToResponseJsonSchem(n),Yh(n.config)){const h=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(h)}const c=Kh(n);if(c.length>0){const h=c.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const d=(r=(o=(i=n==null?void 0:n.config)===null||i===void 0?void 0:i.toolConfig)===null||o===void 0?void 0:o.functionCallingConfig)===null||r===void 0?void 0:r.streamFunctionCallArguments,f=(a=(s=n==null?void 0:n.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(d&&!f)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(i=>{var o;let r;const s=[];if(i!=null&&i.generatedImages)for(const c of i.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((o=c==null?void 0:c.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?r=c==null?void 0:c.safetyAttributes:s.push(c);let a;return r?a={generatedImages:s,positivePromptSafetyAttributes:r,sdkHttpResponse:i.sdkHttpResponse}:a={generatedImages:s,sdkHttpResponse:i.sdkHttpResponse},a}),this.list=async n=>{var i;const s={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((i=s.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new Jn(qt.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(s),s)},this.editImage=async n=>{const i={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(i.referenceImages=n.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async n=>{let i={numberOfImages:1,mode:"upscale"};n.config&&(i=Object.assign(Object.assign({},i),n.config));const o={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:i};return await this.upscaleImageInternal(o)},this.generateVideos=async n=>{var i,o,r,s,a,c;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=n.video)===null||i===void 0)&&i.uri&&(!((o=n.video)===null||o===void 0)&&o.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((s=(r=n.source)===null||r===void 0?void 0:r.video)===null||s===void 0)&&s.uri&&(!((c=(a=n.source)===null||a===void 0?void 0:a.video)===null||c===void 0)&&c.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,i,o;const r=(n=e.config)===null||n===void 0?void 0:n.tools;if(!r)return e;const s=await Promise.all(r.map(async c=>Ti(c)?await c.tool():c)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(a.config.tools=s,e.config&&e.config.tools&&x_(e.config.tools)){const c=(o=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&o!==void 0?o:{};let d=Object.assign({},c);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),k_(d),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return a}async initAfcToolsMap(e){var n,i,o;const r=new Map;for(const s of(i=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&i!==void 0?i:[])if(Ti(s)){const a=s,c=await a.tool();for(const d of(o=c.functionDeclarations)!==null&&o!==void 0?o:[]){if(!d.name)throw new Error("Function declaration name is required.");if(r.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);r.set(d.name,a)}}return r}async processAfcStream(e){var n,i,o;const r=(o=(i=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:Jh;let s=!1,a=0;const c=await this.initAfcToolsMap(e);return function(d,f,h){var p,m;return Ci(this,arguments,function*(){for(var v,E,S,_;a<r;){s&&(a++,s=!1);const I=yield oe(d.processParamsMaybeAddMcpUsage(h)),A=yield oe(d.generateContentStreamInternal(I)),N=[],k=[];try{for(var g=!0,y=(E=void 0,Io(A)),C;C=yield oe(y.next()),v=C.done,!v;g=!0){_=C.value,g=!1;const w=_;if(yield yield oe(w),w.candidates&&(!((p=w.candidates[0])===null||p===void 0)&&p.content)){k.push(w.candidates[0].content);for(const P of(m=w.candidates[0].content.parts)!==null&&m!==void 0?m:[])if(a<r&&P.functionCall){if(!P.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(P.functionCall.name)){const F=yield oe(f.get(P.functionCall.name).callTool([P.functionCall]));N.push(...F)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${P.functionCall.name}`)}}}}catch(w){E={error:w}}finally{try{!g&&!v&&(S=y.return)&&(yield oe(S.call(y)))}finally{if(E)throw E.error}}if(N.length>0){s=!0;const w=new ro;w.candidates=[{content:{role:"user",parts:N}}],yield yield oe(w);const P=[];P.push(...k),P.push({role:"user",parts:N});const F=at(h.contents).concat(P);h.contents=F}else break}})}(this,c,e)}async generateContentInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=qh(this.apiClient,e);return a=M("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=zh(f),p=new ro;return Object.assign(p,h),p})}else{const d=Bh(this.apiClient,e);return a=M("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=bh(f),p=new ro;return Object.assign(p,h),p})}}async generateContentStreamInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=qh(this.apiClient,e);return a=M("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),s.then(function(h){return Ci(this,arguments,function*(){var p,m,v,E;try{for(var S=!0,_=Io(h),g;g=yield oe(_.next()),p=g.done,!p;S=!0){E=g.value,S=!1;const y=E,C=zh(yield oe(y.json()));C.sdkHttpResponse={headers:y.headers};const I=new ro;Object.assign(I,C),yield yield oe(I)}}catch(y){m={error:y}}finally{try{!S&&!p&&(v=_.return)&&(yield oe(v.call(_)))}finally{if(m)throw m.error}}})})}else{const d=Bh(this.apiClient,e);return a=M("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),s.then(function(h){return Ci(this,arguments,function*(){var p,m,v,E;try{for(var S=!0,_=Io(h),g;g=yield oe(_.next()),p=g.done,!p;S=!0){E=g.value,S=!1;const y=E,C=bh(yield oe(y.json()));C.sdkHttpResponse={headers:y.headers};const I=new ro;Object.assign(I,C),yield yield oe(I)}}catch(y){m={error:y}}finally{try{!S&&!p&&(v=_.return)&&(yield oe(v.call(_)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=nI(this.apiClient,e);return a=M("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=oI(f),p=new Ih;return Object.assign(p,h),p})}else{const d=tI(this.apiClient,e);return a=M("{model}:batchEmbedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=iI(f),p=new Ih;return Object.assign(p,h),p})}}async generateImagesInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=mI(this.apiClient,e);return a=M("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=_I(f),p=new wh;return Object.assign(p,h),p})}else{const d=pI(this.apiClient,e);return a=M("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=gI(f),p=new wh;return Object.assign(p,h),p})}}async editImageInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI()){const a=X0(this.apiClient,e);return r=M("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),o.then(c=>{const d=Z0(c),f=new sT;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI()){const a=mw(this.apiClient,e);return r=M("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),o.then(c=>{const d=gw(c),f=new lT;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI()){const a=QI(this.apiClient,e);return r=M("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>{const d=XI(c),f=new aT;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI()){const a=iw(this.apiClient,e);return r=M("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>{const d=ow(c),f=new uT;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=LI(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>su(f))}else{const d=DI(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>ru(f))}}async listInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=bI(this.apiClient,e);return a=M("{models_url}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=WI(f),p=new Ah;return Object.assign(p,h),p})}else{const d=qI(this.apiClient,e);return a=M("{models_url}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=zI(f),p=new Ah;return Object.assign(p,h),p})}}async update(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=hw(this.apiClient,e);return a=M("{model}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>su(f))}else{const d=fw(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>ru(f))}}async delete(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=J0(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=K0(f),p=new Nh;return Object.assign(p,h),p})}else{const d=$0(this.apiClient,e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=Y0(f),p=new Nh;return Object.assign(p,h),p})}}async countTokens(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=b0(this.apiClient,e);return a=M("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=W0(f),p=new Rh;return Object.assign(p,h),p})}else{const d=q0(this.apiClient,e);return a=M("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=z0(f),p=new Rh;return Object.assign(p,h),p})}}async computeTokens(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI()){const a=F0(this.apiClient,e);return r=M("{model}:computeTokens",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),o.then(c=>{const d=U0(c),f=new cT;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=SI(this.apiClient,e);return a=M("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const h=CI(f),p=new Is;return Object.assign(p,h),p})}else{const d=TI(this.apiClient,e);return a=M("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>{const h=EI(f),p=new Is;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uA extends Jt{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,i=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=n.name.split("/operations/")[0];let r;i&&"httpOptions"in i&&(r=i.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:r}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async get(e){const n=e.operation,i=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=n.name.split("/operations/")[0];let r;i&&"httpOptions"in i&&(r=i.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:r}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=eT(e);return a=M("{operationName}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s}else{const d=jC(e);return a=M("{operationName}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s}}async fetchPredictVideosOperationInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI()){const a=$C(e);return r=M("{resourceName}:fetchPredictOperation",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cA(t){const e={},n=l(t,["data"]);if(n!=null&&u(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function dA(t){const e={},n=l(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>EA(r))),u(e,["parts"],o)}const i=l(t,["role"]);return i!=null&&u(e,["role"],i),e}function fA(t,e,n){const i={},o=l(e,["expireTime"]);n!==void 0&&o!=null&&u(n,["expireTime"],o);const r=l(e,["newSessionExpireTime"]);n!==void 0&&r!=null&&u(n,["newSessionExpireTime"],r);const s=l(e,["uses"]);n!==void 0&&s!=null&&u(n,["uses"],s);const a=l(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&u(n,["bidiGenerateContentSetup"],vA(t,a));const c=l(e,["lockAdditionalFields"]);return n!==void 0&&c!=null&&u(n,["fieldMask"],c),i}function hA(t,e){const n={},i=l(e,["config"]);return i!=null&&u(n,["config"],fA(t,i,n)),n}function pA(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&u(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function mA(t){const e={},n=l(t,["id"]);n!=null&&u(e,["id"],n);const i=l(t,["args"]);i!=null&&u(e,["args"],i);const o=l(t,["name"]);if(o!=null&&u(e,["name"],o),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function gA(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&u(e,["enableWidget"],n),e}function _A(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&u(e,["timeRangeFilter"],n),e}function yA(t,e){const n={},i=l(t,["generationConfig"]);e!==void 0&&i!=null&&u(e,["setup","generationConfig"],i);const o=l(t,["responseModalities"]);e!==void 0&&o!=null&&u(e,["setup","generationConfig","responseModalities"],o);const r=l(t,["temperature"]);e!==void 0&&r!=null&&u(e,["setup","generationConfig","temperature"],r);const s=l(t,["topP"]);e!==void 0&&s!=null&&u(e,["setup","generationConfig","topP"],s);const a=l(t,["topK"]);e!==void 0&&a!=null&&u(e,["setup","generationConfig","topK"],a);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&u(e,["setup","generationConfig","maxOutputTokens"],c);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&u(e,["setup","generationConfig","mediaResolution"],d);const f=l(t,["seed"]);e!==void 0&&f!=null&&u(e,["setup","generationConfig","seed"],f);const h=l(t,["speechConfig"]);e!==void 0&&h!=null&&u(e,["setup","generationConfig","speechConfig"],Mc(h));const p=l(t,["thinkingConfig"]);e!==void 0&&p!=null&&u(e,["setup","generationConfig","thinkingConfig"],p);const m=l(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&u(e,["setup","generationConfig","enableAffectiveDialog"],m);const v=l(t,["systemInstruction"]);e!==void 0&&v!=null&&u(e,["setup","systemInstruction"],dA(Ue(v)));const E=l(t,["tools"]);if(e!==void 0&&E!=null){let A=Wi(E);Array.isArray(A)&&(A=A.map(N=>TA(zi(N)))),u(e,["setup","tools"],A)}const S=l(t,["sessionResumption"]);e!==void 0&&S!=null&&u(e,["setup","sessionResumption"],CA(S));const _=l(t,["inputAudioTranscription"]);e!==void 0&&_!=null&&u(e,["setup","inputAudioTranscription"],_);const g=l(t,["outputAudioTranscription"]);e!==void 0&&g!=null&&u(e,["setup","outputAudioTranscription"],g);const y=l(t,["realtimeInputConfig"]);e!==void 0&&y!=null&&u(e,["setup","realtimeInputConfig"],y);const C=l(t,["contextWindowCompression"]);e!==void 0&&C!=null&&u(e,["setup","contextWindowCompression"],C);const I=l(t,["proactivity"]);return e!==void 0&&I!=null&&u(e,["setup","proactivity"],I),n}function vA(t,e){const n={},i=l(e,["model"]);i!=null&&u(n,["setup","model"],J(t,i));const o=l(e,["config"]);return o!=null&&u(n,["config"],yA(o,n)),n}function EA(t){const e={},n=l(t,["mediaResolution"]);n!=null&&u(e,["mediaResolution"],n);const i=l(t,["codeExecutionResult"]);i!=null&&u(e,["codeExecutionResult"],i);const o=l(t,["executableCode"]);o!=null&&u(e,["executableCode"],o);const r=l(t,["fileData"]);r!=null&&u(e,["fileData"],pA(r));const s=l(t,["functionCall"]);s!=null&&u(e,["functionCall"],mA(s));const a=l(t,["functionResponse"]);a!=null&&u(e,["functionResponse"],a);const c=l(t,["inlineData"]);c!=null&&u(e,["inlineData"],cA(c));const d=l(t,["text"]);d!=null&&u(e,["text"],d);const f=l(t,["thought"]);f!=null&&u(e,["thought"],f);const h=l(t,["thoughtSignature"]);h!=null&&u(e,["thoughtSignature"],h);const p=l(t,["videoMetadata"]);return p!=null&&u(e,["videoMetadata"],p),e}function CA(t){const e={},n=l(t,["handle"]);if(n!=null&&u(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function TA(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>h)),u(e,["functionDeclarations"],f)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(t,["googleSearchRetrieval"]);i!=null&&u(e,["googleSearchRetrieval"],i);const o=l(t,["computerUse"]);o!=null&&u(e,["computerUse"],o);const r=l(t,["fileSearch"]);r!=null&&u(e,["fileSearch"],r);const s=l(t,["codeExecution"]);if(s!=null&&u(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=l(t,["googleMaps"]);a!=null&&u(e,["googleMaps"],gA(a));const c=l(t,["googleSearch"]);c!=null&&u(e,["googleSearch"],_A(c));const d=l(t,["urlContext"]);return d!=null&&u(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SA(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const o=Object.keys(i).map(r=>`${n}.${r}`);e.push(...o)}else e.push(n)}return e.join(",")}function IA(t,e){let n=null;const i=t.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const r=i.setup;typeof r=="object"&&r!==null?(t.bidiGenerateContentSetup=r,n=r):delete t.bidiGenerateContentSetup}else i!==void 0&&delete t.bidiGenerateContentSetup;const o=t.fieldMask;if(n){const r=SA(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)r?t.fieldMask=r:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];o.length>0&&(a=o.map(d=>s.includes(d)?`generationConfig.${d}`:d));const c=[];r&&c.push(r),a.length>0&&c.push(...a),c.length>0?t.fieldMask=c.join(","):delete t.fieldMask}else delete t.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?t.fieldMask=o.join(","):delete t.fieldMask;return t}class wA extends Jt{constructor(e){super(),this.apiClient=e}async create(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=hA(this.apiClient,e);r=M("auth_tokens",a._url),s=a._query,delete a.config,delete a._url,delete a._query;const c=IA(a,e.config);return o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>d)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AA(t,e){const n={},i=l(t,["force"]);return e!==void 0&&i!=null&&u(e,["_query","force"],i),n}function NA(t){const e={},n=l(t,["name"]);n!=null&&u(e,["_url","name"],n);const i=l(t,["config"]);return i!=null&&AA(i,e),e}function RA(t){const e={},n=l(t,["name"]);return n!=null&&u(e,["_url","name"],n),e}function PA(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&u(e,["_query","pageSize"],i);const o=l(t,["pageToken"]);return e!==void 0&&o!=null&&u(e,["_query","pageToken"],o),n}function xA(t){const e={},n=l(t,["parent"]);n!=null&&u(e,["_url","parent"],n);const i=l(t,["config"]);return i!=null&&PA(i,e),e}function kA(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&u(e,["nextPageToken"],i);const o=l(t,["documents"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(s=>s)),u(e,["documents"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MA extends Jt{constructor(e){super(),this.apiClient=e,this.list=async n=>new Jn(qt.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:n.parent,config:i.config}),await this.listInternal(n),n)}async get(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=RA(e);return r=M("{name}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>c)}}async delete(e){var n,i;let o="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=NA(e);o=M("{name}",s._url),r=s._query,delete s._url,delete s._query,await this.apiClient.request({path:o,queryParams:r,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=xA(e);return r=M("{parent}/documents",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>{const d=kA(c),f=new dT;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DA extends Jt{constructor(e,n=new MA(e)){super(),this.apiClient=e,this.documents=n,this.list=async(i={})=>new Jn(qt.PAGED_ITEM_FILE_SEARCH_STORES,o=>this.listInternal(o),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Sw(e);return r=M("fileSearchStores",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>c)}}async get(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Aw(e);return r=M("{name}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>c)}}async delete(e){var n,i;let o="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=ww(e);o=M("{name}",s._url),r=s._query,delete s._url,delete s._query,await this.apiClient.request({path:o,queryParams:r,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Mw(e);return r=M("fileSearchStores",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>{const d=Dw(c),f=new fT;return Object.assign(f,d),f})}}async uploadToFileSearchStoreInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Lw(e);return r=M("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>{const d=Fw(c),f=new hT;return Object.assign(f,d),f})}}async importFile(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Pw(e);return r=M("{file_search_store_name}:importFile",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>{const d=Rw(c),f=new Nc;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LA(t,e){const n={},i=l(t,["name"]);return i!=null&&u(n,["_url","name"],i),n}function FA(t,e){const n={},i=l(t,["name"]);return i!=null&&u(n,["_url","name"],i),n}function UA(t,e){const n={},i=l(t,["sdkHttpResponse"]);return i!=null&&u(n,["sdkHttpResponse"],i),n}function VA(t,e){const n={},i=l(t,["sdkHttpResponse"]);return i!=null&&u(n,["sdkHttpResponse"],i),n}function GA(t,e,n){const i={};if(l(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const o=l(t,["tunedModelDisplayName"]);if(e!==void 0&&o!=null&&u(e,["displayName"],o),l(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=l(t,["epochCount"]);e!==void 0&&r!=null&&u(e,["tuningTask","hyperparameters","epochCount"],r);const s=l(t,["learningRateMultiplier"]);if(s!=null&&u(i,["tuningTask","hyperparameters","learningRateMultiplier"],s),l(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(l(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(l(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=l(t,["batchSize"]);e!==void 0&&a!=null&&u(e,["tuningTask","hyperparameters","batchSize"],a);const c=l(t,["learningRate"]);if(e!==void 0&&c!=null&&u(e,["tuningTask","hyperparameters","learningRate"],c),l(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(l(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function OA(t,e,n){const i={};let o=l(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const m=l(t,["validationDataset"]);e!==void 0&&m!=null&&u(e,["supervisedTuningSpec"],Xh(m))}else if(o==="PREFERENCE_TUNING"){const m=l(t,["validationDataset"]);e!==void 0&&m!=null&&u(e,["preferenceOptimizationSpec"],Xh(m))}const r=l(t,["tunedModelDisplayName"]);e!==void 0&&r!=null&&u(e,["tunedModelDisplayName"],r);const s=l(t,["description"]);e!==void 0&&s!=null&&u(e,["description"],s);let a=l(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const m=l(t,["epochCount"]);e!==void 0&&m!=null&&u(e,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(a==="PREFERENCE_TUNING"){const m=l(t,["epochCount"]);e!==void 0&&m!=null&&u(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let c=l(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const m=l(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&u(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(c==="PREFERENCE_TUNING"){const m=l(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&u(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let d=l(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const m=l(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&u(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(d==="PREFERENCE_TUNING"){const m=l(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&u(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let f=l(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const m=l(t,["adapterSize"]);e!==void 0&&m!=null&&u(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(f==="PREFERENCE_TUNING"){const m=l(t,["adapterSize"]);e!==void 0&&m!=null&&u(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(l(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(l(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=l(t,["labels"]);e!==void 0&&h!=null&&u(e,["labels"],h);const p=l(t,["beta"]);return e!==void 0&&p!=null&&u(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),i}function HA(t,e){const n={},i=l(t,["baseModel"]);i!=null&&u(n,["baseModel"],i);const o=l(t,["preTunedModel"]);o!=null&&u(n,["preTunedModel"],o);const r=l(t,["trainingDataset"]);r!=null&&XA(r);const s=l(t,["config"]);return s!=null&&GA(s,n),n}function BA(t,e){const n={},i=l(t,["baseModel"]);i!=null&&u(n,["baseModel"],i);const o=l(t,["preTunedModel"]);o!=null&&u(n,["preTunedModel"],o);const r=l(t,["trainingDataset"]);r!=null&&ZA(r,n,e);const s=l(t,["config"]);return s!=null&&OA(s,n,e),n}function qA(t,e){const n={},i=l(t,["name"]);return i!=null&&u(n,["_url","name"],i),n}function bA(t,e){const n={},i=l(t,["name"]);return i!=null&&u(n,["_url","name"],i),n}function zA(t,e,n){const i={},o=l(t,["pageSize"]);e!==void 0&&o!=null&&u(e,["_query","pageSize"],o);const r=l(t,["pageToken"]);e!==void 0&&r!=null&&u(e,["_query","pageToken"],r);const s=l(t,["filter"]);return e!==void 0&&s!=null&&u(e,["_query","filter"],s),i}function WA(t,e,n){const i={},o=l(t,["pageSize"]);e!==void 0&&o!=null&&u(e,["_query","pageSize"],o);const r=l(t,["pageToken"]);e!==void 0&&r!=null&&u(e,["_query","pageToken"],r);const s=l(t,["filter"]);return e!==void 0&&s!=null&&u(e,["_query","filter"],s),i}function $A(t,e){const n={},i=l(t,["config"]);return i!=null&&zA(i,n),n}function JA(t,e){const n={},i=l(t,["config"]);return i!=null&&WA(i,n),n}function YA(t,e){const n={},i=l(t,["sdkHttpResponse"]);i!=null&&u(n,["sdkHttpResponse"],i);const o=l(t,["nextPageToken"]);o!=null&&u(n,["nextPageToken"],o);const r=l(t,["tunedModels"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>M_(a))),u(n,["tuningJobs"],s)}return n}function KA(t,e){const n={},i=l(t,["sdkHttpResponse"]);i!=null&&u(n,["sdkHttpResponse"],i);const o=l(t,["nextPageToken"]);o!=null&&u(n,["nextPageToken"],o);const r=l(t,["tuningJobs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>au(a))),u(n,["tuningJobs"],s)}return n}function QA(t,e){const n={},i=l(t,["name"]);i!=null&&u(n,["model"],i);const o=l(t,["name"]);return o!=null&&u(n,["endpoint"],o),n}function XA(t,e){const n={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=l(t,["examples"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>r)),u(n,["examples","examples"],o)}return n}function ZA(t,e,n){const i={};let o=l(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const s=l(t,["gcsUri"]);e!==void 0&&s!=null&&u(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(o==="PREFERENCE_TUNING"){const s=l(t,["gcsUri"]);e!==void 0&&s!=null&&u(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}let r=l(n,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const s=l(t,["vertexDatasetResource"]);e!==void 0&&s!=null&&u(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(r==="PREFERENCE_TUNING"){const s=l(t,["vertexDatasetResource"]);e!==void 0&&s!=null&&u(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}if(l(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function M_(t,e){const n={},i=l(t,["sdkHttpResponse"]);i!=null&&u(n,["sdkHttpResponse"],i);const o=l(t,["name"]);o!=null&&u(n,["name"],o);const r=l(t,["state"]);r!=null&&u(n,["state"],f_(r));const s=l(t,["createTime"]);s!=null&&u(n,["createTime"],s);const a=l(t,["tuningTask","startTime"]);a!=null&&u(n,["startTime"],a);const c=l(t,["tuningTask","completeTime"]);c!=null&&u(n,["endTime"],c);const d=l(t,["updateTime"]);d!=null&&u(n,["updateTime"],d);const f=l(t,["description"]);f!=null&&u(n,["description"],f);const h=l(t,["baseModel"]);h!=null&&u(n,["baseModel"],h);const p=l(t,["_self"]);return p!=null&&u(n,["tunedModel"],QA(p)),n}function au(t,e){const n={},i=l(t,["sdkHttpResponse"]);i!=null&&u(n,["sdkHttpResponse"],i);const o=l(t,["name"]);o!=null&&u(n,["name"],o);const r=l(t,["state"]);r!=null&&u(n,["state"],f_(r));const s=l(t,["createTime"]);s!=null&&u(n,["createTime"],s);const a=l(t,["startTime"]);a!=null&&u(n,["startTime"],a);const c=l(t,["endTime"]);c!=null&&u(n,["endTime"],c);const d=l(t,["updateTime"]);d!=null&&u(n,["updateTime"],d);const f=l(t,["error"]);f!=null&&u(n,["error"],f);const h=l(t,["description"]);h!=null&&u(n,["description"],h);const p=l(t,["baseModel"]);p!=null&&u(n,["baseModel"],p);const m=l(t,["tunedModel"]);m!=null&&u(n,["tunedModel"],m);const v=l(t,["preTunedModel"]);v!=null&&u(n,["preTunedModel"],v);const E=l(t,["supervisedTuningSpec"]);E!=null&&u(n,["supervisedTuningSpec"],E);const S=l(t,["preferenceOptimizationSpec"]);S!=null&&u(n,["preferenceOptimizationSpec"],S);const _=l(t,["tuningDataStats"]);_!=null&&u(n,["tuningDataStats"],_);const g=l(t,["encryptionSpec"]);g!=null&&u(n,["encryptionSpec"],g);const y=l(t,["partnerModelTuningSpec"]);y!=null&&u(n,["partnerModelTuningSpec"],y);const C=l(t,["customBaseModel"]);C!=null&&u(n,["customBaseModel"],C);const I=l(t,["experiment"]);I!=null&&u(n,["experiment"],I);const A=l(t,["labels"]);A!=null&&u(n,["labels"],A);const N=l(t,["outputUri"]);N!=null&&u(n,["outputUri"],N);const k=l(t,["pipelineJob"]);k!=null&&u(n,["pipelineJob"],k);const w=l(t,["serviceAccount"]);w!=null&&u(n,["serviceAccount"],w);const P=l(t,["tunedModelDisplayName"]);P!=null&&u(n,["tunedModelDisplayName"],P);const F=l(t,["veoTuningSpec"]);return F!=null&&u(n,["veoTuningSpec"],F),n}function jA(t,e){const n={},i=l(t,["sdkHttpResponse"]);i!=null&&u(n,["sdkHttpResponse"],i);const o=l(t,["name"]);o!=null&&u(n,["name"],o);const r=l(t,["metadata"]);r!=null&&u(n,["metadata"],r);const s=l(t,["done"]);s!=null&&u(n,["done"],s);const a=l(t,["error"]);return a!=null&&u(n,["error"],a),n}function Xh(t,e){const n={},i=l(t,["gcsUri"]);i!=null&&u(n,["validationDatasetUri"],i);const o=l(t,["vertexDatasetResource"]);return o!=null&&u(n,["validationDatasetUri"],o),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eN extends Jt{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Jn(qt.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var i;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const o={tunedModelName:n.baseModel};!((i=n.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(o.checkpointId=n.config.preTunedModelCheckpointId);const r=Object.assign(Object.assign({},n),{preTunedModel:o});return r.baseModel=void 0,await this.tuneInternal(r)}else{const o=Object.assign({},n);return await this.tuneInternal(o)}else{const o=Object.assign({},n),r=await this.tuneMldevInternal(o);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:tu.JOB_STATE_QUEUED}}}}async getInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=bA(e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>au(f))}else{const d=qA(e);return a=M("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>M_(f))}}async listInternal(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=JA(e);return a=M("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=KA(f),p=new Ph;return Object.assign(p,h),p})}else{const d=$A(e);return a=M("tunedModels",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=YA(f),p=new Ph;return Object.assign(p,h),p})}}async cancel(e){var n,i,o,r;let s,a="",c={};if(this.apiClient.isVertexAI()){const d=FA(e);return a=M("{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=VA(f),p=new xh;return Object.assign(p,h),p})}else{const d=LA(e);return a=M("{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=UA(f),p=new xh;return Object.assign(p,h),p})}}async tuneInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI()){const a=BA(e,e);return r=M("tuningJobs",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),o.then(c=>au(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,i;let o,r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=HA(e);return r=M("tunedModels",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),o.then(c=>jA(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tN{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const nN=1024*1024*8,iN=3,oN=1e3,rN=2,As="x-goog-upload-status";async function sN(t,e,n){var i;const o=await D_(t,e,n),r=await(o==null?void 0:o.json());if(((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[As])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return r.file}async function lN(t,e,n){var i;const o=await D_(t,e,n),r=await(o==null?void 0:o.json());if(((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[As])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const s=s_(r),a=new Rc;return Object.assign(a,s),a}async function D_(t,e,n){var i,o;let r=0,s=0,a=new nu(new Response),c="upload";for(r=t.size;s<r;){const d=Math.min(nN,r-s),f=t.slice(s,s+d);s+d>=r&&(c+=", finalize");let h=0,p=oN;for(;h<iN&&(a=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(s),"Content-Length":String(d)}}}),!(!((i=a==null?void 0:a.headers)===null||i===void 0)&&i[As]));)h++,await uN(p),p=p*rN;if(s+=d,((o=a==null?void 0:a.headers)===null||o===void 0?void 0:o[As])!=="active")break;if(r<=s)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function aN(t){return{size:t.size,type:t.type}}function uN(t){return new Promise(e=>setTimeout(e,t))}class cN{async upload(e,n,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await sN(e,n,i)}async uploadToFileSearchStore(e,n,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await lN(e,n,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await aN(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dN{create(e,n,i){return new fN(e,n,i)}}class fN{constructor(e,n,i){this.url=e,this.headers=n,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Zh="x-goog-api-key";class hN{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(Zh)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Zh,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pN="gl-node/";class mN{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const i=zC(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const o=new hN(this.apiKey);this.apiClient=new bw({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:pN+"web",uploader:new cN,downloader:new tN}),this.models=new aA(this.apiClient),this.live=new nA(this.apiClient,o,new dN),this.batches=new vS(this.apiClient),this.chats=new e0(this.models,this.apiClient),this.caches=new XS(this.apiClient),this.files=new c0(this.apiClient),this.operations=new uA(this.apiClient),this.authTokens=new wA(this.apiClient),this.tunings=new eN(this.apiClient),this.fileSearchStores=new DA(this.apiClient)}}const gN=new mN({apiKey:"AIzaSyBmKcFY8Mly2RVuVhmVUxqlFzVCmJHGbeo"}),_N={type:j.OBJECT,properties:{name:{type:j.STRING,description:"A creative name for the visual/audio theme"},colors:{type:j.ARRAY,items:{type:j.STRING},description:"An array of 5 hex color codes that match the theme"},scale:{type:j.STRING,enum:["pentatonic_major","pentatonic_minor","major","minor","harmonic_minor","dorian","phrygian","lydian","mixolydian","locrian","whole_tone","chromatic","pelog","hirajoshi"],description:"The musical scale that best matches the vibe"},synthConfig:{type:j.OBJECT,properties:{osc1Type:{type:j.STRING,enum:["sine","square","sawtooth","triangle"]},osc2Type:{type:j.STRING,enum:["sine","square","sawtooth","triangle"]},attack:{type:j.NUMBER,description:"Attack time in seconds (0.01 to 2.0)"},decay:{type:j.NUMBER,description:"Decay time in seconds (0.1 to 2.0)"},sustain:{type:j.NUMBER,description:"Sustain level (0.0 to 1.0)"},release:{type:j.NUMBER,description:"Release time in seconds (0.1 to 5.0)"},filterFreq:{type:j.NUMBER,description:"Filter cutoff frequency in Hz"},filterQ:{type:j.NUMBER,description:"Filter resonance/Q"},vibratoSpeed:{type:j.NUMBER,description:"Vibrato LFO speed in Hz"},vibratoDepth:{type:j.NUMBER,description:"Vibrato depth"}},required:["osc1Type","osc2Type","attack","decay","sustain","release","filterFreq","filterQ","vibratoSpeed","vibratoDepth"]},baseFreq:{type:j.NUMBER,description:"A base frequency in Hz (between 100 and 400)"},moodDescription:{type:j.STRING,description:"A short poetic description of the vibe"}},required:["name","colors","scale","synthConfig","baseFreq","moodDescription"]},yN=async(t,e)=>{try{const n="gemini-2.5-flash",i=e?` Use the seed word "${e}" to strictly determine the style.`:"",o=await gN.models.generateContent({model:n,contents:`Create a unique audiovisual theme for a musical mandala app.${i} The concept is: "${t}". Make the sound large and textured.`,config:{responseMimeType:"application/json",responseSchema:_N,systemInstruction:"You are an expert audio-visual artist and synthesizer sound designer. Return JSON only."}}),r=o.text;if(!r)throw console.warn("Gemini response was empty:",o),new Error("No response text from Gemini");return JSON.parse(r)}catch(n){return console.error("Gemini Theme Error Details:",n),{name:"Fallback Neon",colors:["#FF00FF","#00FFFF","#FFFF00","#FF0000","#0000FF"],scale:"pentatonic_minor",synthConfig:{osc1Type:"sawtooth",osc2Type:"square",attack:.05,decay:.2,sustain:.4,release:1.5,filterFreq:2e3,filterQ:5,vibratoSpeed:5,vibratoDepth:10},baseFreq:220,moodDescription:"A fallback theme because the AI is sleeping."}}},uu={pentatonic_major:[0,2,4,7,9],pentatonic_minor:[0,3,5,7,10],major:[0,2,4,5,7,9,11],minor:[0,2,3,5,7,8,10],harmonic_minor:[0,2,3,5,7,8,11],dorian:[0,2,3,5,7,9,10],phrygian:[0,1,3,5,7,8,10],lydian:[0,2,4,6,7,9,11],mixolydian:[0,2,4,5,7,9,10],locrian:[0,1,3,5,6,8,10],whole_tone:[0,2,4,6,8,10],chromatic:[0,1,2,3,4,5,6,7,8,9,10,11],pelog:[0,1,3,7,8],hirajoshi:[0,2,3,7,8]},cu={Single:[0],Octaves:[0,7],"Triad (1-3-5)":[0,2,4],"Sus4 (1-4-5)":[0,3,4],"Open 5th (1-5)":[0,4],"Cluster (1-2)":[0,1]};class vN{constructor(e,n,i,o,r,s){ue(this,"osc1");ue(this,"osc2");ue(this,"filter");ue(this,"distortion");ue(this,"amp");ue(this,"lfo");ue(this,"lfoGain");ue(this,"reverbSend");ue(this,"ctx");ue(this,"config");this.ctx=e,this.config=r;const a=e.currentTime;this.osc1=e.createOscillator(),this.osc1.type=r.osc1Type,this.osc1.frequency.value=o,this.osc2=e.createOscillator(),this.osc2.type=r.osc2Type,this.osc2.frequency.value=o,this.osc2.detune.value=5,this.lfo=e.createOscillator(),this.lfo.frequency.value=r.vibratoSpeed,this.lfoGain=e.createGain(),this.lfoGain.gain.setValueAtTime(0,a),s.includes("vibrato")&&this.lfoGain.gain.setTargetAtTime(r.vibratoDepth*5,a,.6),this.lfo.connect(this.lfoGain),this.lfoGain.connect(this.osc1.frequency),this.lfoGain.connect(this.osc2.frequency),this.lfo.start(a),this.filter=e.createBiquadFilter(),this.filter.type="lowpass",this.filter.Q.value=r.filterQ;const c=s.includes("filter_close")?400:r.filterFreq;this.filter.frequency.setValueAtTime(c,a),s.includes("filter_close")||this.filter.frequency.exponentialRampToValueAtTime(c*.5,a+r.decay),this.distortion=e.createWaveShaper(),this.distortion.curve=s.includes("distort")?this.makeDistortionCurve(50):null,this.distortion.oversample="4x",this.amp=e.createGain(),this.amp.gain.setValueAtTime(0,a),this.amp.gain.linearRampToValueAtTime(.5,a+r.attack),this.amp.gain.exponentialRampToValueAtTime(r.sustain*.5,a+r.attack+r.decay),this.reverbSend=e.createGain(),this.reverbSend.gain.value=s.includes("reverb_max")?.8:0,this.osc1.connect(this.filter),this.osc2.connect(this.filter),this.filter.connect(this.distortion),this.distortion.connect(this.amp),this.amp.connect(n),this.amp.connect(this.reverbSend),this.reverbSend.connect(i),this.osc1.start(a),this.osc2.start(a)}makeDistortionCurve(e){const i=new Float32Array(44100),o=Math.PI/180;for(let r=0;r<44100;++r){const s=r*2/44100-1;i[r]=(3+e)*s*20*o/(Math.PI+e*Math.abs(s))}return i}updateEffects(e){const n=this.ctx.currentTime,i=e.includes("filter_close")?400:this.config.filterFreq;this.filter.frequency.setTargetAtTime(i,n,.1),this.distortion.curve=e.includes("distort")?this.makeDistortionCurve(50):null,this.reverbSend.gain.setTargetAtTime(e.includes("reverb_max")?.8:0,n,.5),this.lfoGain.gain.setTargetAtTime(e.includes("vibrato")?this.config.vibratoDepth*5:0,n,.6)}release(){const e=this.ctx.currentTime,{release:n}=this.config;this.amp.gain.cancelScheduledValues(e),this.amp.gain.setValueAtTime(this.amp.gain.value,e),this.amp.gain.exponentialRampToValueAtTime(.001,e+n),this.osc1.stop(e+n+.1),this.osc2.stop(e+n+.1),this.lfo.stop(e+n+.1),setTimeout(()=>{this.osc1.disconnect(),this.osc2.disconnect(),this.filter.disconnect(),this.distortion.disconnect(),this.amp.disconnect(),this.reverbSend.disconnect(),this.lfo.disconnect(),this.lfoGain.disconnect()},(n+.2)*1e3)}}class EN{constructor(){ue(this,"ctx",null);ue(this,"masterGain",null);ue(this,"compressor",null);ue(this,"reverbNode",null);ue(this,"activeVoices",new Map)}init(){this.ctx||(this.ctx=new(window.AudioContext||window.webkitAudioContext),this.masterGain=this.ctx.createGain(),this.masterGain.gain.value=.4,this.compressor=this.ctx.createDynamicsCompressor(),this.reverbNode=this.ctx.createConvolver(),this.createImpulse(3,2),this.reverbNode.connect(this.compressor),this.compressor.connect(this.masterGain),this.masterGain.connect(this.ctx.destination))}createImpulse(e,n){if(!this.ctx||!this.reverbNode)return;const i=this.ctx.sampleRate,o=i*e,r=this.ctx.createBuffer(2,o,i),s=r.getChannelData(0),a=r.getChannelData(1);for(let c=0;c<o;c++){const f=Math.pow(1-c/o,n);s[c]=(Math.random()*2-1)*f,a[c]=(Math.random()*2-1)*f}this.reverbNode.buffer=r}getFreq(e,n,i){const o=uu[n]||uu.pentatonic_major,r=Math.floor(i/o.length),s=i%o.length,a=r*12+o[s];return e*Math.pow(2,a/12)}noteOn(e,n,i,o,r){if(this.ctx||this.init(),!this.ctx)return;this.ctx.state==="suspended"&&this.ctx.resume();const s=`${e}_${n}`;this.activeVoices.has(s)&&this.noteOff(e,n);const a=new vN(this.ctx,this.compressor,this.reverbNode,i,o,r);this.activeVoices.set(s,a)}noteOff(e,n){const i=`${e}_${n}`,o=this.activeVoices.get(i);o&&(o.release(),this.activeVoices.delete(i))}updateUserEffects(e,n){this.ctx&&this.activeVoices.forEach((i,o)=>{o.startsWith(`${e}_`)&&i.updateEffects(n)})}}const St=new EN,CN=({userCount:t,onThemeChange:e,currentTheme:n,isGenerating:i,setIsGenerating:o,roomCode:r,activeChordMode:s,setActiveChordMode:a,overrideScale:c,setOverrideScale:d})=>{const[f,h]=re.useState(""),[p,m]=re.useState(!1),[v,E]=re.useState(!1),S=async g=>{g.preventDefault();const y=f.trim()||r||"Cosmic Geometry";o(!0);try{const C=await yN(y,r);e(C),E(!0)}catch(C){console.error(C)}finally{o(!1),f&&h("")}},_=(g,y)=>{const C={...n,synthConfig:{...n.synthConfig,[g]:y}};e(C)};return p?T.jsxs("div",{className:"fixed top-4 right-4 z-20 w-80 bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl p-6 shadow-2xl text-sm font-light max-h-[90vh] overflow-y-auto",children:[T.jsxs("div",{className:"flex justify-between items-center mb-6",children:[T.jsx("h2",{className:"text-xl font-medium tracking-widest bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"MANDALOOP"}),T.jsx("button",{onClick:()=>m(!1),className:"text-white/70 hover:text-white transition-colors",children:T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[T.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),T.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),T.jsxs("div",{className:"mb-6 pb-4 border-b border-white/10",children:[T.jsxs("div",{className:"flex justify-between items-center text-white/70 mb-1",children:[T.jsx("span",{className:"text-xs uppercase tracking-wider",children:"Connected Room"}),T.jsx("span",{className:"font-mono text-xs text-green-400",children:" LIVE"})]}),T.jsx("div",{className:"font-mono text-2xl text-white tracking-widest",children:r}),T.jsxs("div",{className:"text-[10px] text-white/50 mt-1",children:["Users in room: ",t]})]}),T.jsxs("div",{className:"mb-6 pb-4 border-b border-white/10 space-y-4",children:[T.jsx("h3",{className:"text-xs uppercase tracking-wider text-white/50",children:"Instrument Config"}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-[10px] text-white/70 mb-1",children:"CHORD MODE"}),T.jsx("select",{value:s,onChange:g=>a(g.target.value),className:"w-full bg-white/10 border border-white/10 rounded px-2 py-1 text-white text-xs focus:outline-none focus:bg-white/20",children:Object.keys(cu).map(g=>T.jsx("option",{value:g,className:"bg-black text-white",children:g},g))})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-[10px] text-white/70 mb-1",children:"SCALE OVERRIDE"}),T.jsxs("select",{value:c,onChange:g=>d(g.target.value),className:"w-full bg-white/10 border border-white/10 rounded px-2 py-1 text-white text-xs focus:outline-none focus:bg-white/20",children:[T.jsx("option",{value:"",className:"bg-black text-gray-400",children:"Auto (AI Theme)"}),Object.keys(uu).map(g=>T.jsx("option",{value:g,className:"bg-black text-white",children:g.replace("_"," ").toUpperCase()},g))]})]})]}),T.jsxs("div",{className:"mb-6",children:[T.jsx("label",{className:"block text-white/50 mb-2 text-xs uppercase tracking-wider",children:"Generate New Vibe"}),T.jsxs("form",{onSubmit:S,className:"flex gap-2",children:[T.jsx("input",{type:"text",value:f,onChange:g=>h(g.target.value),placeholder:"Describe atmosphere...",className:"w-full bg-white/10 border border-white/10 rounded px-3 py-2 text-white placeholder-white/30 focus:outline-none focus:border-purple-500/50 transition-colors"}),T.jsx("button",{type:"submit",disabled:i,className:"bg-purple-600/80 hover:bg-purple-500 disabled:bg-purple-900/50 text-white rounded px-3 py-2 transition-colors flex items-center justify-center",children:i?T.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[T.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),T.jsx("path",{d:"M21 3v5h-5"})]})})]})]}),T.jsxs("div",{className:"mb-4",children:[T.jsxs("button",{onClick:()=>E(!v),className:"w-full flex justify-between items-center text-xs uppercase tracking-wider text-white/50 hover:text-white transition-colors",children:[T.jsx("span",{children:"Fine Tune Sound"}),T.jsx("span",{children:v?"":"+"})]}),v&&T.jsxs("div",{className:"mt-4 space-y-4 p-4 bg-black/40 rounded border border-white/5",children:[T.jsxs("div",{className:"space-y-3",children:[T.jsxs("div",{children:[T.jsxs("div",{className:"flex justify-between text-[10px] text-white/70 mb-1",children:[T.jsx("span",{children:"ATTACK"}),T.jsxs("span",{children:[n.synthConfig.attack,"s"]})]}),T.jsx("input",{type:"range",min:"0.01",max:"2.0",step:"0.01",value:n.synthConfig.attack,onChange:g=>_("attack",parseFloat(g.target.value)),className:"w-full h-1 bg-white/20 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),T.jsxs("div",{children:[T.jsxs("div",{className:"flex justify-between text-[10px] text-white/70 mb-1",children:[T.jsx("span",{children:"RELEASE"}),T.jsxs("span",{children:[n.synthConfig.release,"s"]})]}),T.jsx("input",{type:"range",min:"0.1",max:"5.0",step:"0.1",value:n.synthConfig.release,onChange:g=>_("release",parseFloat(g.target.value)),className:"w-full h-1 bg-white/20 rounded-lg appearance-none cursor-pointer accent-purple-500"})]})]}),T.jsxs("div",{children:[T.jsxs("div",{className:"flex justify-between text-[10px] text-white/70 mb-1",children:[T.jsx("span",{children:"BRIGHTNESS (FILTER)"}),T.jsxs("span",{children:[n.synthConfig.filterFreq,"Hz"]})]}),T.jsx("input",{type:"range",min:"200",max:"5000",step:"50",value:n.synthConfig.filterFreq,onChange:g=>_("filterFreq",parseFloat(g.target.value)),className:"w-full h-1 bg-white/20 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),T.jsxs("div",{children:[T.jsxs("div",{className:"flex justify-between text-[10px] text-white/70 mb-1",children:[T.jsx("span",{children:"WOBBLE (VIBRATO)"}),T.jsx("span",{children:n.synthConfig.vibratoDepth})]}),T.jsx("input",{type:"range",min:"0",max:"30",step:"1",value:n.synthConfig.vibratoDepth,onChange:g=>_("vibratoDepth",parseFloat(g.target.value)),className:"w-full h-1 bg-white/20 rounded-lg appearance-none cursor-pointer accent-pink-500"})]})]})]}),T.jsxs("div",{className:"mt-4 p-4 bg-white/5 rounded border border-white/5",children:[T.jsx("div",{className:"text-white font-medium mb-1",children:n.name}),T.jsx("div",{className:"text-xs text-white/60 italic leading-relaxed",children:n.moodDescription}),T.jsxs("div",{className:"mt-3 text-[10px] text-white/50 font-mono uppercase",children:["Scale: ",n.scale.replace("_"," ")]})]})]}):T.jsx("button",{onClick:()=>m(!0),className:"fixed top-4 right-4 z-20 bg-white/5 backdrop-blur-md p-3 rounded-full hover:bg-white/20 transition-all border border-white/10",children:T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[T.jsx("circle",{cx:"12",cy:"12",r:"3"}),T.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1.29 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})},TN=({onJoin:t})=>{const[e,n]=re.useState(""),[i,o]=re.useState(""),r=s=>{s.preventDefault(),e&&i&&t(e,i.toUpperCase())};return T.jsx("div",{className:"fixed inset-0 z-50 bg-[#050505] flex items-center justify-center p-4",children:T.jsxs("div",{className:"max-w-md w-full relative",children:[T.jsx("div",{className:"absolute inset-0 bg-purple-500/10 blur-[100px] rounded-full"}),T.jsxs("div",{className:"relative z-10 bg-white/5 border border-white/10 p-8 rounded-2xl backdrop-blur-xl shadow-2xl",children:[T.jsxs("div",{className:"text-center mb-10",children:[T.jsx("h1",{className:"text-5xl font-extralight tracking-[0.2em] text-white mb-2 drop-shadow-lg",children:"MANDALOOP"}),T.jsx("p",{className:"text-white/40 text-sm tracking-widest uppercase",children:"Shared Musical Geometry"})]}),T.jsxs("form",{onSubmit:r,className:"space-y-6",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs uppercase tracking-wider text-white/50 mb-2",children:"Your Name"}),T.jsx("input",{type:"text",value:e,onChange:s=>n(s.target.value),placeholder:"ENTER ALIAS",className:"w-full bg-black/40 border border-white/10 rounded-lg px-4 py-4 text-center text-lg text-white font-mono tracking-wide focus:outline-none focus:border-purple-500 transition-colors",maxLength:12,autoFocus:!0})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs uppercase tracking-wider text-white/50 mb-2",children:"Room Code"}),T.jsx("input",{type:"text",value:i,onChange:s=>o(s.target.value),placeholder:"ROOM ID",className:"w-full bg-black/40 border border-white/10 rounded-lg px-4 py-4 text-center text-lg text-white font-mono tracking-widest focus:outline-none focus:border-purple-500 transition-colors uppercase",maxLength:8}),T.jsx("p",{className:"text-[10px] text-white/30 mt-2 text-center",children:"Open this app in multiple tabs with the same code to play together."})]}),T.jsx("button",{type:"submit",disabled:!e||!i,className:"w-full bg-white text-black font-bold uppercase tracking-widest py-4 rounded-lg hover:bg-purple-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Enter Room"})]})]})]})})};var jh={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x=function(t,e){if(!t)throw Ji(e)},Ji=function(t){return new Error("Firebase Database ("+L_.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let o=t.charCodeAt(i);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},SN=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const o=t[n++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const r=t[n++];e[i++]=String.fromCharCode((o&31)<<6|r&63)}else if(o>239&&o<365){const r=t[n++],s=t[n++],a=t[n++],c=((o&7)<<18|(r&63)<<12|(s&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const r=t[n++],s=t[n++];e[i++]=String.fromCharCode((o&15)<<12|(r&63)<<6|s&63)}}return e.join("")},Lc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<t.length;o+=3){const r=t[o],s=o+1<t.length,a=s?t[o+1]:0,c=o+2<t.length,d=c?t[o+2]:0,f=r>>2,h=(r&3)<<4|a>>4;let p=(a&15)<<2|d>>6,m=d&63;c||(m=64,s||(p=64)),i.push(n[f],n[h],n[p],n[m])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(F_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):SN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<t.length;){const r=n[t.charAt(o++)],a=o<t.length?n[t.charAt(o)]:0;++o;const d=o<t.length?n[t.charAt(o)]:64;++o;const h=o<t.length?n[t.charAt(o)]:64;if(++o,r==null||a==null||d==null||h==null)throw new IN;const p=r<<2|a>>4;if(i.push(p),d!==64){const m=a<<4&240|d>>2;if(i.push(m),h!==64){const v=d<<6&192|h;i.push(v)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class IN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const U_=function(t){const e=F_(t);return Lc.encodeByteArray(e,!0)},Ns=function(t){return U_(t).replace(/\./g,"")},du=function(t){try{return Lc.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wN(t){return V_(void 0,t)}function V_(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!AN(n)||(t[n]=V_(t[n],e[n]));return t}function AN(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN=()=>NN().__FIREBASE_DEFAULTS__,PN=()=>{if(typeof process>"u"||typeof jh>"u")return;const t=jh.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},xN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&du(t[1]);return e&&JSON.parse(e)},G_=()=>{try{return RN()||PN()||xN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},kN=t=>{var e,n;return(n=(e=G_())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},MN=t=>{const e=kN(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},O_=()=>{var t;return(t=G_())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DN(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",o=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ns(JSON.stringify(n)),Ns(JSON.stringify(s)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function H_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(LN())}function FN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function UN(){return L_.NODE_ADMIN===!0}function VN(){try{return typeof indexedDB=="object"}catch{return!1}}function GN(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{var r;e(((r=o.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON="FirebaseError";class ur extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=ON,Object.setPrototypeOf(this,ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,B_.prototype.create)}}class B_{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},o=`${this.service}/${e}`,r=this.errors[e],s=r?HN(r,i):"Error",a=`${this.serviceName}: ${s} (${o}).`;return new ur(o,a,i)}}function HN(t,e){return t.replace(BN,(n,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const BN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jo(t){return JSON.parse(t)}function Ne(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_=function(t){let e={},n={},i={},o="";try{const r=t.split(".");e=Jo(du(r[0])||""),n=Jo(du(r[1])||""),o=r[2],i=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:i,signature:o}},qN=function(t){const e=q_(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},bN=function(t){const e=q_(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Li(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function fu(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Rs(t,e,n){const i={};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=e.call(n,t[o],o,t));return i}function hu(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const o of n){if(!i.includes(o))return!1;const r=t[o],s=e[o];if(ep(r)&&ep(s)){if(!hu(r,s))return!1}else if(r!==s)return!1}for(const o of i)if(!n.includes(o))return!1;return!0}function ep(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const i=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)i[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)i[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const p=i[h-3]^i[h-8]^i[h-14]^i[h-16];i[h]=(p<<1|p>>>31)&4294967295}let o=this.chain_[0],r=this.chain_[1],s=this.chain_[2],a=this.chain_[3],c=this.chain_[4],d,f;for(let h=0;h<80;h++){h<40?h<20?(d=a^r&(s^a),f=1518500249):(d=r^s^a,f=1859775393):h<60?(d=r&s|a&(r|s),f=2400959708):(d=r^s^a,f=3395469782);const p=(o<<5|o>>>27)+d+c+f+i[h]&4294967295;c=a,a=s,s=(r<<30|r>>>2)&4294967295,r=o,o=p}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+s&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const i=n-this.blockSize;let o=0;const r=this.buf_;let s=this.inbuf_;for(;o<n;){if(s===0)for(;o<=i;)this.compress_(e,o),o+=this.blockSize;if(typeof e=="string"){for(;o<n;)if(r[s]=e.charCodeAt(o),++s,++o,s===this.blockSize){this.compress_(r),s=0;break}}else for(;o<n;)if(r[s]=e[o],++s,++o,s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let o=this.blockSize-1;o>=56;o--)this.buf_[o]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let o=0;o<5;o++)for(let r=24;r>=0;r-=8)e[i]=this.chain_[o]>>r&255,++i;return e}}function Fi(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let o=t.charCodeAt(i);if(o>=55296&&o<=56319){const r=o-55296;i++,x(i<t.length,"Surrogate pair missing trail surrogate.");const s=t.charCodeAt(i)-56320;o=65536+(r<<10)+s}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},cl=function(t){let e=0;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(t){return t&&t._delegate?t._delegate:t}class Yo{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new Mt;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:n});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(r){if(o)return null;throw r}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(KN(e))try{this.getOrInitializeService({instanceIdentifier:Nn})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:o});i.resolve(r)}catch{}}}}clearInstance(e=Nn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Nn){return this.instances.has(e)}getOptions(e=Nn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[r,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&s.resolve(o)}return o}onInit(e,n){var i;const o=this.normalizeInstanceIdentifier(n),r=(i=this.onInitCallbacks.get(o))!==null&&i!==void 0?i:new Set;r.add(e),this.onInitCallbacks.set(o,r);const s=this.instances.get(o);return s&&e(s,o),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const o of i)try{o(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:YN(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Nn){return this.component?this.component.multipleInstances?e:Nn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YN(t){return t===Nn?void 0:t}function KN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new JN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ee||(ee={}));const XN={debug:ee.DEBUG,verbose:ee.VERBOSE,info:ee.INFO,warn:ee.WARN,error:ee.ERROR,silent:ee.SILENT},ZN=ee.INFO,jN={[ee.DEBUG]:"log",[ee.VERBOSE]:"log",[ee.INFO]:"info",[ee.WARN]:"warn",[ee.ERROR]:"error"},eR=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),o=jN[e];if(o)console[o](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class b_{constructor(e){this.name=e,this._logLevel=ZN,this._logHandler=eR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?XN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ee.DEBUG,...e),this._logHandler(this,ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ee.VERBOSE,...e),this._logHandler(this,ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ee.INFO,...e),this._logHandler(this,ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ee.WARN,...e),this._logHandler(this,ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ee.ERROR,...e),this._logHandler(this,ee.ERROR,...e)}}const tR=(t,e)=>e.some(n=>t instanceof n);let tp,np;function nR(){return tp||(tp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function iR(){return np||(np=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const z_=new WeakMap,pu=new WeakMap,W_=new WeakMap,Yl=new WeakMap,Fc=new WeakMap;function oR(t){const e=new Promise((n,i)=>{const o=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{n(fn(t.result)),o()},s=()=>{i(t.error),o()};t.addEventListener("success",r),t.addEventListener("error",s)});return e.then(n=>{n instanceof IDBCursor&&z_.set(n,t)}).catch(()=>{}),Fc.set(e,t),e}function rR(t){if(pu.has(t))return;const e=new Promise((n,i)=>{const o=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{n(),o()},s=()=>{i(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)});pu.set(t,e)}let mu={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return pu.get(t);if(e==="objectStoreNames")return t.objectStoreNames||W_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return fn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function sR(t){mu=t(mu)}function lR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(Kl(this),e,...n);return W_.set(i,e.sort?e.sort():[e]),fn(i)}:iR().includes(t)?function(...e){return t.apply(Kl(this),e),fn(z_.get(this))}:function(...e){return fn(t.apply(Kl(this),e))}}function aR(t){return typeof t=="function"?lR(t):(t instanceof IDBTransaction&&rR(t),tR(t,nR())?new Proxy(t,mu):t)}function fn(t){if(t instanceof IDBRequest)return oR(t);if(Yl.has(t))return Yl.get(t);const e=aR(t);return e!==t&&(Yl.set(t,e),Fc.set(e,t)),e}const Kl=t=>Fc.get(t);function uR(t,e,{blocked:n,upgrade:i,blocking:o,terminated:r}={}){const s=indexedDB.open(t,e),a=fn(s);return i&&s.addEventListener("upgradeneeded",c=>{i(fn(s.result),c.oldVersion,c.newVersion,fn(s.transaction),c)}),n&&s.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{r&&c.addEventListener("close",()=>r()),o&&c.addEventListener("versionchange",d=>o(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const cR=["get","getKey","getAll","getAllKeys","count"],dR=["put","add","delete","clear"],Ql=new Map;function ip(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ql.get(e))return Ql.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,o=dR.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(o||cR.includes(n)))return;const r=async function(s,...a){const c=this.transaction(s,o?"readwrite":"readonly");let d=c.store;return i&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),o&&c.done]))[0]};return Ql.set(e,r),r}sR(t=>({...t,get:(e,n,i)=>ip(e,n)||t.get(e,n,i),has:(e,n)=>!!ip(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(hR(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function hR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const gu="@firebase/app",op="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bt=new b_("@firebase/app"),pR="@firebase/app-compat",mR="@firebase/analytics-compat",gR="@firebase/analytics",_R="@firebase/app-check-compat",yR="@firebase/app-check",vR="@firebase/auth",ER="@firebase/auth-compat",CR="@firebase/database",TR="@firebase/data-connect",SR="@firebase/database-compat",IR="@firebase/functions",wR="@firebase/functions-compat",AR="@firebase/installations",NR="@firebase/installations-compat",RR="@firebase/messaging",PR="@firebase/messaging-compat",xR="@firebase/performance",kR="@firebase/performance-compat",MR="@firebase/remote-config",DR="@firebase/remote-config-compat",LR="@firebase/storage",FR="@firebase/storage-compat",UR="@firebase/firestore",VR="@firebase/vertexai-preview",GR="@firebase/firestore-compat",OR="firebase",HR="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _u="[DEFAULT]",BR={[gu]:"fire-core",[pR]:"fire-core-compat",[gR]:"fire-analytics",[mR]:"fire-analytics-compat",[yR]:"fire-app-check",[_R]:"fire-app-check-compat",[vR]:"fire-auth",[ER]:"fire-auth-compat",[CR]:"fire-rtdb",[TR]:"fire-data-connect",[SR]:"fire-rtdb-compat",[IR]:"fire-fn",[wR]:"fire-fn-compat",[AR]:"fire-iid",[NR]:"fire-iid-compat",[RR]:"fire-fcm",[PR]:"fire-fcm-compat",[xR]:"fire-perf",[kR]:"fire-perf-compat",[MR]:"fire-rc",[DR]:"fire-rc-compat",[LR]:"fire-gcs",[FR]:"fire-gcs-compat",[UR]:"fire-fst",[GR]:"fire-fst-compat",[VR]:"fire-vertex","fire-js":"fire-js",[OR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps=new Map,qR=new Map,yu=new Map;function rp(t,e){try{t.container.addComponent(e)}catch(n){bt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function xs(t){const e=t.name;if(yu.has(e))return bt.debug(`There were multiple attempts to register component ${e}.`),!1;yu.set(e,t);for(const n of Ps.values())rp(n,t);for(const n of qR.values())rp(n,t);return!0}function bR(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},hn=new B_("app","Firebase",zR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,n,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Yo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw hn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R=HR;function $_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i=Object.assign({name:_u,automaticDataCollectionEnabled:!1},e),o=i.name;if(typeof o!="string"||!o)throw hn.create("bad-app-name",{appName:String(o)});if(n||(n=O_()),!n)throw hn.create("no-options");const r=Ps.get(o);if(r){if(hu(n,r.options)&&hu(i,r.config))return r;throw hn.create("duplicate-app",{appName:o})}const s=new QN(o);for(const c of yu.values())s.addComponent(c);const a=new WR(n,i,s);return Ps.set(o,a),a}function JR(t=_u){const e=Ps.get(t);if(!e&&t===_u&&O_())return $_();if(!e)throw hn.create("no-app",{appName:t});return e}function Si(t,e,n){var i;let o=(i=BR[t])!==null&&i!==void 0?i:t;n&&(o+=`-${n}`);const r=o.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const a=[`Unable to register library "${o}" with version "${e}":`];r&&a.push(`library name "${o}" contains illegal characters (whitespace or "/")`),r&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),bt.warn(a.join(" "));return}xs(new Yo(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR="firebase-heartbeat-database",KR=1,Ko="firebase-heartbeat-store";let Xl=null;function J_(){return Xl||(Xl=uR(YR,KR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ko)}catch(n){console.warn(n)}}}}).catch(t=>{throw hn.create("idb-open",{originalErrorMessage:t.message})})),Xl}async function QR(t){try{const n=(await J_()).transaction(Ko),i=await n.objectStore(Ko).get(Y_(t));return await n.done,i}catch(e){if(e instanceof ur)bt.warn(e.message);else{const n=hn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});bt.warn(n.message)}}}async function sp(t,e){try{const i=(await J_()).transaction(Ko,"readwrite");await i.objectStore(Ko).put(e,Y_(t)),await i.done}catch(n){if(n instanceof ur)bt.warn(n.message);else{const i=hn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});bt.warn(i.message)}}}function Y_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR=1024,ZR=30*24*60*60*1e3;class jR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tP(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,n;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=lp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)?void 0:(this._heartbeatsCache.heartbeats.push({date:r,agent:o}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const a=new Date(s.date).valueOf();return Date.now()-a<=ZR}),this._storage.overwrite(this._heartbeatsCache))}catch(i){bt.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=lp(),{heartbeatsToSend:i,unsentEntries:o}=eP(this._heartbeatsCache.heartbeats),r=Ns(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return bt.warn(n),""}}}function lp(){return new Date().toISOString().substring(0,10)}function eP(t,e=XR){const n=[];let i=t.slice();for(const o of t){const r=n.find(s=>s.agent===o.agent);if(r){if(r.dates.push(o.date),ap(n)>e){r.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),ap(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class tP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return VN()?GN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await QR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const o=await this.read();return sp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const o=await this.read();return sp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function ap(t){return Ns(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(t){xs(new Yo("platform-logger",e=>new fR(e),"PRIVATE")),xs(new Yo("heartbeat",e=>new jR(e),"PRIVATE")),Si(gu,op,t),Si(gu,op,"esm2017"),Si("fire-js","")}nP("");var iP="firebase",oP="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Si(iP,oP,"app");var up={};const cp="@firebase/database",dp="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let K_="";function rP(t){K_=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ne(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Jo(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Rt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q_=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new sP(e)}}catch{}return new lP},Mn=Q_("localStorage"),aP=Q_("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=new b_("@firebase/database"),uP=function(){let t=1;return function(){return t++}}(),X_=function(t){const e=$N(t),n=new WN;n.update(e);const i=n.digest();return Lc.encodeByteArray(i)},cr=function(...t){let e="";for(let n=0;n<t.length;n++){const i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=cr.apply(null,i):typeof i=="object"?e+=Ne(i):e+=i,e+=" "}return e};let wo=null,fp=!0;const cP=function(t,e){x(!0,"Can't turn on custom loggers persistently."),Ii.logLevel=ee.VERBOSE,wo=Ii.log.bind(Ii)},xe=function(...t){if(fp===!0&&(fp=!1,wo===null&&aP.get("logging_enabled")===!0&&cP()),wo){const e=cr.apply(null,t);wo(e)}},dr=function(t){return function(...e){xe(t,...e)}},vu=function(...t){const e="FIREBASE INTERNAL ERROR: "+cr(...t);Ii.error(e)},zt=function(...t){const e=`FIREBASE FATAL ERROR: ${cr(...t)}`;throw Ii.error(e),new Error(e)},Qe=function(...t){const e="FIREBASE WARNING: "+cr(...t);Ii.warn(e)},dP=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Qe("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},dl=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},fP=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Ui="[MIN_NAME]",Bn="[MAX_NAME]",Kn=function(t,e){if(t===e)return 0;if(t===Ui||e===Bn)return-1;if(e===Ui||t===Bn)return 1;{const n=hp(t),i=hp(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},hP=function(t,e){return t===e?0:t<e?-1:1},so=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ne(e))},Uc=function(t){if(typeof t!="object"||t===null)return Ne(t);const e=[];for(const i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=Ne(e[i]),n+=":",n+=Uc(t[e[i]]);return n+="}",n},Z_=function(t,e){const n=t.length;if(n<=e)return[t];const i=[];for(let o=0;o<n;o+=e)o+e>n?i.push(t.substring(o,n)):i.push(t.substring(o,o+e));return i};function Ge(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const j_=function(t){x(!dl(t),"Invalid JSON number");const e=11,n=52,i=(1<<e-1)-1;let o,r,s,a,c;t===0?(r=0,s=0,o=1/t===-1/0?1:0):(o=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),i),r=a+i,s=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(r=0,s=Math.round(t/Math.pow(2,1-i-n))));const d=[];for(c=n;c;c-=1)d.push(s%2?1:0),s=Math.floor(s/2);for(c=e;c;c-=1)d.push(r%2?1:0),r=Math.floor(r/2);d.push(o?1:0),d.reverse();const f=d.join("");let h="";for(c=0;c<64;c+=8){let p=parseInt(f.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},pP=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},mP=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function gP(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}const _P=new RegExp("^-?(0*)\\d{1,10}$"),yP=-2147483648,vP=2147483647,hp=function(t){if(_P.test(t)){const e=Number(t);if(e>=yP&&e<=vP)return e}return null},Yi=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Qe("Exception was thrown by user callback.",n),e},Math.floor(0))}},EP=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ao=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Qe(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(o=>this.auth_=o)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(xe("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Qe(e)}}class Zr{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Zr.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc="5",ey="v",ty="s",ny="r",iy="f",oy=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ry="ls",sy="p",Eu="ac",ly="websocket",ay="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(e,n,i,o,r=!1,s="",a=!1,c=!1){this.secure=n,this.namespace=i,this.webSocketOnly=o,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Mn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Mn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function SP(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function cy(t,e,n){x(typeof e=="string","typeof type must == string"),x(typeof n=="object","typeof params must == object");let i;if(e===ly)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===ay)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);SP(t)&&(n.ns=t.namespace);const o=[];return Ge(n,(r,s)=>{o.push(r+"="+s)}),i+o.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(){this.counters_={}}incrementCounter(e,n=1){Rt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return wN(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl={},jl={};function Gc(t){const e=t.toString();return Zl[e]||(Zl[e]=new IP),Zl[e]}function wP(t,e){const n=t.toString();return jl[n]||(jl[n]=e()),jl[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let o=0;o<i.length;++o)i[o]&&Yi(()=>{this.onMessage_(i[o])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pp="start",NP="close",RP="pLPCommand",PP="pRTLPCB",dy="id",fy="pw",hy="ser",xP="cb",kP="seg",MP="ts",DP="d",LP="dframe",py=1870,my=30,FP=py-my,UP=25e3,VP=3e4;class fi{constructor(e,n,i,o,r,s,a){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=o,this.authToken=r,this.transportSessionId=s,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=dr(e),this.stats_=Gc(n),this.urlFn=c=>(this.appCheckToken&&(c[Eu]=this.appCheckToken),cy(n,ay,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new AP(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(VP)),fP(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Oc((...r)=>{const[s,a,c,d,f]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,s===pp)this.id=a,this.password=c;else if(s===NP)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+s)},(...r)=>{const[s,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(s,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[pp]="t",i[hy]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[xP]=this.scriptTagHolder.uniqueCallbackIdentifier),i[ey]=Vc,this.transportSessionId&&(i[ty]=this.transportSessionId),this.lastSessionId&&(i[ry]=this.lastSessionId),this.applicationId&&(i[sy]=this.applicationId),this.appCheckToken&&(i[Eu]=this.appCheckToken),typeof location<"u"&&location.hostname&&oy.test(location.hostname)&&(i[ny]=iy);const o=this.urlFn(i);this.log_("Connecting via long-poll to "+o),this.scriptTagHolder.addTag(o,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){fi.forceAllow_=!0}static forceDisallow(){fi.forceDisallow_=!0}static isAvailable(){return fi.forceAllow_?!0:!fi.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!pP()&&!mP()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Ne(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=U_(n),o=Z_(i,FP);for(let r=0;r<o.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,o.length,o[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const i={};i[LP]="t",i[dy]=e,i[fy]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Ne(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Oc{constructor(e,n,i,o){this.onDisconnect=i,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=uP(),window[RP+this.uniqueCallbackIdentifier]=e,window[PP+this.uniqueCallbackIdentifier]=n,this.myIFrame=Oc.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const s="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(a){xe("frame writing exception"),a.stack&&xe(a.stack),xe(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||xe("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[dy]=this.myID,e[fy]=this.myPW,e[hy]=this.currentSerial;let n=this.urlFn(e),i="",o=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+my+i.length<=py;){const s=this.pendingSegs.shift();i=i+"&"+kP+o+"="+s.seg+"&"+MP+o+"="+s.ts+"&"+DP+o+"="+s.d,o++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},o=setTimeout(i,Math.floor(UP)),r=()=>{clearTimeout(o),i()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const o=i.readyState;(!o||o==="loaded"||o==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{xe("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP=16384,OP=45e3;let ks=null;typeof MozWebSocket<"u"?ks=MozWebSocket:typeof WebSocket<"u"&&(ks=WebSocket);class mt{constructor(e,n,i,o,r,s,a){this.connId=e,this.applicationId=i,this.appCheckToken=o,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=dr(this.connId),this.stats_=Gc(n),this.connURL=mt.connectionURL_(n,s,a,o,i),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,i,o,r){const s={};return s[ey]=Vc,typeof location<"u"&&location.hostname&&oy.test(location.hostname)&&(s[ny]=iy),n&&(s[ty]=n),i&&(s[ry]=i),o&&(s[Eu]=o),r&&(s[sy]=r),cy(e,ly,s)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Mn.set("previous_websocket_failure",!0);try{let i;UN(),this.mySock=new ks(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const o=i.message||i.data;o&&this.log_(o),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const o=i.message||i.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){mt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(n);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&ks!==null&&!mt.forceDisallow_}static previouslyFailed(){return Mn.isInMemoryStorage||Mn.get("previous_websocket_failure")===!0}markConnectionHealthy(){Mn.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const i=Jo(n);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(x(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const i=this.extractFrameCount_(n);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const n=Ne(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=Z_(n,GP);i.length>1&&this.sendString_(String(i.length));for(let o=0;o<i.length;o++)this.sendString_(i[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(OP))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}mt.responsesRequiredToBeHealthy=2;mt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[fi,mt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=mt&&mt.isAvailable();let i=n&&!mt.previouslyFailed();if(e.webSocketOnly&&(n||Qe("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[mt];else{const o=this.transports_=[];for(const r of Qo.ALL_TRANSPORTS)r&&r.isAvailable()&&o.push(r);Qo.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Qo.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HP=6e4,BP=5e3,qP=10*1024,bP=100*1024,ea="t",mp="d",zP="s",gp="r",WP="e",_p="o",yp="a",vp="n",Ep="p",$P="h";class JP{constructor(e,n,i,o,r,s,a,c,d,f){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=o,this.authToken_=r,this.onMessage_=s,this.onReady_=a,this.onDisconnect_=c,this.onKill_=d,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=dr("c:"+this.id+":"),this.transportManager_=new Qo(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));const o=e.healthyTimeout||0;o>0&&(this.healthyTimeout_=Ao(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>bP?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>qP?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(o)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ea in e){const n=e[ea];n===yp?this.upgradeIfSecondaryHealthy_():n===gp?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===_p&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=so("t",e),i=so("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Ep,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:yp,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:vp,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=so("t",e),i=so("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=so(ea,e);if(mp in e){const i=e[mp];if(n===$P){const o=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(o.h=this.repoInfo_.host),this.onHandshake_(o)}else if(n===vp){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let o=0;o<this.pendingDataMessages.length;++o)this.onDataMessage_(this.pendingDataMessages[o]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===zP?this.onConnectionShutdown_(i):n===gp?this.onReset_(i):n===WP?vu("Server Error: "+i):n===_p?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):vu("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,i=e.v,o=e.h;this.sessionId=e.s,this.repoInfo_.host=o,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Vc!==i&&Qe("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),Ao(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(HP))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ao(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(BP))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Ep,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Mn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{put(e,n,i,o){}merge(e,n,i,o){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e){this.allowedEvents_=e,this.listeners_={},x(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let o=0;o<i.length;o++)i[o].callback.apply(i[o].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});const o=this.getInitialEvent(e);o&&n.apply(i,o)}off(e,n,i){this.validateEventType_(e);const o=this.listeners_[e]||[];for(let r=0;r<o.length;r++)if(o[r].callback===n&&(!i||i===o[r].context)){o.splice(r,1);return}}validateEventType_(e){x(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms extends _y{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!H_()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Ms}getInitialEvent(e){return x(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cp=32,Tp=768;class X{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let o=0;o<this.pieces_.length;o++)this.pieces_[o].length>0&&(this.pieces_[i]=this.pieces_[o],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function K(){return new X("")}function B(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function _n(t){return t.pieces_.length-t.pieceNum_}function Z(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new X(t.pieces_,e)}function Hc(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function YP(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Xo(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function yy(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new X(e,0)}function _e(t,e){const n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof X)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{const i=e.split("/");for(let o=0;o<i.length;o++)i[o].length>0&&n.push(i[o])}return new X(n,0)}function q(t){return t.pieceNum_>=t.pieces_.length}function We(t,e){const n=B(t),i=B(e);if(n===null)return e;if(n===i)return We(Z(t),Z(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function KP(t,e){const n=Xo(t,0),i=Xo(e,0);for(let o=0;o<n.length&&o<i.length;o++){const r=Kn(n[o],i[o]);if(r!==0)return r}return n.length===i.length?0:n.length<i.length?-1:1}function Bc(t,e){if(_n(t)!==_n(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function st(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(_n(t)>_n(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}class QP{constructor(e,n){this.errorPrefix_=n,this.parts_=Xo(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=cl(this.parts_[i]);vy(this)}}function XP(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=cl(e),vy(t)}function ZP(t){const e=t.parts_.pop();t.byteLength_-=cl(e),t.parts_.length>0&&(t.byteLength_-=1)}function vy(t){if(t.byteLength_>Tp)throw new Error(t.errorPrefix_+"has a key path longer than "+Tp+" bytes ("+t.byteLength_+").");if(t.parts_.length>Cp)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Cp+") or object contains a cycle "+Rn(t))}function Rn(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc extends _y{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new qc}getInitialEvent(e){return x(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo=1e3,jP=60*5*1e3,Sp=30*1e3,ex=1.3,tx=3e4,nx="server_kill",Ip=3;class Vt extends gy{constructor(e,n,i,o,r,s,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=i,this.onConnectStatus_=o,this.onServerInfoUpdate_=r,this.authTokenProvider_=s,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=Vt.nextPersistentConnectionId_++,this.log_=dr("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=lo,this.maxReconnectDelay_=jP,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");qc.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Ms.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,i){const o=++this.requestNumber_,r={r:o,a:e,b:n};this.log_(Ne(r)),x(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),i&&(this.requestCBHash_[o]=i)}get(e){this.initConnection_();const n=new Mt,o={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:s=>{const a=s.d;s.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,i,o){this.initConnection_();const r=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+r),this.listens.has(s)||this.listens.set(s,new Map),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),x(!this.listens.get(s).has(r),"listen() called twice for same path/queryId.");const a={onComplete:o,hashFn:n,query:e,tag:i};this.listens.get(s).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(i)})}sendListen_(e){const n=e.query,i=n._path.toString(),o=n._queryIdentifier;this.log_("Listen on "+i+" for "+o);const r={p:i},s="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(s,r,a=>{const c=a.d,d=a.s;Vt.warnOnListenWarnings_(c,n),(this.listens.get(i)&&this.listens.get(i).get(o))===e&&(this.log_("listen response",a),d!=="ok"&&this.removeListen_(i,o),e.onComplete&&e.onComplete(d,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Rt(e,"w")){const i=Li(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const o='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();Qe(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||bN(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Sp)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=qN(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(n,i,o=>{const r=o.s,s=o.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,s))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,i=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,i)})}unlisten(e,n){const i=e._path.toString(),o=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+o),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,o)&&this.connected_&&this.sendUnlisten_(i,o,e._queryObject,n)}sendUnlisten_(e,n,i,o){this.log_("Unlisten on "+e+" for "+n);const r={p:e},s="n";o&&(r.q=i,r.t=o),this.sendRequest(s,r)}onDisconnectPut(e,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:i})}onDisconnectMerge(e,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:i})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,i,o){const r={p:n,d:i};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,s=>{o&&setTimeout(()=>{o(s.s,s.d)},Math.floor(0))})}put(e,n,i,o){this.putInternal("p",e,n,i,o)}merge(e,n,i,o){this.putInternal("m",e,n,i,o)}putInternal(e,n,i,o,r){this.initConnection_();const s={p:n,d:i};r!==void 0&&(s.h=r),this.outstandingPuts_.push({action:e,request:s,onComplete:o}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,o=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,i,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),o&&o(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,i=>{if(i.s!=="ok"){const r=i.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ne(e));const n=e.r,i=this.requestCBHash_[n];i&&(delete this.requestCBHash_[n],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):vu("Unrecognized action received from server: "+Ne(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){x(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=lo,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=lo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>tx&&(this.reconnectDelay_=lo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*ex)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+Vt.nextConnectionId_++,r=this.lastSessionId;let s=!1,a=null;const c=function(){a?a.close():(s=!0,i())},d=function(h){x(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:c,sendRequest:d};const f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,p]=await Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);s?xe("getToken() completed but was canceled"):(xe("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=p&&p.token,a=new JP(o,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,i,m=>{Qe(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(nx)},r))}catch(h){this.log_("Failed to get token: "+h),s||(this.repoInfo_.nodeAdmin&&Qe(h),c())}}}interrupt(e){xe("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){xe("Resuming connection for reason: "+e),delete this.interruptReasons_[e],fu(this.interruptReasons_)&&(this.reconnectDelay_=lo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let i;n?i=n.map(r=>Uc(r)).join("$"):i="default";const o=this.removeListen_(e,i);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(e,n){const i=new X(e).toString();let o;if(this.listens.has(i)){const r=this.listens.get(i);o=r.get(n),r.delete(n),r.size===0&&this.listens.delete(i)}else o=void 0;return o}onAuthRevoked_(e,n){xe("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Ip&&(this.reconnectDelay_=Sp,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){xe("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Ip&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+K_.replace(/\./g,"-")]=1,H_()?e["framework.cordova"]=1:FN()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Ms.getInstance().currentlyOnline();return fu(this.interruptReasons_)&&e}}Vt.nextPersistentConnectionId_=0;Vt.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new b(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const i=new b(Ui,e),o=new b(Ui,n);return this.compare(i,o)!==0}minPost(){return b.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lr;class Ey extends fl{static get __EMPTY_NODE(){return Lr}static set __EMPTY_NODE(e){Lr=e}compare(e,n){return Kn(e.name,n.name)}isDefinedOn(e){throw Ji("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return b.MIN}maxPost(){return new b(Bn,Lr)}makePost(e,n){return x(typeof e=="string","KeyIndex indexValue must always be a string."),new b(e,Lr)}toString(){return".key"}}const wi=new Ey;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,n,i,o,r=null){this.isReverse_=o,this.resultGenerator_=r,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=n?i(e.key,n):1,o&&(s*=-1),s<0)this.isReverse_?e=e.left:e=e.right;else if(s===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Ae{constructor(e,n,i,o,r){this.key=e,this.value=n,this.color=i??Ae.RED,this.left=o??$e.EMPTY_NODE,this.right=r??$e.EMPTY_NODE}copy(e,n,i,o,r){return new Ae(e??this.key,n??this.value,i??this.color,o??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let o=this;const r=i(e,o.key);return r<0?o=o.copy(null,null,null,o.left.insert(e,n,i),null):r===0?o=o.copy(null,n,null,null,null):o=o.copy(null,null,null,null,o.right.insert(e,n,i)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return $e.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let i,o;if(i=this,n(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),n(e,i.key)===0){if(i.right.isEmpty())return $e.EMPTY_NODE;o=i.right.min_(),i=i.copy(o.key,o.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ae.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ae.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Ae.RED=!0;Ae.BLACK=!1;class ix{copy(e,n,i,o,r){return this}insert(e,n,i){return new Ae(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class $e{constructor(e,n=$e.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new $e(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Ae.BLACK,null,null))}remove(e){return new $e(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ae.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,o=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return o?o.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(o=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Fr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Fr(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Fr(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Fr(this.root_,null,this.comparator_,!0,e)}}$e.EMPTY_NODE=new ix;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(t,e){return Kn(t.name,e.name)}function bc(t,e){return Kn(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cu;function rx(t){Cu=t}const Cy=function(t){return typeof t=="number"?"number:"+j_(t):"string:"+t},Ty=function(t){if(t.isLeafNode()){const e=t.val();x(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Rt(e,".sv"),"Priority must be a string or number.")}else x(t===Cu||t.isEmpty(),"priority of unexpected type.");x(t===Cu||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wp;class Ie{constructor(e,n=Ie.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,x(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Ty(this.priorityNode_)}static set __childrenNodeConstructor(e){wp=e}static get __childrenNodeConstructor(){return wp}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ie(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Ie.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return q(e)?this:B(e)===".priority"?this.priorityNode_:Ie.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Ie.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const i=B(e);return i===null?n:n.isEmpty()&&i!==".priority"?this:(x(i!==".priority"||_n(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,Ie.__childrenNodeConstructor.EMPTY_NODE.updateChild(Z(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Cy(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=j_(this.value_):e+=this.value_,this.lazyHash_=X_(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ie.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ie.__childrenNodeConstructor?-1:(x(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,i=typeof this.value_,o=Ie.VALUE_TYPE_ORDER.indexOf(n),r=Ie.VALUE_TYPE_ORDER.indexOf(i);return x(o>=0,"Unknown leaf type: "+n),x(r>=0,"Unknown leaf type: "+i),o===r?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-o}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Ie.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sy,Iy;function sx(t){Sy=t}function lx(t){Iy=t}class ax extends fl{compare(e,n){const i=e.node.getPriority(),o=n.node.getPriority(),r=i.compareTo(o);return r===0?Kn(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return b.MIN}maxPost(){return new b(Bn,new Ie("[PRIORITY-POST]",Iy))}makePost(e,n){const i=Sy(e);return new b(n,new Ie("[PRIORITY-POST]",i))}toString(){return".priority"}}const de=new ax;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux=Math.log(2);class cx{constructor(e){const n=r=>parseInt(Math.log(r)/ux,10),i=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const o=i(this.count);this.bits_=e+1&o}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Ds=function(t,e,n,i){t.sort(e);const o=function(c,d){const f=d-c;let h,p;if(f===0)return null;if(f===1)return h=t[c],p=n?n(h):h,new Ae(p,h.node,Ae.BLACK,null,null);{const m=parseInt(f/2,10)+c,v=o(c,m),E=o(m+1,d);return h=t[m],p=n?n(h):h,new Ae(p,h.node,Ae.BLACK,v,E)}},r=function(c){let d=null,f=null,h=t.length;const p=function(v,E){const S=h-v,_=h;h-=v;const g=o(S+1,_),y=t[S],C=n?n(y):y;m(new Ae(C,y.node,E,null,g))},m=function(v){d?(d.left=v,d=v):(f=v,d=v)};for(let v=0;v<c.count;++v){const E=c.nextBitIsOne(),S=Math.pow(2,c.count-(v+1));E?p(S,Ae.BLACK):(p(S,Ae.BLACK),p(S,Ae.RED))}return f},s=new cx(t.length),a=r(s);return new $e(i||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ta;const Zn={};class Ft{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return x(Zn&&de,"ChildrenNode.ts has not been loaded"),ta=ta||new Ft({".priority":Zn},{".priority":de}),ta}get(e){const n=Li(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof $e?n:null}hasIndex(e){return Rt(this.indexSet_,e.toString())}addIndex(e,n){x(e!==wi,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let o=!1;const r=n.getIterator(b.Wrap);let s=r.getNext();for(;s;)o=o||e.isDefinedOn(s.node),i.push(s),s=r.getNext();let a;o?a=Ds(i,e.getCompare()):a=Zn;const c=e.toString(),d=Object.assign({},this.indexSet_);d[c]=e;const f=Object.assign({},this.indexes_);return f[c]=a,new Ft(f,d)}addToIndexes(e,n){const i=Rs(this.indexes_,(o,r)=>{const s=Li(this.indexSet_,r);if(x(s,"Missing index implementation for "+r),o===Zn)if(s.isDefinedOn(e.node)){const a=[],c=n.getIterator(b.Wrap);let d=c.getNext();for(;d;)d.name!==e.name&&a.push(d),d=c.getNext();return a.push(e),Ds(a,s.getCompare())}else return Zn;else{const a=n.get(e.name);let c=o;return a&&(c=c.remove(new b(e.name,a))),c.insert(e,e.node)}});return new Ft(i,this.indexSet_)}removeFromIndexes(e,n){const i=Rs(this.indexes_,o=>{if(o===Zn)return o;{const r=n.get(e.name);return r?o.remove(new b(e.name,r)):o}});return new Ft(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ao;class G{constructor(e,n,i){this.children_=e,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Ty(this.priorityNode_),this.children_.isEmpty()&&x(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ao||(ao=new G(new $e(bc),null,Ft.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ao}updatePriority(e){return this.children_.isEmpty()?this:new G(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?ao:n}}getChild(e){const n=B(e);return n===null?this:this.getImmediateChild(n).getChild(Z(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(x(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const i=new b(e,n);let o,r;n.isEmpty()?(o=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(i,this.children_));const s=o.isEmpty()?ao:this.priorityNode_;return new G(o,s,r)}}updateChild(e,n){const i=B(e);if(i===null)return n;{x(B(e)!==".priority"||_n(e)===1,".priority must be the last token in a path");const o=this.getImmediateChild(i).updateChild(Z(e),n);return this.updateImmediateChild(i,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let i=0,o=0,r=!0;if(this.forEachChild(de,(s,a)=>{n[s]=a.val(e),i++,r&&G.INTEGER_REGEXP_.test(s)?o=Math.max(o,Number(s)):r=!1}),!e&&r&&o<2*i){const s=[];for(const a in n)s[a]=n[a];return s}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Cy(this.getPriority().val())+":"),this.forEachChild(de,(n,i)=>{const o=i.hash();o!==""&&(e+=":"+n+":"+o)}),this.lazyHash_=e===""?"":X_(e)}return this.lazyHash_}getPredecessorChildName(e,n,i){const o=this.resolveIndex_(i);if(o){const r=o.getPredecessorKey(new b(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const i=n.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new b(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const i=n.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new b(n,this.children_.get(n)):null}forEachChild(e,n){const i=this.resolveIndex_(e);return i?i.inorderTraversal(o=>n(o.name,o.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const i=this.resolveIndex_(n);if(i)return i.getIteratorFrom(e,o=>o);{const o=this.children_.getIteratorFrom(e.name,b.Wrap);let r=o.peek();for(;r!=null&&n.compare(r,e)<0;)o.getNext(),r=o.peek();return o}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const i=this.resolveIndex_(n);if(i)return i.getReverseIteratorFrom(e,o=>o);{const o=this.children_.getReverseIteratorFrom(e.name,b.Wrap);let r=o.peek();for(;r!=null&&n.compare(r,e)>0;)o.getNext(),r=o.peek();return o}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===fr?-1:0}withIndex(e){if(e===wi||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new G(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===wi||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const i=this.getIterator(de),o=n.getIterator(de);let r=i.getNext(),s=o.getNext();for(;r&&s;){if(r.name!==s.name||!r.node.equals(s.node))return!1;r=i.getNext(),s=o.getNext()}return r===null&&s===null}else return!1;else return!1}}resolveIndex_(e){return e===wi?null:this.indexMap_.get(e.toString())}}G.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class dx extends G{constructor(){super(new $e(bc),G.EMPTY_NODE,Ft.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return G.EMPTY_NODE}isEmpty(){return!1}}const fr=new dx;Object.defineProperties(b,{MIN:{value:new b(Ui,G.EMPTY_NODE)},MAX:{value:new b(Bn,fr)}});Ey.__EMPTY_NODE=G.EMPTY_NODE;Ie.__childrenNodeConstructor=G;rx(fr);lx(fr);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx=!0;function ye(t,e=null){if(t===null)return G.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),x(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Ie(n,ye(e))}if(!(t instanceof Array)&&fx){const n=[];let i=!1;if(Ge(t,(s,a)=>{if(s.substring(0,1)!=="."){const c=ye(a);c.isEmpty()||(i=i||!c.getPriority().isEmpty(),n.push(new b(s,c)))}}),n.length===0)return G.EMPTY_NODE;const r=Ds(n,ox,s=>s.name,bc);if(i){const s=Ds(n,de.getCompare());return new G(r,ye(e),new Ft({".priority":s},{".priority":de}))}else return new G(r,ye(e),Ft.Default)}else{let n=G.EMPTY_NODE;return Ge(t,(i,o)=>{if(Rt(t,i)&&i.substring(0,1)!=="."){const r=ye(o);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(i,r))}}),n.updatePriority(ye(e))}}sx(ye);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx extends fl{constructor(e){super(),this.indexPath_=e,x(!q(e)&&B(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const i=this.extractChild(e.node),o=this.extractChild(n.node),r=i.compareTo(o);return r===0?Kn(e.name,n.name):r}makePost(e,n){const i=ye(e),o=G.EMPTY_NODE.updateChild(this.indexPath_,i);return new b(n,o)}maxPost(){const e=G.EMPTY_NODE.updateChild(this.indexPath_,fr);return new b(Bn,e)}toString(){return Xo(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px extends fl{compare(e,n){const i=e.node.compareTo(n.node);return i===0?Kn(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return b.MIN}maxPost(){return b.MAX}makePost(e,n){const i=ye(e);return new b(n,i)}toString(){return".value"}}const mx=new px;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wy(t){return{type:"value",snapshotNode:t}}function Vi(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Zo(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function jo(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function gx(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e){this.index_=e}updateChild(e,n,i,o,r,s){x(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(o).equals(i.getChild(o))&&a.isEmpty()===i.isEmpty()||(s!=null&&(i.isEmpty()?e.hasChild(n)?s.trackChildChange(Zo(n,a)):x(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(Vi(n,i)):s.trackChildChange(jo(n,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(de,(o,r)=>{n.hasChild(o)||i.trackChildChange(Zo(o,r))}),n.isLeafNode()||n.forEachChild(de,(o,r)=>{if(e.hasChild(o)){const s=e.getImmediateChild(o);s.equals(r)||i.trackChildChange(jo(o,r,s))}else i.trackChildChange(Vi(o,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?G.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this.indexedFilter_=new zc(e.getIndex()),this.index_=e.getIndex(),this.startPost_=er.getStartPost_(e),this.endPost_=er.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&i}updateChild(e,n,i,o,r,s){return this.matches(new b(n,i))||(i=G.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,o,r,s)}updateFullNode(e,n,i){n.isLeafNode()&&(n=G.EMPTY_NODE);let o=n.withIndex(this.index_);o=o.updatePriority(G.EMPTY_NODE);const r=this;return n.forEachChild(de,(s,a)=>{r.matches(new b(s,a))||(o=o.updateImmediateChild(s,G.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,o,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{const i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new er(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,i,o,r,s){return this.rangedFilter_.matches(new b(n,i))||(i=G.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,o,r,s):this.fullLimitUpdateChild_(e,n,i,r,s)}updateFullNode(e,n,i){let o;if(n.isLeafNode()||n.isEmpty())o=G.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){o=G.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let s=0;for(;r.hasNext()&&s<this.limit_;){const a=r.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))o=o.updateImmediateChild(a.name,a.node),s++;else break;else continue}}else{o=n.withIndex(this.index_),o=o.updatePriority(G.EMPTY_NODE);let r;this.reverse_?r=o.getReverseIterator(this.index_):r=o.getIterator(this.index_);let s=0;for(;r.hasNext();){const a=r.getNext();s<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?s++:o=o.updateImmediateChild(a.name,G.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,o,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,o,r){let s;if(this.reverse_){const h=this.index_.getCompare();s=(p,m)=>h(m,p)}else s=this.index_.getCompare();const a=e;x(a.numChildren()===this.limit_,"");const c=new b(n,i),d=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),f=this.rangedFilter_.matches(c);if(a.hasChild(n)){const h=a.getImmediateChild(n);let p=o.getChildAfterChild(this.index_,d,this.reverse_);for(;p!=null&&(p.name===n||a.hasChild(p.name));)p=o.getChildAfterChild(this.index_,p,this.reverse_);const m=p==null?1:s(p,c);if(f&&!i.isEmpty()&&m>=0)return r!=null&&r.trackChildChange(jo(n,i,h)),a.updateImmediateChild(n,i);{r!=null&&r.trackChildChange(Zo(n,h));const E=a.updateImmediateChild(n,G.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(r!=null&&r.trackChildChange(Vi(p.name,p.node)),E.updateImmediateChild(p.name,p.node)):E}}else return i.isEmpty()?e:f&&s(d,c)>=0?(r!=null&&(r.trackChildChange(Zo(d.name,d.node)),r.trackChildChange(Vi(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(d.name,G.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=de}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return x(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return x(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ui}hasEnd(){return this.endSet_}getIndexEndValue(){return x(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return x(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Bn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return x(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===de}copy(){const e=new Wc;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function yx(t){return t.loadsAllData()?new zc(t.getIndex()):t.hasLimit()?new _x(t):new er(t)}function Ap(t){const e={};if(t.isDefault())return e;let n;if(t.index_===de?n="$priority":t.index_===mx?n="$value":t.index_===wi?n="$key":(x(t.index_ instanceof hx,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ne(n),t.startSet_){const i=t.startAfterSet_?"startAfter":"startAt";e[i]=Ne(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+Ne(t.indexStartName_))}if(t.endSet_){const i=t.endBeforeSet_?"endBefore":"endAt";e[i]=Ne(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+Ne(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Np(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==de&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls extends gy{constructor(e,n,i,o){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=o,this.log_=dr("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(x(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,o){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const s=Ls.getListenId_(e,i),a={};this.listens_[s]=a;const c=Ap(e._queryParams);this.restRequest_(r+".json",c,(d,f)=>{let h=f;if(d===404&&(h=null,d=null),d===null&&this.onDataUpdate_(r,h,!1,i),Li(this.listens_,s)===a){let p;d?d===401?p="permission_denied":p="rest_error:"+d:p="ok",o(p,null)}})}unlisten(e,n){const i=Ls.getListenId_(e,n);delete this.listens_[i]}get(e){const n=Ap(e._queryParams),i=e._path.toString(),o=new Mt;return this.restRequest_(i+".json",n,(r,s)=>{let a=s;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(i,a,!1,null),o.resolve(a)):o.reject(new Error(a))}),o.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([o,r])=>{o&&o.accessToken&&(n.auth=o.accessToken),r&&r.token&&(n.ac=r.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+zN(n);this.log_("Sending REST request for "+s);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Jo(a.responseText)}catch{Qe("Failed to parse JSON response for "+s+": "+a.responseText)}i(null,c)}else a.status!==401&&a.status!==404&&Qe("Got unsuccessful REST response for "+s+" Status: "+a.status),i(a.status);i=null}},a.open("GET",s,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(){this.rootNode_=G.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(){return{value:null,children:new Map}}function Ki(t,e,n){if(q(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const i=B(e);t.children.has(i)||t.children.set(i,Fs());const o=t.children.get(i);e=Z(e),Ki(o,e,n)}}function Tu(t,e){if(q(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(de,(i,o)=>{Ki(t,new X(i),o)}),Tu(t,e)}}else if(t.children.size>0){const n=B(e);return e=Z(e),t.children.has(n)&&Tu(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Su(t,e,n){t.value!==null?n(e,t.value):Ex(t,(i,o)=>{const r=new X(e.toString()+"/"+i);Su(o,r,n)})}function Ex(t,e){t.children.forEach((n,i)=>{e(i,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Ge(this.last_,(i,o)=>{n[i]=n[i]-o}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp=10*1e3,Tx=30*1e3,Sx=5*60*1e3;class Ix{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Cx(e);const i=Rp+(Tx-Rp)*Math.random();Ao(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),n={};let i=!1;Ge(e,(o,r)=>{r>0&&Rt(this.statsToReport_,o)&&(n[o]=r,i=!0)}),i&&this.server_.reportStats(n),Ao(this.reportStats_.bind(this),Math.floor(Math.random()*2*Sx))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gt;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(gt||(gt={}));function Ay(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function $c(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Jc(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=gt.ACK_USER_WRITE,this.source=Ay()}operationForChild(e){if(q(this.path)){if(this.affectedTree.value!=null)return x(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new X(e));return new Us(K(),n,this.revert)}}else return x(B(this.path)===e,"operationForChild called for unrelated child."),new Us(Z(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n){this.source=e,this.path=n,this.type=gt.LISTEN_COMPLETE}operationForChild(e){return q(this.path)?new tr(this.source,K()):new tr(this.source,Z(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=gt.OVERWRITE}operationForChild(e){return q(this.path)?new qn(this.source,K(),this.snap.getImmediateChild(e)):new qn(this.source,Z(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=gt.MERGE}operationForChild(e){if(q(this.path)){const n=this.children.subtree(new X(e));return n.isEmpty()?null:n.value?new qn(this.source,K(),n.value):new nr(this.source,K(),n)}else return x(B(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new nr(this.source,Z(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(q(e))return this.isFullyInitialized()&&!this.filtered_;const n=B(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Ax(t,e,n,i){const o=[],r=[];return e.forEach(s=>{s.type==="child_changed"&&t.index_.indexedValueChanged(s.oldSnap,s.snapshotNode)&&r.push(gx(s.childName,s.snapshotNode))}),uo(t,o,"child_removed",e,i,n),uo(t,o,"child_added",e,i,n),uo(t,o,"child_moved",r,i,n),uo(t,o,"child_changed",e,i,n),uo(t,o,"value",e,i,n),o}function uo(t,e,n,i,o,r){const s=i.filter(a=>a.type===n);s.sort((a,c)=>Rx(t,a,c)),s.forEach(a=>{const c=Nx(t,a,r);o.forEach(d=>{d.respondsTo(a.type)&&e.push(d.createEvent(c,t.query_))})})}function Nx(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Rx(t,e,n){if(e.childName==null||n.childName==null)throw Ji("Should only compare child_ events.");const i=new b(e.childName,e.snapshotNode),o=new b(n.childName,n.snapshotNode);return t.index_.compare(i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hl(t,e){return{eventCache:t,serverCache:e}}function No(t,e,n,i){return hl(new bn(e,n,i),t.serverCache)}function Ny(t,e,n,i){return hl(t.eventCache,new bn(e,n,i))}function Iu(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function zn(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let na;const Px=()=>(na||(na=new $e(hP)),na);class se{constructor(e,n=Px()){this.value=e,this.children=n}static fromObject(e){let n=new se(null);return Ge(e,(i,o)=>{n=n.set(new X(i),o)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:K(),value:this.value};if(q(e))return null;{const i=B(e),o=this.children.get(i);if(o!==null){const r=o.findRootMostMatchingPathAndValue(Z(e),n);return r!=null?{path:_e(new X(i),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(q(e))return this;{const n=B(e),i=this.children.get(n);return i!==null?i.subtree(Z(e)):new se(null)}}set(e,n){if(q(e))return new se(n,this.children);{const i=B(e),r=(this.children.get(i)||new se(null)).set(Z(e),n),s=this.children.insert(i,r);return new se(this.value,s)}}remove(e){if(q(e))return this.children.isEmpty()?new se(null):new se(null,this.children);{const n=B(e),i=this.children.get(n);if(i){const o=i.remove(Z(e));let r;return o.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,o),this.value===null&&r.isEmpty()?new se(null):new se(this.value,r)}else return this}}get(e){if(q(e))return this.value;{const n=B(e),i=this.children.get(n);return i?i.get(Z(e)):null}}setTree(e,n){if(q(e))return n;{const i=B(e),r=(this.children.get(i)||new se(null)).setTree(Z(e),n);let s;return r.isEmpty()?s=this.children.remove(i):s=this.children.insert(i,r),new se(this.value,s)}}fold(e){return this.fold_(K(),e)}fold_(e,n){const i={};return this.children.inorderTraversal((o,r)=>{i[o]=r.fold_(_e(e,o),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,K(),n)}findOnPath_(e,n,i){const o=this.value?i(n,this.value):!1;if(o)return o;if(q(e))return null;{const r=B(e),s=this.children.get(r);return s?s.findOnPath_(Z(e),_e(n,r),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,K(),n)}foreachOnPath_(e,n,i){if(q(e))return this;{this.value&&i(n,this.value);const o=B(e),r=this.children.get(o);return r?r.foreachOnPath_(Z(e),_e(n,o),i):new se(null)}}foreach(e){this.foreach_(K(),e)}foreach_(e,n){this.children.inorderTraversal((i,o)=>{o.foreach_(_e(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.writeTree_=e}static empty(){return new vt(new se(null))}}function Ro(t,e,n){if(q(e))return new vt(new se(n));{const i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){const o=i.path;let r=i.value;const s=We(o,e);return r=r.updateChild(s,n),new vt(t.writeTree_.set(o,r))}else{const o=new se(n),r=t.writeTree_.setTree(e,o);return new vt(r)}}}function Pp(t,e,n){let i=t;return Ge(n,(o,r)=>{i=Ro(i,_e(e,o),r)}),i}function xp(t,e){if(q(e))return vt.empty();{const n=t.writeTree_.setTree(e,new se(null));return new vt(n)}}function wu(t,e){return Qn(t,e)!=null}function Qn(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(We(n.path,e)):null}function kp(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(de,(i,o)=>{e.push(new b(i,o))}):t.writeTree_.children.inorderTraversal((i,o)=>{o.value!=null&&e.push(new b(i,o.value))}),e}function pn(t,e){if(q(e))return t;{const n=Qn(t,e);return n!=null?new vt(new se(n)):new vt(t.writeTree_.subtree(e))}}function Au(t){return t.writeTree_.isEmpty()}function Gi(t,e){return Ry(K(),t.writeTree_,e)}function Ry(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((o,r)=>{o===".priority"?(x(r.value!==null,"Priority writes must always be leaf nodes"),i=r.value):n=Ry(_e(t,o),r,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(_e(t,".priority"),i)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yc(t,e){return My(e,t)}function xx(t,e,n,i,o){x(i>t.lastWriteId,"Stacking an older write on top of newer ones"),o===void 0&&(o=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:o}),o&&(t.visibleWrites=Ro(t.visibleWrites,e,n)),t.lastWriteId=i}function kx(t,e){for(let n=0;n<t.allWrites.length;n++){const i=t.allWrites[n];if(i.writeId===e)return i}return null}function Mx(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);x(n>=0,"removeWrite called with nonexistent writeId.");const i=t.allWrites[n];t.allWrites.splice(n,1);let o=i.visible,r=!1,s=t.allWrites.length-1;for(;o&&s>=0;){const a=t.allWrites[s];a.visible&&(s>=n&&Dx(a,i.path)?o=!1:st(i.path,a.path)&&(r=!0)),s--}if(o){if(r)return Lx(t),!0;if(i.snap)t.visibleWrites=xp(t.visibleWrites,i.path);else{const a=i.children;Ge(a,c=>{t.visibleWrites=xp(t.visibleWrites,_e(i.path,c))})}return!0}else return!1}function Dx(t,e){if(t.snap)return st(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&st(_e(t.path,n),e))return!0;return!1}function Lx(t){t.visibleWrites=Py(t.allWrites,Fx,K()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Fx(t){return t.visible}function Py(t,e,n){let i=vt.empty();for(let o=0;o<t.length;++o){const r=t[o];if(e(r)){const s=r.path;let a;if(r.snap)st(n,s)?(a=We(n,s),i=Ro(i,a,r.snap)):st(s,n)&&(a=We(s,n),i=Ro(i,K(),r.snap.getChild(a)));else if(r.children){if(st(n,s))a=We(n,s),i=Pp(i,a,r.children);else if(st(s,n))if(a=We(s,n),q(a))i=Pp(i,K(),r.children);else{const c=Li(r.children,B(a));if(c){const d=c.getChild(Z(a));i=Ro(i,K(),d)}}}else throw Ji("WriteRecord should have .snap or .children")}}return i}function xy(t,e,n,i,o){if(!i&&!o){const r=Qn(t.visibleWrites,e);if(r!=null)return r;{const s=pn(t.visibleWrites,e);if(Au(s))return n;if(n==null&&!wu(s,K()))return null;{const a=n||G.EMPTY_NODE;return Gi(s,a)}}}else{const r=pn(t.visibleWrites,e);if(!o&&Au(r))return n;if(!o&&n==null&&!wu(r,K()))return null;{const s=function(d){return(d.visible||o)&&(!i||!~i.indexOf(d.writeId))&&(st(d.path,e)||st(e,d.path))},a=Py(t.allWrites,s,e),c=n||G.EMPTY_NODE;return Gi(a,c)}}}function Ux(t,e,n){let i=G.EMPTY_NODE;const o=Qn(t.visibleWrites,e);if(o)return o.isLeafNode()||o.forEachChild(de,(r,s)=>{i=i.updateImmediateChild(r,s)}),i;if(n){const r=pn(t.visibleWrites,e);return n.forEachChild(de,(s,a)=>{const c=Gi(pn(r,new X(s)),a);i=i.updateImmediateChild(s,c)}),kp(r).forEach(s=>{i=i.updateImmediateChild(s.name,s.node)}),i}else{const r=pn(t.visibleWrites,e);return kp(r).forEach(s=>{i=i.updateImmediateChild(s.name,s.node)}),i}}function Vx(t,e,n,i,o){x(i||o,"Either existingEventSnap or existingServerSnap must exist");const r=_e(e,n);if(wu(t.visibleWrites,r))return null;{const s=pn(t.visibleWrites,r);return Au(s)?o.getChild(n):Gi(s,o.getChild(n))}}function Gx(t,e,n,i){const o=_e(e,n),r=Qn(t.visibleWrites,o);if(r!=null)return r;if(i.isCompleteForChild(n)){const s=pn(t.visibleWrites,o);return Gi(s,i.getNode().getImmediateChild(n))}else return null}function Ox(t,e){return Qn(t.visibleWrites,e)}function Hx(t,e,n,i,o,r,s){let a;const c=pn(t.visibleWrites,e),d=Qn(c,K());if(d!=null)a=d;else if(n!=null)a=Gi(c,n);else return[];if(a=a.withIndex(s),!a.isEmpty()&&!a.isLeafNode()){const f=[],h=s.getCompare(),p=r?a.getReverseIteratorFrom(i,s):a.getIteratorFrom(i,s);let m=p.getNext();for(;m&&f.length<o;)h(m,i)!==0&&f.push(m),m=p.getNext();return f}else return[]}function Bx(){return{visibleWrites:vt.empty(),allWrites:[],lastWriteId:-1}}function Vs(t,e,n,i){return xy(t.writeTree,t.treePath,e,n,i)}function Kc(t,e){return Ux(t.writeTree,t.treePath,e)}function Mp(t,e,n,i){return Vx(t.writeTree,t.treePath,e,n,i)}function Gs(t,e){return Ox(t.writeTree,_e(t.treePath,e))}function qx(t,e,n,i,o,r){return Hx(t.writeTree,t.treePath,e,n,i,o,r)}function Qc(t,e,n){return Gx(t.writeTree,t.treePath,e,n)}function ky(t,e){return My(_e(t.treePath,e),t.writeTree)}function My(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,i=e.childName;x(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),x(i!==".priority","Only non-priority child changes can be tracked.");const o=this.changeMap.get(i);if(o){const r=o.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(i,jo(i,e.snapshotNode,o.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(i,Zo(i,o.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(i,Vi(i,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(i,jo(i,e.snapshotNode,o.oldSnap));else throw Ji("Illegal combination of changes: "+e+" occurred after "+o)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}}const Dy=new zx;class Xc{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new bn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Qc(this.writes_,e,i)}}getChildAfterChild(e,n,i){const o=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:zn(this.viewCache_),r=qx(this.writes_,o,n,1,i,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(t){return{filter:t}}function $x(t,e){x(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),x(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function Jx(t,e,n,i,o){const r=new bx;let s,a;if(n.type===gt.OVERWRITE){const d=n;d.source.fromUser?s=Nu(t,e,d.path,d.snap,i,o,r):(x(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered()&&!q(d.path),s=Os(t,e,d.path,d.snap,i,o,a,r))}else if(n.type===gt.MERGE){const d=n;d.source.fromUser?s=Kx(t,e,d.path,d.children,i,o,r):(x(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered(),s=Ru(t,e,d.path,d.children,i,o,a,r))}else if(n.type===gt.ACK_USER_WRITE){const d=n;d.revert?s=Zx(t,e,d.path,i,o,r):s=Qx(t,e,d.path,d.affectedTree,i,o,r)}else if(n.type===gt.LISTEN_COMPLETE)s=Xx(t,e,n.path,i,r);else throw Ji("Unknown operation type: "+n.type);const c=r.getChanges();return Yx(e,s,c),{viewCache:s,changes:c}}function Yx(t,e,n){const i=e.eventCache;if(i.isFullyInitialized()){const o=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=Iu(t);(n.length>0||!t.eventCache.isFullyInitialized()||o&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&n.push(wy(Iu(e)))}}function Ly(t,e,n,i,o,r){const s=e.eventCache;if(Gs(i,n)!=null)return e;{let a,c;if(q(n))if(x(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=zn(e),f=d instanceof G?d:G.EMPTY_NODE,h=Kc(i,f);a=t.filter.updateFullNode(e.eventCache.getNode(),h,r)}else{const d=Vs(i,zn(e));a=t.filter.updateFullNode(e.eventCache.getNode(),d,r)}else{const d=B(n);if(d===".priority"){x(_n(n)===1,"Can't have a priority with additional path components");const f=s.getNode();c=e.serverCache.getNode();const h=Mp(i,n,f,c);h!=null?a=t.filter.updatePriority(f,h):a=s.getNode()}else{const f=Z(n);let h;if(s.isCompleteForChild(d)){c=e.serverCache.getNode();const p=Mp(i,n,s.getNode(),c);p!=null?h=s.getNode().getImmediateChild(d).updateChild(f,p):h=s.getNode().getImmediateChild(d)}else h=Qc(i,d,e.serverCache);h!=null?a=t.filter.updateChild(s.getNode(),d,h,f,o,r):a=s.getNode()}}return No(e,a,s.isFullyInitialized()||q(n),t.filter.filtersNodes())}}function Os(t,e,n,i,o,r,s,a){const c=e.serverCache;let d;const f=s?t.filter:t.filter.getIndexedFilter();if(q(n))d=f.updateFullNode(c.getNode(),i,null);else if(f.filtersNodes()&&!c.isFiltered()){const m=c.getNode().updateChild(n,i);d=f.updateFullNode(c.getNode(),m,null)}else{const m=B(n);if(!c.isCompleteForPath(n)&&_n(n)>1)return e;const v=Z(n),S=c.getNode().getImmediateChild(m).updateChild(v,i);m===".priority"?d=f.updatePriority(c.getNode(),S):d=f.updateChild(c.getNode(),m,S,v,Dy,null)}const h=Ny(e,d,c.isFullyInitialized()||q(n),f.filtersNodes()),p=new Xc(o,h,r);return Ly(t,h,n,o,p,a)}function Nu(t,e,n,i,o,r,s){const a=e.eventCache;let c,d;const f=new Xc(o,e,r);if(q(n))d=t.filter.updateFullNode(e.eventCache.getNode(),i,s),c=No(e,d,!0,t.filter.filtersNodes());else{const h=B(n);if(h===".priority")d=t.filter.updatePriority(e.eventCache.getNode(),i),c=No(e,d,a.isFullyInitialized(),a.isFiltered());else{const p=Z(n),m=a.getNode().getImmediateChild(h);let v;if(q(p))v=i;else{const E=f.getCompleteChild(h);E!=null?Hc(p)===".priority"&&E.getChild(yy(p)).isEmpty()?v=E:v=E.updateChild(p,i):v=G.EMPTY_NODE}if(m.equals(v))c=e;else{const E=t.filter.updateChild(a.getNode(),h,v,p,f,s);c=No(e,E,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function Dp(t,e){return t.eventCache.isCompleteForChild(e)}function Kx(t,e,n,i,o,r,s){let a=e;return i.foreach((c,d)=>{const f=_e(n,c);Dp(e,B(f))&&(a=Nu(t,a,f,d,o,r,s))}),i.foreach((c,d)=>{const f=_e(n,c);Dp(e,B(f))||(a=Nu(t,a,f,d,o,r,s))}),a}function Lp(t,e,n){return n.foreach((i,o)=>{e=e.updateChild(i,o)}),e}function Ru(t,e,n,i,o,r,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,d;q(n)?d=i:d=new se(null).setTree(n,i);const f=e.serverCache.getNode();return d.children.inorderTraversal((h,p)=>{if(f.hasChild(h)){const m=e.serverCache.getNode().getImmediateChild(h),v=Lp(t,m,p);c=Os(t,c,new X(h),v,o,r,s,a)}}),d.children.inorderTraversal((h,p)=>{const m=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!f.hasChild(h)&&!m){const v=e.serverCache.getNode().getImmediateChild(h),E=Lp(t,v,p);c=Os(t,c,new X(h),E,o,r,s,a)}}),c}function Qx(t,e,n,i,o,r,s){if(Gs(o,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(i.value!=null){if(q(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Os(t,e,n,c.getNode().getChild(n),o,r,a,s);if(q(n)){let d=new se(null);return c.getNode().forEachChild(wi,(f,h)=>{d=d.set(new X(f),h)}),Ru(t,e,n,d,o,r,a,s)}else return e}else{let d=new se(null);return i.foreach((f,h)=>{const p=_e(n,f);c.isCompleteForPath(p)&&(d=d.set(f,c.getNode().getChild(p)))}),Ru(t,e,n,d,o,r,a,s)}}function Xx(t,e,n,i,o){const r=e.serverCache,s=Ny(e,r.getNode(),r.isFullyInitialized()||q(n),r.isFiltered());return Ly(t,s,n,i,Dy,o)}function Zx(t,e,n,i,o,r){let s;if(Gs(i,n)!=null)return e;{const a=new Xc(i,e,o),c=e.eventCache.getNode();let d;if(q(n)||B(n)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=Vs(i,zn(e));else{const h=e.serverCache.getNode();x(h instanceof G,"serverChildren would be complete if leaf node"),f=Kc(i,h)}f=f,d=t.filter.updateFullNode(c,f,r)}else{const f=B(n);let h=Qc(i,f,e.serverCache);h==null&&e.serverCache.isCompleteForChild(f)&&(h=c.getImmediateChild(f)),h!=null?d=t.filter.updateChild(c,f,h,Z(n),a,r):e.eventCache.getNode().hasChild(f)?d=t.filter.updateChild(c,f,G.EMPTY_NODE,Z(n),a,r):d=c,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(s=Vs(i,zn(e)),s.isLeafNode()&&(d=t.filter.updateFullNode(d,s,r)))}return s=e.serverCache.isFullyInitialized()||Gs(i,K())!=null,No(e,d,s,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,o=new zc(i.getIndex()),r=yx(i);this.processor_=Wx(r);const s=n.serverCache,a=n.eventCache,c=o.updateFullNode(G.EMPTY_NODE,s.getNode(),null),d=r.updateFullNode(G.EMPTY_NODE,a.getNode(),null),f=new bn(c,s.isFullyInitialized(),o.filtersNodes()),h=new bn(d,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=hl(h,f),this.eventGenerator_=new wx(this.query_)}get query(){return this.query_}}function ek(t){return t.viewCache_.serverCache.getNode()}function tk(t,e){const n=zn(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!q(e)&&!n.getImmediateChild(B(e)).isEmpty())?n.getChild(e):null}function Fp(t){return t.eventRegistrations_.length===0}function nk(t,e){t.eventRegistrations_.push(e)}function Up(t,e,n){const i=[];if(n){x(e==null,"A cancel should cancel all event registrations.");const o=t.query._path;t.eventRegistrations_.forEach(r=>{const s=r.createCancelEvent(n,o);s&&i.push(s)})}if(e){let o=[];for(let r=0;r<t.eventRegistrations_.length;++r){const s=t.eventRegistrations_[r];if(!s.matches(e))o.push(s);else if(e.hasAnyCallback()){o=o.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=o}else t.eventRegistrations_=[];return i}function Vp(t,e,n,i){e.type===gt.MERGE&&e.source.queryId!==null&&(x(zn(t.viewCache_),"We should always have a full cache before handling merges"),x(Iu(t.viewCache_),"Missing event cache, even though we have a server cache"));const o=t.viewCache_,r=Jx(t.processor_,o,e,n,i);return $x(t.processor_,r.viewCache),x(r.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,Fy(t,r.changes,r.viewCache.eventCache.getNode(),null)}function ik(t,e){const n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(de,(r,s)=>{i.push(Vi(r,s))}),n.isFullyInitialized()&&i.push(wy(n.getNode())),Fy(t,i,n.getNode(),e)}function Fy(t,e,n,i){const o=i?[i]:t.eventRegistrations_;return Ax(t.eventGenerator_,e,n,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hs;class ok{constructor(){this.views=new Map}}function rk(t){x(!Hs,"__referenceConstructor has already been defined"),Hs=t}function sk(){return x(Hs,"Reference.ts has not been loaded"),Hs}function lk(t){return t.views.size===0}function Zc(t,e,n,i){const o=e.source.queryId;if(o!==null){const r=t.views.get(o);return x(r!=null,"SyncTree gave us an op for an invalid query."),Vp(r,e,n,i)}else{let r=[];for(const s of t.views.values())r=r.concat(Vp(s,e,n,i));return r}}function ak(t,e,n,i,o){const r=e._queryIdentifier,s=t.views.get(r);if(!s){let a=Vs(n,o?i:null),c=!1;a?c=!0:i instanceof G?(a=Kc(n,i),c=!1):(a=G.EMPTY_NODE,c=!1);const d=hl(new bn(a,c,!1),new bn(i,o,!1));return new jx(e,d)}return s}function uk(t,e,n,i,o,r){const s=ak(t,e,i,o,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,s),nk(s,n),ik(s,n)}function ck(t,e,n,i){const o=e._queryIdentifier,r=[];let s=[];const a=yn(t);if(o==="default")for(const[c,d]of t.views.entries())s=s.concat(Up(d,n,i)),Fp(d)&&(t.views.delete(c),d.query._queryParams.loadsAllData()||r.push(d.query));else{const c=t.views.get(o);c&&(s=s.concat(Up(c,n,i)),Fp(c)&&(t.views.delete(o),c.query._queryParams.loadsAllData()||r.push(c.query)))}return a&&!yn(t)&&r.push(new(sk())(e._repo,e._path)),{removed:r,events:s}}function Uy(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ai(t,e){let n=null;for(const i of t.views.values())n=n||tk(i,e);return n}function Vy(t,e){if(e._queryParams.loadsAllData())return pl(t);{const i=e._queryIdentifier;return t.views.get(i)}}function Gy(t,e){return Vy(t,e)!=null}function yn(t){return pl(t)!=null}function pl(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bs;function dk(t){x(!Bs,"__referenceConstructor has already been defined"),Bs=t}function fk(){return x(Bs,"Reference.ts has not been loaded"),Bs}let hk=1;class Gp{constructor(e){this.listenProvider_=e,this.syncPointTree_=new se(null),this.pendingWriteTree_=Bx(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Oy(t,e,n,i,o){return xx(t.pendingWriteTree_,e,n,i,o),o?hr(t,new qn(Ay(),e,n)):[]}function Dn(t,e,n=!1){const i=kx(t.pendingWriteTree_,e);if(Mx(t.pendingWriteTree_,e)){let r=new se(null);return i.snap!=null?r=r.set(K(),!0):Ge(i.children,s=>{r=r.set(new X(s),!0)}),hr(t,new Us(i.path,r,n))}else return[]}function ml(t,e,n){return hr(t,new qn($c(),e,n))}function pk(t,e,n){const i=se.fromObject(n);return hr(t,new nr($c(),e,i))}function mk(t,e){return hr(t,new tr($c(),e))}function gk(t,e,n){const i=ed(t,n);if(i){const o=td(i),r=o.path,s=o.queryId,a=We(r,e),c=new tr(Jc(s),a);return nd(t,r,c)}else return[]}function Pu(t,e,n,i,o=!1){const r=e._path,s=t.syncPointTree_.get(r);let a=[];if(s&&(e._queryIdentifier==="default"||Gy(s,e))){const c=ck(s,e,n,i);lk(s)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const d=c.removed;if(a=c.events,!o){const f=d.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(r,(p,m)=>yn(m));if(f&&!h){const p=t.syncPointTree_.subtree(r);if(!p.isEmpty()){const m=vk(p);for(let v=0;v<m.length;++v){const E=m[v],S=E.query,_=qy(t,E);t.listenProvider_.startListening(Po(S),qs(t,S),_.hashFn,_.onComplete)}}}!h&&d.length>0&&!i&&(f?t.listenProvider_.stopListening(Po(e),null):d.forEach(p=>{const m=t.queryToTagMap.get(gl(p));t.listenProvider_.stopListening(Po(p),m)}))}Ek(t,d)}return a}function _k(t,e,n,i){const o=ed(t,i);if(o!=null){const r=td(o),s=r.path,a=r.queryId,c=We(s,e),d=new qn(Jc(a),c,n);return nd(t,s,d)}else return[]}function yk(t,e,n,i){const o=ed(t,i);if(o){const r=td(o),s=r.path,a=r.queryId,c=We(s,e),d=se.fromObject(n),f=new nr(Jc(a),c,d);return nd(t,s,f)}else return[]}function Op(t,e,n,i=!1){const o=e._path;let r=null,s=!1;t.syncPointTree_.foreachOnPath(o,(p,m)=>{const v=We(p,o);r=r||Ai(m,v),s=s||yn(m)});let a=t.syncPointTree_.get(o);a?(s=s||yn(a),r=r||Ai(a,K())):(a=new ok,t.syncPointTree_=t.syncPointTree_.set(o,a));let c;r!=null?c=!0:(c=!1,r=G.EMPTY_NODE,t.syncPointTree_.subtree(o).foreachChild((m,v)=>{const E=Ai(v,K());E&&(r=r.updateImmediateChild(m,E))}));const d=Gy(a,e);if(!d&&!e._queryParams.loadsAllData()){const p=gl(e);x(!t.queryToTagMap.has(p),"View does not exist, but we have a tag");const m=Ck();t.queryToTagMap.set(p,m),t.tagToQueryMap.set(m,p)}const f=Yc(t.pendingWriteTree_,o);let h=uk(a,e,n,f,r,c);if(!d&&!s&&!i){const p=Vy(a,e);h=h.concat(Tk(t,e,p))}return h}function jc(t,e,n){const o=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(s,a)=>{const c=We(s,e),d=Ai(a,c);if(d)return d});return xy(o,e,r,n,!0)}function hr(t,e){return Hy(e,t.syncPointTree_,null,Yc(t.pendingWriteTree_,K()))}function Hy(t,e,n,i){if(q(t.path))return By(t,e,n,i);{const o=e.get(K());n==null&&o!=null&&(n=Ai(o,K()));let r=[];const s=B(t.path),a=t.operationForChild(s),c=e.children.get(s);if(c&&a){const d=n?n.getImmediateChild(s):null,f=ky(i,s);r=r.concat(Hy(a,c,d,f))}return o&&(r=r.concat(Zc(o,t,i,n))),r}}function By(t,e,n,i){const o=e.get(K());n==null&&o!=null&&(n=Ai(o,K()));let r=[];return e.children.inorderTraversal((s,a)=>{const c=n?n.getImmediateChild(s):null,d=ky(i,s),f=t.operationForChild(s);f&&(r=r.concat(By(f,a,c,d)))}),o&&(r=r.concat(Zc(o,t,i,n))),r}function qy(t,e){const n=e.query,i=qs(t,n);return{hashFn:()=>(ek(e)||G.EMPTY_NODE).hash(),onComplete:o=>{if(o==="ok")return i?gk(t,n._path,i):mk(t,n._path);{const r=gP(o,n);return Pu(t,n,null,r)}}}}function qs(t,e){const n=gl(e);return t.queryToTagMap.get(n)}function gl(t){return t._path.toString()+"$"+t._queryIdentifier}function ed(t,e){return t.tagToQueryMap.get(e)}function td(t){const e=t.indexOf("$");return x(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new X(t.substr(0,e))}}function nd(t,e,n){const i=t.syncPointTree_.get(e);x(i,"Missing sync point for query tag that we're tracking");const o=Yc(t.pendingWriteTree_,e);return Zc(i,n,o,null)}function vk(t){return t.fold((e,n,i)=>{if(n&&yn(n))return[pl(n)];{let o=[];return n&&(o=Uy(n)),Ge(i,(r,s)=>{o=o.concat(s)}),o}})}function Po(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(fk())(t._repo,t._path):t}function Ek(t,e){for(let n=0;n<e.length;++n){const i=e[n];if(!i._queryParams.loadsAllData()){const o=gl(i),r=t.queryToTagMap.get(o);t.queryToTagMap.delete(o),t.tagToQueryMap.delete(r)}}}function Ck(){return hk++}function Tk(t,e,n){const i=e._path,o=qs(t,e),r=qy(t,n),s=t.listenProvider_.startListening(Po(e),o,r.hashFn,r.onComplete),a=t.syncPointTree_.subtree(i);if(o)x(!yn(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((d,f,h)=>{if(!q(d)&&f&&yn(f))return[pl(f).query];{let p=[];return f&&(p=p.concat(Uy(f).map(m=>m.query))),Ge(h,(m,v)=>{p=p.concat(v)}),p}});for(let d=0;d<c.length;++d){const f=c[d];t.listenProvider_.stopListening(Po(f),qs(t,f))}}return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new id(n)}node(){return this.node_}}class od{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=_e(this.path_,e);return new od(this.syncTree_,n)}node(){return jc(this.syncTree_,this.path_)}}const Sk=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Hp=function(t,e,n){if(!t||typeof t!="object")return t;if(x(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Ik(t[".sv"],e,n);if(typeof t[".sv"]=="object")return wk(t[".sv"],e);x(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Ik=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:x(!1,"Unexpected server value: "+t)}},wk=function(t,e,n){t.hasOwnProperty("increment")||x(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const i=t.increment;typeof i!="number"&&x(!1,"Unexpected increment value: "+i);const o=e.node();if(x(o!==null&&typeof o<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return i;const s=o.getValue();return typeof s!="number"?i:s+i},Ak=function(t,e,n,i){return rd(e,new od(n,t),i)},by=function(t,e,n){return rd(t,new id(e),n)};function rd(t,e,n){const i=t.getPriority().val(),o=Hp(i,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const s=t,a=Hp(s.getValue(),e,n);return a!==s.getValue()||o!==s.getPriority().val()?new Ie(a,ye(o)):t}else{const s=t;return r=s,o!==s.getPriority().val()&&(r=r.updatePriority(new Ie(o))),s.forEachChild(de,(a,c)=>{const d=rd(c,e.getImmediateChild(a),n);d!==c&&(r=r.updateImmediateChild(a,d))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}}function ld(t,e){let n=e instanceof X?e:new X(e),i=t,o=B(n);for(;o!==null;){const r=Li(i.node.children,o)||{children:{},childCount:0};i=new sd(o,i,r),n=Z(n),o=B(n)}return i}function Qi(t){return t.node.value}function zy(t,e){t.node.value=e,xu(t)}function Wy(t){return t.node.childCount>0}function Nk(t){return Qi(t)===void 0&&!Wy(t)}function _l(t,e){Ge(t.node.children,(n,i)=>{e(new sd(n,t,i))})}function $y(t,e,n,i){n&&e(t),_l(t,o=>{$y(o,e,!0)})}function Rk(t,e,n){let i=t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function pr(t){return new X(t.parent===null?t.name:pr(t.parent)+"/"+t.name)}function xu(t){t.parent!==null&&Pk(t.parent,t.name,t)}function Pk(t,e,n){const i=Nk(n),o=Rt(t.node.children,e);i&&o?(delete t.node.children[e],t.node.childCount--,xu(t)):!i&&!o&&(t.node.children[e]=n.node,t.node.childCount++,xu(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xk=/[\[\].#$\/\u0000-\u001F\u007F]/,kk=/[\[\].#$\u0000-\u001F\u007F]/,ia=10*1024*1024,ad=function(t){return typeof t=="string"&&t.length!==0&&!xk.test(t)},Jy=function(t){return typeof t=="string"&&t.length!==0&&!kk.test(t)},Mk=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Jy(t)},Yy=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!dl(t)||t&&typeof t=="object"&&Rt(t,".sv")},bs=function(t,e,n,i){i&&e===void 0||yl(Fi(t,"value"),e,n)},yl=function(t,e,n){const i=n instanceof X?new QP(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Rn(i));if(typeof e=="function")throw new Error(t+"contains a function "+Rn(i)+" with contents = "+e.toString());if(dl(e))throw new Error(t+"contains "+e.toString()+" "+Rn(i));if(typeof e=="string"&&e.length>ia/3&&cl(e)>ia)throw new Error(t+"contains a string greater than "+ia+" utf8 bytes "+Rn(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let o=!1,r=!1;if(Ge(e,(s,a)=>{if(s===".value")o=!0;else if(s!==".priority"&&s!==".sv"&&(r=!0,!ad(s)))throw new Error(t+" contains an invalid key ("+s+") "+Rn(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);XP(i,s),yl(t,a,i),ZP(i)}),o&&r)throw new Error(t+' contains ".value" child '+Rn(i)+" in addition to actual children.")}},Dk=function(t,e){let n,i;for(n=0;n<e.length;n++){i=e[n];const r=Xo(i);for(let s=0;s<r.length;s++)if(!(r[s]===".priority"&&s===r.length-1)){if(!ad(r[s]))throw new Error(t+"contains an invalid key ("+r[s]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(KP);let o=null;for(n=0;n<e.length;n++){if(i=e[n],o!==null&&st(o,i))throw new Error(t+"contains a path "+o.toString()+" that is ancestor of another path "+i.toString());o=i}},Lk=function(t,e,n,i){const o=Fi(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(o+" must be an object containing the children to replace.");const r=[];Ge(e,(s,a)=>{const c=new X(s);if(yl(o,a,_e(n,c)),Hc(c)===".priority"&&!Yy(a))throw new Error(o+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(c)}),Dk(o,r)},Fk=function(t,e,n){if(dl(e))throw new Error(Fi(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Yy(e))throw new Error(Fi(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Ky=function(t,e,n,i){if(!Jy(n))throw new Error(Fi(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Uk=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ky(t,e,n)},hi=function(t,e){if(B(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Vk=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!ad(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Mk(n))throw new Error(Fi(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ud(t,e){let n=null;for(let i=0;i<e.length;i++){const o=e[i],r=o.getPath();n!==null&&!Bc(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(o)}n&&t.eventLists_.push(n)}function Qy(t,e,n){ud(t,n),Xy(t,i=>Bc(i,e))}function Wt(t,e,n){ud(t,n),Xy(t,i=>st(i,e)||st(e,i))}function Xy(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){const o=t.eventLists_[i];if(o){const r=o.path;e(r)?(Ok(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Ok(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const i=n.getEventRunner();wo&&xe("event: "+n.toString()),Yi(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hk="repo_interrupt",Bk=25;class qk{constructor(e,n,i,o){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=o,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Gk,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Fs(),this.transactionQueueTree_=new sd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function bk(t,e,n){if(t.stats_=Gc(t.repoInfo_),t.forceRestClient_||EP())t.server_=new Ls(t.repoInfo_,(i,o,r,s)=>{Bp(t,i,o,r,s)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>qp(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ne(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new Vt(t.repoInfo_,e,(i,o,r,s)=>{Bp(t,i,o,r,s)},i=>{qp(t,i)},i=>{zk(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=wP(t.repoInfo_,()=>new Ix(t.stats_,t.server_)),t.infoData_=new vx,t.infoSyncTree_=new Gp({startListening:(i,o,r,s)=>{let a=[];const c=t.infoData_.getNode(i._path);return c.isEmpty()||(a=ml(t.infoSyncTree_,i._path,c),setTimeout(()=>{s("ok")},0)),a},stopListening:()=>{}}),dd(t,"connected",!1),t.serverSyncTree_=new Gp({startListening:(i,o,r,s)=>(t.server_.listen(i,r,o,(a,c)=>{const d=s(a,c);Wt(t.eventQueue_,i._path,d)}),[]),stopListening:(i,o)=>{t.server_.unlisten(i,o)}})}function Zy(t){const n=t.infoData_.getNode(new X(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function cd(t){return Sk({timestamp:Zy(t)})}function Bp(t,e,n,i,o){t.dataUpdateCount++;const r=new X(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let s=[];if(o)if(i){const c=Rs(n,d=>ye(d));s=yk(t.serverSyncTree_,r,c,o)}else{const c=ye(n);s=_k(t.serverSyncTree_,r,c,o)}else if(i){const c=Rs(n,d=>ye(d));s=pk(t.serverSyncTree_,r,c)}else{const c=ye(n);s=ml(t.serverSyncTree_,r,c)}let a=r;s.length>0&&(a=vl(t,r)),Wt(t.eventQueue_,a,s)}function qp(t,e){dd(t,"connected",e),e===!1&&$k(t)}function zk(t,e){Ge(e,(n,i)=>{dd(t,n,i)})}function dd(t,e,n){const i=new X("/.info/"+e),o=ye(n);t.infoData_.updateSnapshot(i,o);const r=ml(t.infoSyncTree_,i,o);Wt(t.eventQueue_,i,r)}function jy(t){return t.nextWriteId_++}function Wk(t,e,n,i,o){fd(t,"set",{path:e.toString(),value:n,priority:i});const r=cd(t),s=ye(n,i),a=jc(t.serverSyncTree_,e),c=by(s,a,r),d=jy(t),f=Oy(t.serverSyncTree_,e,c,d,!0);ud(t.eventQueue_,f),t.server_.put(e.toString(),s.val(!0),(p,m)=>{const v=p==="ok";v||Qe("set at "+e+" failed: "+p);const E=Dn(t.serverSyncTree_,d,!v);Wt(t.eventQueue_,e,E),Oi(t,o,p,m)});const h=ov(t,e);vl(t,h),Wt(t.eventQueue_,h,[])}function $k(t){fd(t,"onDisconnectEvents");const e=cd(t),n=Fs();Su(t.onDisconnect_,K(),(o,r)=>{const s=Ak(o,r,t.serverSyncTree_,e);Ki(n,o,s)});let i=[];Su(n,K(),(o,r)=>{i=i.concat(ml(t.serverSyncTree_,o,r));const s=ov(t,o);vl(t,s)}),t.onDisconnect_=Fs(),Wt(t.eventQueue_,K(),i)}function Jk(t,e,n){t.server_.onDisconnectCancel(e.toString(),(i,o)=>{i==="ok"&&Tu(t.onDisconnect_,e),Oi(t,n,i,o)})}function bp(t,e,n,i){const o=ye(n);t.server_.onDisconnectPut(e.toString(),o.val(!0),(r,s)=>{r==="ok"&&Ki(t.onDisconnect_,e,o),Oi(t,i,r,s)})}function Yk(t,e,n,i,o){const r=ye(n,i);t.server_.onDisconnectPut(e.toString(),r.val(!0),(s,a)=>{s==="ok"&&Ki(t.onDisconnect_,e,r),Oi(t,o,s,a)})}function Kk(t,e,n,i){if(fu(n)){xe("onDisconnect().update() called with empty data.  Don't do anything."),Oi(t,i,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(o,r)=>{o==="ok"&&Ge(n,(s,a)=>{const c=ye(a);Ki(t.onDisconnect_,_e(e,s),c)}),Oi(t,i,o,r)})}function Qk(t,e,n){let i;B(e._path)===".info"?i=Op(t.infoSyncTree_,e,n):i=Op(t.serverSyncTree_,e,n),Qy(t.eventQueue_,e._path,i)}function Xk(t,e,n){let i;B(e._path)===".info"?i=Pu(t.infoSyncTree_,e,n):i=Pu(t.serverSyncTree_,e,n),Qy(t.eventQueue_,e._path,i)}function Zk(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Hk)}function fd(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),xe(n,...e)}function Oi(t,e,n,i){e&&Yi(()=>{if(n==="ok")e(null);else{const o=(n||"error").toUpperCase();let r=o;i&&(r+=": "+i);const s=new Error(r);s.code=o,e(s)}})}function ev(t,e,n){return jc(t.serverSyncTree_,e,n)||G.EMPTY_NODE}function hd(t,e=t.transactionQueueTree_){if(e||El(t,e),Qi(e)){const n=nv(t,e);x(n.length>0,"Sending zero length transaction queue"),n.every(o=>o.status===0)&&jk(t,pr(e),n)}else Wy(e)&&_l(e,n=>{hd(t,n)})}function jk(t,e,n){const i=n.map(d=>d.currentWriteId),o=ev(t,e,i);let r=o;const s=o.hash();for(let d=0;d<n.length;d++){const f=n[d];x(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;const h=We(e,f.path);r=r.updateChild(h,f.currentOutputSnapshotRaw)}const a=r.val(!0),c=e;t.server_.put(c.toString(),a,d=>{fd(t,"transaction put response",{path:c.toString(),status:d});let f=[];if(d==="ok"){const h=[];for(let p=0;p<n.length;p++)n[p].status=2,f=f.concat(Dn(t.serverSyncTree_,n[p].currentWriteId)),n[p].onComplete&&h.push(()=>n[p].onComplete(null,!0,n[p].currentOutputSnapshotResolved)),n[p].unwatcher();El(t,ld(t.transactionQueueTree_,e)),hd(t,t.transactionQueueTree_),Wt(t.eventQueue_,e,f);for(let p=0;p<h.length;p++)Yi(h[p])}else{if(d==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Qe("transaction at "+c.toString()+" failed: "+d);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=d}vl(t,e)}},s)}function vl(t,e){const n=tv(t,e),i=pr(n),o=nv(t,n);return eM(t,o,i),i}function eM(t,e,n){if(e.length===0)return;const i=[];let o=[];const s=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],d=We(n,c.path);let f=!1,h;if(x(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)f=!0,h=c.abortReason,o=o.concat(Dn(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=Bk)f=!0,h="maxretry",o=o.concat(Dn(t.serverSyncTree_,c.currentWriteId,!0));else{const p=ev(t,c.path,s);c.currentInputSnapshot=p;const m=e[a].update(p.val());if(m!==void 0){yl("transaction failed: Data returned ",m,c.path);let v=ye(m);typeof m=="object"&&m!=null&&Rt(m,".priority")||(v=v.updatePriority(p.getPriority()));const S=c.currentWriteId,_=cd(t),g=by(v,p,_);c.currentOutputSnapshotRaw=v,c.currentOutputSnapshotResolved=g,c.currentWriteId=jy(t),s.splice(s.indexOf(S),1),o=o.concat(Oy(t.serverSyncTree_,c.path,g,c.currentWriteId,c.applyLocally)),o=o.concat(Dn(t.serverSyncTree_,S,!0))}else f=!0,h="nodata",o=o.concat(Dn(t.serverSyncTree_,c.currentWriteId,!0))}Wt(t.eventQueue_,n,o),o=[],f&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(h),!1,null))))}El(t,t.transactionQueueTree_);for(let a=0;a<i.length;a++)Yi(i[a]);hd(t,t.transactionQueueTree_)}function tv(t,e){let n,i=t.transactionQueueTree_;for(n=B(e);n!==null&&Qi(i)===void 0;)i=ld(i,n),e=Z(e),n=B(e);return i}function nv(t,e){const n=[];return iv(t,e,n),n.sort((i,o)=>i.order-o.order),n}function iv(t,e,n){const i=Qi(e);if(i)for(let o=0;o<i.length;o++)n.push(i[o]);_l(e,o=>{iv(t,o,n)})}function El(t,e){const n=Qi(e);if(n){let i=0;for(let o=0;o<n.length;o++)n[o].status!==2&&(n[i]=n[o],i++);n.length=i,zy(e,n.length>0?n:void 0)}_l(e,i=>{El(t,i)})}function ov(t,e){const n=pr(tv(t,e)),i=ld(t.transactionQueueTree_,e);return Rk(i,o=>{oa(t,o)}),oa(t,i),$y(i,o=>{oa(t,o)}),n}function oa(t,e){const n=Qi(e);if(n){const i=[];let o=[],r=-1;for(let s=0;s<n.length;s++)n[s].status===3||(n[s].status===1?(x(r===s-1,"All SENT items should be at beginning of queue."),r=s,n[s].status=3,n[s].abortReason="set"):(x(n[s].status===0,"Unexpected transaction status in abort"),n[s].unwatcher(),o=o.concat(Dn(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&i.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));r===-1?zy(e,void 0):n.length=r+1,Wt(t.eventQueue_,pr(e),o);for(let s=0;s<i.length;s++)Yi(i[s])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tM(t){let e="";const n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let o=n[i];try{o=decodeURIComponent(o.replace(/\+/g," "))}catch{}e+="/"+o}return e}function nM(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Qe(`Invalid query segment '${n}' in query '${t}'`)}return e}const zp=function(t,e){const n=iM(t),i=n.namespace;n.domain==="firebase.com"&&zt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&zt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||dP();const o=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new uy(n.host,n.secure,i,o,e,"",i!==n.subdomain),path:new X(n.pathString)}},iM=function(t){let e="",n="",i="",o="",r="",s=!0,a="https",c=443;if(typeof t=="string"){let d=t.indexOf("//");d>=0&&(a=t.substring(0,d-1),t=t.substring(d+2));let f=t.indexOf("/");f===-1&&(f=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(f,h)),f<h&&(o=tM(t.substring(f,h)));const p=nM(t.substring(Math.min(t.length,h)));d=e.indexOf(":"),d>=0?(s=a==="https"||a==="wss",c=parseInt(e.substring(d+1),10)):d=e.length;const m=e.slice(0,d);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const v=e.indexOf(".");i=e.substring(0,v).toLowerCase(),n=e.substring(v+1),r=i}"ns"in p&&(r=p.ns)}return{host:e,port:c,domain:n,subdomain:i,secure:s,scheme:a,pathString:o,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",oM=function(){let t=0;const e=[];return function(n){const i=n===t;t=n;let o;const r=new Array(8);for(o=7;o>=0;o--)r[o]=Wp.charAt(n%64),n=Math.floor(n/64);x(n===0,"Cannot push at time == 0");let s=r.join("");if(i){for(o=11;o>=0&&e[o]===63;o--)e[o]=0;e[o]++}else for(o=0;o<12;o++)e[o]=Math.floor(Math.random()*64);for(o=0;o<12;o++)s+=Wp.charAt(e[o]);return x(s.length===20,"nextPushId: Length should be 20."),s}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,n,i,o){this.eventType=e,this.eventRegistration=n,this.snapshot=i,this.prevName=o}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ne(this.snapshot.exportVal())}}class sv{constructor(e,n,i){this.eventRegistration=e,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return x(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Mt;return Jk(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){hi("OnDisconnect.remove",this._path);const e=new Mt;return bp(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){hi("OnDisconnect.set",this._path),bs("OnDisconnect.set",e,this._path,!1);const n=new Mt;return bp(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){hi("OnDisconnect.setWithPriority",this._path),bs("OnDisconnect.setWithPriority",e,this._path,!1),Fk("OnDisconnect.setWithPriority",n);const i=new Mt;return Yk(this._repo,this._path,e,n,i.wrapCallback(()=>{})),i.promise}update(e){hi("OnDisconnect.update",this._path),Lk("OnDisconnect.update",e,this._path);const n=new Mt;return Kk(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,n,i,o){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=o}get key(){return q(this._path)?null:Hc(this._path)}get ref(){return new Kt(this._repo,this._path)}get _queryIdentifier(){const e=Np(this._queryParams),n=Uc(e);return n==="{}"?"default":n}get _queryObject(){return Np(this._queryParams)}isEqual(e){if(e=Yn(e),!(e instanceof pd))return!1;const n=this._repo===e._repo,i=Bc(this._path,e._path),o=this._queryIdentifier===e._queryIdentifier;return n&&i&&o}toJSON(){return this.toString()}toString(){return this._repo.toString()+YP(this._path)}}class Kt extends pd{constructor(e,n){super(e,n,new Wc,!1)}get parent(){const e=yy(this._path);return e===null?null:new Kt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class ir{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new X(e),i=Hi(this.ref,e);return new ir(this._node.getChild(n),i,de)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,o)=>e(new ir(o,Hi(this.ref,i),de)))}hasChild(e){const n=new X(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ra(t,e){return t=Yn(t),t._checkNotDeleted("ref"),e!==void 0?Hi(t._root,e):t._root}function Hi(t,e){return t=Yn(t),B(t._path)===null?Uk("child","path",e):Ky("child","path",e),new Kt(t._repo,_e(t._path,e))}function lM(t){return t=Yn(t),new sM(t._repo,t._path)}function sa(t,e){t=Yn(t),hi("push",t._path),bs("push",e,t._path,!0);const n=Zy(t._repo),i=oM(n),o=Hi(t,i),r=Hi(t,i);let s;return e!=null?s=lv(r,e).then(()=>r):s=Promise.resolve(r),o.then=s.then.bind(s),o.catch=s.then.bind(s,void 0),o}function lv(t,e){t=Yn(t),hi("set",t._path),bs("set",e,t._path,!1);const n=new Mt;return Wk(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}class md{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const i=n._queryParams.getIndex();return new rv("value",this,new ir(e.snapshotNode,new Kt(n._repo,n._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new sv(this,e,n):null}matches(e){return e instanceof md?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class gd{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new sv(this,e,n):null}createEvent(e,n){x(e.childName!=null,"Child events should have a childName.");const i=Hi(new Kt(n._repo,n._path),e.childName),o=n._queryParams.getIndex();return new rv(e.type,this,new ir(e.snapshotNode,i,o),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof gd?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function av(t,e,n,i,o){const r=new rM(n,void 0),s=e==="value"?new md(r):new gd(e,r);return Qk(t._repo,t,s),()=>Xk(t._repo,t,s)}function $p(t,e,n,i){return av(t,"child_added",e)}function aM(t,e,n,i){return av(t,"child_removed",e)}rk(Kt);dk(Kt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM="FIREBASE_DATABASE_EMULATOR_HOST",ku={};let cM=!1;function dM(t,e,n,i){t.repoInfo_=new uy(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),i&&(t.authTokenProvider_=i)}function fM(t,e,n,i,o){let r=i||t.options.databaseURL;r===void 0&&(t.options.projectId||zt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),xe("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let s=zp(r,o),a=s.repoInfo,c;typeof process<"u"&&up&&(c=up[uM]),c?(r=`http://${c}?ns=${a.namespace}`,s=zp(r,o),a=s.repoInfo):s.repoInfo.secure;const d=new TP(t.name,t.options,e);Vk("Invalid Firebase Database URL",s),q(s.path)||zt("Database URL must point to the root of a Firebase Database (not including a child path).");const f=pM(a,t,d,new CP(t.name,n));return new mM(f,t)}function hM(t,e){const n=ku[e];(!n||n[t.key]!==t)&&zt(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Zk(t),delete n[t.key]}function pM(t,e,n,i){let o=ku[e.name];o||(o={},ku[e.name]=o);let r=o[t.toURLString()];return r&&zt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new qk(t,cM,n,i),o[t.toURLString()]=r,r}class mM{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(bk(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Kt(this._repo,K())),this._rootInternal}_delete(){return this._rootInternal!==null&&(hM(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&zt("Cannot call "+e+" on a deleted database.")}}function gM(t=JR(),e){const n=bR(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const i=MN("database");i&&_M(n,...i)}return n}function _M(t,e,n,i={}){t=Yn(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&zt("Cannot call useEmulator() after instance has already been initialized.");const o=t._repoInternal;let r;if(o.repoInfo_.nodeAdmin)i.mockUserToken&&zt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new Zr(Zr.OWNER);else if(i.mockUserToken){const s=typeof i.mockUserToken=="string"?i.mockUserToken:DN(i.mockUserToken,t.app.options.projectId);r=new Zr(s)}dM(o,e,n,r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yM(t){rP($R),xs(new Yo("database",(e,{instanceIdentifier:n})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return fM(i,o,r,n)},"PUBLIC").setMultipleInstances(!0)),Si(cp,dp,t),Si(cp,dp,"esm2017")}Vt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Vt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};yM();const vM={apiKey:"AIzaSyC8cCm5890Za9qZsm1mGqYOuGTShgO3xfo",authDomain:"mandaloop-6502e.firebaseapp.com",databaseURL:"https://mandaloop-6502e-default-rtdb.europe-west1.firebasedatabase.app",projectId:"mandaloop-6502e",storageBucket:"mandaloop-6502e.firebasestorage.app",messagingSenderId:"264329265376",appId:"1:264329265376:web:c8505a7e0ef92d6b031085",measurementId:"G-S1YJ5E09XZ"};class EM{constructor(){ue(this,"app",null);ue(this,"db",null);ue(this,"eventsRef",null);ue(this,"usersRef",null);ue(this,"roomId","");ue(this,"localUserId","");ue(this,"onMessageCallback",null);try{this.app=$_(vM),this.db=gM(this.app)}catch(e){console.error("Firebase init error:",e)}}connect(e,n){if(!this.db)return;this.roomId=e,this.onMessageCallback=n,this.eventsRef=ra(this.db,`rooms/${e}/events`),this.usersRef=ra(this.db,`rooms/${e}/users`);const i=Date.now();$p(this.eventsRef,o=>{const r=o.val();(r.type==="NOTE_ON"||r.type==="NOTE_OFF")&&r.timestamp&&r.timestamp<i||this.onMessageCallback&&this.onMessageCallback(r)}),$p(this.usersRef,o=>{const r=o.val(),s={id:r.id||"unknown",name:r.name||"Anonymous",colorIndex:r.colorIndex||0,activeNotes:r.activeNotes||[],activeEffects:r.activeEffects||[]};this.onMessageCallback&&this.onMessageCallback({type:"JOIN",roomId:this.roomId,payload:s,senderId:s.id})}),aM(this.usersRef,o=>{const r=o.key;r&&this.onMessageCallback&&this.onMessageCallback({type:"LEAVE",roomId:this.roomId,payload:null,senderId:r})})}sendNote(e,n){if(!this.eventsRef)return;const i={type:"NOTE_ON",roomId:this.roomId,senderId:n,payload:e,timestamp:Date.now()};sa(this.eventsRef,i)}sendNoteOff(e,n){if(!this.eventsRef)return;const i={type:"NOTE_OFF",roomId:this.roomId,senderId:n,payload:{noteIndex:e},timestamp:Date.now()};sa(this.eventsRef,i)}send(e,n,i){if(!this.eventsRef||!this.db)return;if(e==="JOIN"&&(this.localUserId=i,this.usersRef)){const r=ra(this.db,`rooms/${this.roomId}/users/${i}`);lv(r,n),lM(r).remove()}const o={type:e,roomId:this.roomId,payload:n,senderId:i,timestamp:Date.now()};sa(this.eventsRef,o)}}const Pt=new EM,CM={name:"Deep Space",colors:["#60A5FA","#A78BFA","#F472B6","#34D399","#FBBF24","#F87171","#818CF8"],scale:"pentatonic_minor",synthConfig:{osc1Type:"sine",osc2Type:"triangle",attack:.1,decay:.3,sustain:.5,release:.8,filterFreq:1200,filterQ:2,vibratoSpeed:6,vibratoDepth:0},baseFreq:150,moodDescription:"A calm, floating sensation."},Ur={s:0,d:1,f:2,g:3,h:4,j:5,k:6,e:7,r:8,t:9,y:10,u:11,i:12,o:13},Vr={c:"vibrato",v:"reverb_max",z:"filter_close",x:"distort"},Jp=5,TM=()=>{const[t,e]=re.useState(!0),[n,i]=re.useState(null),[o,r]=re.useState([]),[s,a]=re.useState(CM),[c,d]=re.useState(!1),[f,h]=re.useState(""),p=re.useRef(null),m=re.useRef(()=>{}),[v,E]=re.useState("Single"),[S,_]=re.useState(""),g=n?[n,...o]:[],y=S||s.scale;re.useEffect(()=>{n&&(p.current=n.id)},[n]);const C=re.useCallback(w=>{if(!(p.current&&w.senderId===p.current))switch(w.type){case"JOIN":r(P=>{if(P.find(O=>O.id===w.senderId))return P;const F=w.payload,U={id:F.id||"unknown",name:F.name||"Anonymous",colorIndex:F.colorIndex||0,activeNotes:F.activeNotes||[],activeEffects:F.activeEffects||[]};return[...P,U]});break;case"LEAVE":r(P=>P.filter(F=>F.id!==w.senderId));break;case"NOTE_ON":{const{noteIndex:P}=w.payload,F=o.find(Y=>Y.id===w.senderId),U=F?F.activeEffects:[];r(Y=>Y.map(ne=>{const W=ne.activeNotes||[];return ne.id===w.senderId&&!W.includes(P)?{...ne,activeNotes:[...W,P]}:ne}));const O=St.getFreq(s.baseFreq,y,P);St.noteOn(w.senderId,P,O,s.synthConfig,U);break}case"NOTE_OFF":{const{noteIndex:P}=w.payload;r(F=>F.map(U=>{if(U.id===w.senderId){const O=U.activeNotes||[];return{...U,activeNotes:O.filter(Y=>Y!==P)}}return U})),St.noteOff(w.senderId,P);break}case"EFFECT_CHANGE":{const{effect:P,active:F}=w.payload;let U=[];r(O=>O.map(Y=>{if(Y.id===w.senderId){const ne=Y.activeEffects||[];return U=F?[...ne,P]:ne.filter(W=>W!==P),{...Y,activeEffects:U}}return Y})),St.updateUserEffects(w.senderId,U);break}case"SYNC_THEME":a(w.payload),_("");break;case"SYNC_SCALE":_(w.payload);break}},[s,y,o]);re.useEffect(()=>{m.current=C},[C]);const I=(w,P)=>{const F={id:Math.random().toString(36).substr(2,9),name:w,colorIndex:Math.floor(Math.random()*5),activeNotes:[],activeEffects:[]};i(F),p.current=F.id,h(P),e(!1),St.init(),Pt.connect(P,U=>{m.current&&m.current(U)}),setTimeout(()=>{Pt.send("JOIN",F,F.id)},500)};re.useEffect(()=>{if(t||!n)return;const w=F=>{if(F.repeat||F.target.tagName==="INPUT"||F.target.tagName==="SELECT")return;const U=F.key.toLowerCase();if(Ur.hasOwnProperty(U)){const O=Ur[U];if((n.activeNotes||[]).length>=Jp)return;(cu[v]||[0]).forEach(ne=>{const W=O+ne;i(V=>{if(!V)return V;const H=V.activeNotes||[];return H.length>=Jp||H.includes(W)?V:{...V,activeNotes:[...H,W]}});const Te=St.getFreq(s.baseFreq,y,W);St.noteOn(n.id,W,Te,s.synthConfig,n.activeEffects);const D={noteIndex:W,velocity:.8,timestamp:Date.now(),duration:0};Pt.sendNote(D,n.id)})}if(Vr.hasOwnProperty(U)){const O=Vr[U];let Y=n.activeEffects;if(O==="reverb_max"){const W=!n.activeEffects.includes("reverb_max");Y=W?[...n.activeEffects,O]:n.activeEffects.filter(Te=>Te!==O),i({...n,activeEffects:Y}),Pt.send("EFFECT_CHANGE",{effect:O,active:W},n.id)}else n.activeEffects.includes(O)||(Y=[...n.activeEffects,O],i({...n,activeEffects:Y}),Pt.send("EFFECT_CHANGE",{effect:O,active:!0},n.id));St.updateUserEffects(n.id,Y)}},P=F=>{const U=F.key.toLowerCase();if(Ur.hasOwnProperty(U)){const O=Ur[U];(cu[v]||[0]).forEach(ne=>{const W=O+ne;i(Te=>{if(!Te)return Te;const D=Te.activeNotes||[];return{...Te,activeNotes:D.filter(V=>V!==W)}}),St.noteOff(n.id,W),Pt.sendNoteOff(W,n.id)})}if(Vr.hasOwnProperty(U)){const O=Vr[U];if(O==="reverb_max")return;const Y=n.activeEffects.filter(ne=>ne!==O);i(ne=>ne&&{...ne,activeEffects:Y}),St.updateUserEffects(n.id,Y),Pt.send("EFFECT_CHANGE",{effect:O,active:!1},n.id)}};return window.addEventListener("keydown",w),window.addEventListener("keyup",P),()=>{window.removeEventListener("keydown",w),window.removeEventListener("keyup",P)}},[t,n,s,y,v]);const A=w=>{a(w),_(""),n&&Pt.send("SYNC_THEME",w,n.id)},N=w=>{_(w),n&&Pt.send("SYNC_SCALE",w,n.id)};if(t)return T.jsx(TN,{onJoin:I});const k=((n==null?void 0:n.activeEffects)||[]).includes("reverb_max");return T.jsxs("div",{className:"w-full h-screen bg-black overflow-hidden relative selection:bg-none",children:[T.jsx(HC,{users:g,theme:s}),T.jsx(CN,{userCount:g.length,onAddUser:()=>{},onRemoveUser:()=>{},currentTheme:s,onThemeChange:A,isGenerating:c,setIsGenerating:d,roomCode:f,setRoomCode:()=>{},activeChordMode:v,setActiveChordMode:E,overrideScale:S,setOverrideScale:N}),T.jsx("div",{className:"absolute bottom-6 left-0 right-0 flex justify-center pointer-events-none",children:T.jsxs("div",{className:"flex gap-8 items-center bg-black/40 backdrop-blur px-6 py-2 rounded-full border border-white/5",children:[T.jsxs("div",{className:"flex gap-4 items-center border-r border-white/10 pr-6",children:[T.jsx("div",{className:"text-[10px] text-white/50 font-mono tracking-widest",children:"KEYS"}),T.jsxs("div",{className:"flex gap-1",children:[["S","D","F","G","H","J","K"].map(w=>T.jsx("span",{className:"w-6 h-6 border border-white/30 flex items-center justify-center rounded text-[10px] text-white/80",children:w},w)),T.jsx("span",{className:"text-white/20 mx-1",children:"|"}),["E","R","T","Y","U","I","O"].map(w=>T.jsx("span",{className:"w-6 h-6 border border-white/30 flex items-center justify-center rounded text-[10px] text-white/80",children:w},w))]})]}),T.jsxs("div",{className:"flex gap-4 items-center",children:[T.jsx("div",{className:"text-[10px] text-white/50 font-mono tracking-widest",children:"FX"}),T.jsxs("div",{className:"flex gap-2",children:[T.jsxs("div",{className:"flex items-center gap-1",children:[T.jsx("span",{className:"w-6 h-6 border border-white/30 flex items-center justify-center rounded text-[10px] text-white/80",children:"C"}),T.jsx("span",{className:"text-[9px] text-white/60",children:"VIB"})]}),T.jsxs("div",{className:"flex items-center gap-1",children:[T.jsx("span",{className:`w-6 h-6 border flex items-center justify-center rounded text-[10px] transition-colors ${k?"bg-green-500/20 border-green-500 text-green-400":"border-white/30 text-white/80"}`,children:"V"}),T.jsx("span",{className:`text-[9px] ${k?"text-green-400":"text-white/60"}`,children:"REV"})]}),T.jsxs("div",{className:"flex items-center gap-1",children:[T.jsx("span",{className:"w-6 h-6 border border-white/30 flex items-center justify-center rounded text-[10px] text-white/80",children:"Z"}),T.jsx("span",{className:"text-[9px] text-white/60",children:"FILT"})]}),T.jsxs("div",{className:"flex items-center gap-1",children:[T.jsx("span",{className:"w-6 h-6 border border-white/30 flex items-center justify-center rounded text-[10px] text-white/80",children:"X"}),T.jsx("span",{className:"text-[9px] text-white/60",children:"DIST"})]})]})]})]})})]})},uv=document.getElementById("root");if(!uv)throw new Error("Could not find root element to mount to");const SM=la.createRoot(uv);SM.render(T.jsx(Rv.StrictMode,{children:T.jsx(TM,{})}));
